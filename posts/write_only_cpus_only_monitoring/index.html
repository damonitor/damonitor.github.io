<!DOCTYPE html>
<html lang="en-us"><head><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name">DAMON for Write-only or Given CPUs-only Monitoring | DAMON Project</title>
<meta property="og:title" content="DAMON for Write-only or Given CPUs-only Monitoring | DAMON Project" />
<meta name="twitter:title" content="DAMON for Write-only or Given CPUs-only Monitoring | DAMON Project" />
<meta itemprop="name" content="DAMON for Write-only or Given CPUs-only Monitoring | DAMON Project" />
<meta name="application-name" content="DAMON for Write-only or Given CPUs-only Monitoring | DAMON Project" />
<meta property="og:site_name" content="DAMON Project" />

<meta name="description" content="Minimal Hugo blog for DAMON project">
<meta itemprop="description" content="Minimal Hugo blog for DAMON project" />
<meta property="og:description" content="Minimal Hugo blog for DAMON project" />
<meta name="twitter:description" content="Minimal Hugo blog for DAMON project" />

<meta property="og:locale" content="en-us" />
<meta name="language" content="en-us" />


<meta itemprop="image" content="" />
<meta property="og:image" content="" />
<meta name="twitter:image" content="" />
<meta name="twitter:image:src" content="" />


    
    
    

    <meta property="og:type" content="article" />
    <meta property="og:article:published_time" content=2025-08-03T12:26:10-0700 />
    <meta property="article:published_time" content=2025-08-03T12:26:10-0700 />
    <meta property="og:url" content="https://damonitor.github.io/posts/write_only_cpus_only_monitoring/" />

    
    <meta property="og:article:author" content="SJ" />
    <meta property="article:author" content="SJ" />
    <meta name="author" content="SJ" />
    
    

    

    <script defer type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "DAMON for Write-only or Given CPUs-only Monitoring",
        "author": {
        "@type": "Person",
        "name": ""
        },
        "datePublished": "2025-08-03",
        "description": "",
        "wordCount":  495 ,
        "mainEntityOfPage": "True",
        "dateModified": "2025-08-03",
        "image": {
        "@type": "imageObject",
        "url": ""
        },
        "publisher": {
        "@type": "Organization",
        "name": "DAMON Project"
        }
    }
    </script>


<meta name="generator" content="Hugo 0.121.2">

    
    <meta property="og:title" content="DAMON for Write-only or Given CPUs-only Monitoring" />
<meta property="og:description" content="From the very early days of DAMON, there were attempts to extend it for cpus-aware monitoring and write-only monitoring.
In 2022, Xin Hao proposed extending DAMON for NUMA access statistics.
In 2022 and 2025, Pedro Demarchi Gomes proposed extending DAMON for writes-only monitoring.
Those proposals are not yet upstreamed though. We continued similar DAMON extension discussions publicly and privately, with multiple parties, though.
I was recently taking some time on these, and happy to announce the first working prototype for the extensions." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://damonitor.github.io/posts/write_only_cpus_only_monitoring/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2025-08-03T12:26:10-07:00" />
<meta property="article:modified_time" content="2025-08-03T12:26:10-07:00" />



    
    <meta name="twitter:card" content="summary"/><meta name="twitter:title" content="DAMON for Write-only or Given CPUs-only Monitoring"/>
<meta name="twitter:description" content="From the very early days of DAMON, there were attempts to extend it for cpus-aware monitoring and write-only monitoring.
In 2022, Xin Hao proposed extending DAMON for NUMA access statistics.
In 2022 and 2025, Pedro Demarchi Gomes proposed extending DAMON for writes-only monitoring.
Those proposals are not yet upstreamed though. We continued similar DAMON extension discussions publicly and privately, with multiple parties, though.
I was recently taking some time on these, and happy to announce the first working prototype for the extensions."/>


    

    <link rel="canonical" href="https://damonitor.github.io/posts/write_only_cpus_only_monitoring/">
    <link href="/style.min.2d921c18cf1ec555ffc03d59a8adc211c402c68c930c27d6a0c306ab175a8d09.css" rel="stylesheet">
    <link href="/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css" rel="stylesheet">

    
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg">
    <link rel="shortcut icon" href="/favicon.ico">




<link rel="manifest" href="https://damonitor.github.io/site.webmanifest">

<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#434648">

    
    <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">

    
    </head>
<body data-theme = "dark" class="notransition">

<script src="/js/theme.min.8961c317c5b88b953fe27525839672c9343f1058ab044696ca225656c8ba2ab0.js" integrity="sha256-iWHDF8W4i5U/4nUlg5ZyyTQ/EFirBEaWyiJWVsi6KrA="></script>

<div class="navbar" role="navigation">
    <nav class="menu" aria-label="Main Navigation">
        <a href="https://damonitor.github.io/" class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" 
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" 
stroke-linejoin="round" class="feather feather-home">
<title>Home</title>
<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
<polyline points="9 22 9 12 15 12 15 22"></polyline>
</svg>
        </a>
        <input type="checkbox" id="menu-trigger" class="menu-trigger" />
        <label for="menu-trigger">
            <span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" stroke="currentColor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7L3.40726 7"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488L3.49301 3.51488"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"></path><path stroke-linecap="round" stroke-linejoin="round" d="M0.5 12.5V1.5C0.5 0.947715 0.947715 0.5 1.5 0.5H12.5C13.0523 0.5 13.5 0.947715 13.5 1.5V12.5C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C0.947715 13.5 0.5 13.0523 0.5 12.5Z"></path></svg>
            </span>
        </label>

        <div class="trigger">
            <ul class="trigger-container">
                
                
                <li>
                    <a class="menu-link " href="/">
                        Home
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link active" href="/posts/">
                        Posts
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/tags/">
                        Tags
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/categories/">
                        Categories
                    </a>
                    
                </li>
                
                <li class="menu-separator">
                    <span>|</span>
                </li>
                
                
            </ul>
            <a id="mode" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page-content" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title">DAMON for Write-only or Given CPUs-only Monitoring</h1>
                
                
                
                <div class="post-meta">
                    <time datetime="2025-08-03T12:26:10-07:00" itemprop="datePublished"> Aug 3, 2025 </time>
                </div>
                
            </header>
            
    
    <details class="toc" ZgotmplZ>
        <summary><b>Table of Contents</b></summary>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#write-only-access-monitoring">Write-only Access Monitoring</a></li>
    <li><a href="#cpus-only-access-monitoring">CPUs-only Access Monitoring</a></li>
    <li><a href="#cautions-and-plan-to-drop-experimental-tag">Cautions and Plan to Drop Experimental Tag</a></li>
  </ul>
</nav>
    </details>
            <div class="page-content">
                <p>From the very early days of DAMON, there were attempts to extend it for
cpus-aware monitoring and write-only monitoring.</p>
<p>In 2022, Xin Hao
<a href="https://lore.kernel.org/linux-mm/cover.1645024354.git.xhao@linux.alibaba.com/">proposed</a>
extending DAMON for NUMA access statistics.</p>
<p>In
<a href="https://lore.kernel.org/lkml/20220203131237.298090-1-pedrodemargomes@gmail.com/">2022</a>
and
<a href="https://lore.kernel.org/damon/20250129044041.25884-1-pedrodemargomes@gmail.com">2025</a>,
Pedro Demarchi Gomes proposed extending DAMON for writes-only monitoring.</p>
<p>Those proposals are not yet upstreamed though.  We continued similar DAMON
extension discussions publicly and privately, with multiple parties, though.</p>
<p>I was recently taking some time on these, and happy to announce the first
working prototype for the extensions.  Please note that it is working in a way
that you can at least try, but the implementation is gross, unupstreamable, and
may contain many bugs.</p>
<p>On Linux kernel that built with some hacks that exist in damon/next tree as of
this writing (2025-08-03), users can do data access monitoring for only writes,
or for accesses made by given set of CPUs using the latest version of DAMON
user-space tool, damo, on its development
<a href="https://github.com/damonitor/damo/tree/next">branch</a>.</p>
<h2 id="write-only-access-monitoring">Write-only Access Monitoring</h2>
<p>Users can do write-only data access monitoring by adding
<code>--exp_ops_use_reports</code> and <code>--exp_ops_write_only</code> options with value <code>y</code> to
the usual DAMON parameters setup commands including <code>damo start</code> and <code>damo tune</code>, like below.</p>
<pre tabindex="0"><code>damo start --exp_ops_use_reports y --exp_ops_write_only y
</code></pre><p>Then DAMON will silently ignore read accesses, and show only the accesses that
made for writes.</p>
<p>Note that only physical address space monitoring is supported for now.</p>
<h2 id="cpus-only-access-monitoring">CPUs-only Access Monitoring</h2>
<p>Users can monitor the data accesses made by only specific CPUs by adding
<code>--exp_ops_use_reports</code> and <code>--exp_ops_cpus options</code> to the usual DAMON
parameters setup commands including <code>damo start</code> and <code>damo tune</code>, like below.</p>
<pre tabindex="0"><code>damo start --exp_ops_use_reports y --exp_ops_cpus 0-3,5-7,9
</code></pre><p><code>--exp_ops_use_reports</code> argument should always be y.</p>
<p><code>--exp_ops_cpus</code> option should be given with a list of the desired CPUs. In
this example, accesses that made by only CPUs of id 0, 1, 2, 3, 5, 6, 7, or 9
will be monitored and reported. The format of the cpus list is same to that for
<a href="https://docs.kernel.org/admin-guide/cgroup-v2.html#cpuset-interface-files">cpuset.cpus</a>
file of cgroup v2.</p>
<p>Note that only physical address space monitoring is supported for now.</p>
<h2 id="cautions-and-plan-to-drop-experimental-tag">Cautions and Plan to Drop Experimental Tag</h2>
<p>The write-only and cpus-only monitoring features require changes in Linux
kernel that not yet upstreamed. The changes are available at
<a href="https://git.kernel.org/pub/scm/linux/kernel/git/sj/linux.git/log/?h=damon/next">damon/next</a>
tree, which is for containing under-development DAMON works, as of this writing
(2025-08-03). To make those upstreamed, we may need significant amount of
efforts. Many changes could be made on the upstreamed version. In the worst
case, we would forgive upstreaming the changes to mainline kernel, and drop the
support on the damon/next tree.</p>
<p>The user interface for these features on damo will definitely be changed in
future. At least, <code>--exp_</code> part will be removed.</p>
<p>Finally, as of this writing (2025-08-03), the features are nearly not tested,
so there could be many bugs.</p>
<p>So, please feel free to try and let us know bugs that you found, and if it is
useful and worthy enough to make the upstream efforts. But, please don&rsquo;t make
your long term important works depend on these.</p>

            </div>
        </article></main>
</div>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <div class="footer_social-icons">
<a href="https://github.com/damonitor" target="_blank" rel="noopener noreferrer me"
    title="Github">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>
</a>
<a href="/index.xml" target="_blank" rel="noopener noreferrer me"
    title="Rss">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 11a9 9 0 0 1 9 9" />
    <path d="M4 4a16 16 0 0 1 16 16" />
    <circle cx="5" cy="19" r="1" />
</svg>
</a>
</div>
    <small class="footer_copyright">
        © 2025 SJ.
        Powered by <a href="https://github.com/hugo-sid/hugo-blog-awesome" target="_blank" rel="noopener">Hugo blog awesome</a>.
    </small>
</footer><a href="#" title="Go to top" id="totop">
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" stroke="currentColor" viewBox="0 96 960 960">
    <path d="M283 704.739 234.261 656 480 410.261 725.739 656 677 704.739l-197-197-197 197Z"/>
</svg>

</a>


    




    
    
        
    

    
    
        
    



    
    <script src="https://damonitor.github.io/js/main.min.35f435a5d8eac613c52daa28d8af544a4512337d3e95236e4a4978417b8dcb2f.js" integrity="sha256-NfQ1pdjqxhPFLaoo2K9USkUSM30&#43;lSNuSkl4QXuNyy8="></script>

    

</body>
</html>
