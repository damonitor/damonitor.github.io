

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>DEC EtherWORKS Ethernet De4x5 cards &mdash; The Linux Kernel  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../../',
              VERSION:'',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.8.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../admin-guide/mm/damon/index.html">Monitoring Data Accesses</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../vm/damon/index.html">DAMON: Data Access MONitor</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
      <li>DEC EtherWORKS Ethernet De4x5 cards</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/networking/device_drivers/dec/de4x5.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="dec-etherworks-ethernet-de4x5-cards">
<h1>DEC EtherWORKS Ethernet De4x5 cards<a class="headerlink" href="#dec-etherworks-ethernet-de4x5-cards" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><p>Originally,   this  driver  was    written  for the  Digital   Equipment
Corporation series of EtherWORKS Ethernet cards:</p>
<blockquote>
<div><ul class="simple">
<li>DE425 TP/COAX EISA</li>
<li>DE434 TP PCI</li>
<li>DE435 TP/COAX/AUI PCI</li>
<li>DE450 TP/COAX/AUI PCI</li>
<li>DE500 10/100 PCI Fasternet</li>
</ul>
</div></blockquote>
<p>but it  will  now attempt  to  support all  cards which   conform to the
Digital Semiconductor   SROM   Specification.    The  driver   currently
recognises the following chips:</p>
<blockquote>
<div><ul class="simple">
<li>DC21040  (no SROM)</li>
<li>DC21041[A]</li>
<li>DC21140[A]</li>
<li>DC21142</li>
<li>DC21143</li>
</ul>
</div></blockquote>
<p>So far the driver is known to work with the following cards:</p>
<blockquote>
<div><ul class="simple">
<li>KINGSTON</li>
<li>Linksys</li>
<li>ZNYX342</li>
<li>SMC8432</li>
<li>SMC9332 (w/new SROM)</li>
<li>ZNYX31[45]</li>
<li>ZNYX346 10/100 4 port (can act as a 10/100 bridge!)</li>
</ul>
</div></blockquote>
<p>The driver has been tested on a relatively busy network using the DE425,
DE434, DE435 and DE500 cards and benchmarked with ‘ttcp’: it transferred
16M of data to a DECstation 5000/200 as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>            TCP           UDP
         TX     RX     TX     RX
DE425   1030k  997k   1170k  1128k
DE434   1063k  995k   1170k  1125k
DE435   1063k  995k   1170k  1125k
DE500   1063k  998k   1170k  1125k  in 10Mb/s mode
</pre></div>
</div>
<p>All  values are typical (in   kBytes/sec) from a  sample  of 4 for  each
measurement. Their error is +/-20k on a quiet (private) network and also
depend on what load the CPU has.</p>
</div></blockquote>
<hr class="docutils" />
<blockquote>
<div><p>The ability to load this  driver as a loadable  module has been included
and used extensively  during the driver development  (to save those long
reboot sequences).  Loadable module support  under PCI and EISA has been
achieved by letting the driver autoprobe as if it were compiled into the
kernel. Do make sure  you’re not sharing  interrupts with anything  that
cannot accommodate  interrupt  sharing!</p>
<p>To utilise this ability, you have to do 8 things:</p>
<ol class="arabic" start="0">
<li><p class="first">have a copy of the loadable modules code installed on your system.</p>
</li>
<li><p class="first">copy de4x5.c from the  /linux/drivers/net directory to your favourite
temporary directory.</p>
</li>
<li><p class="first">for fixed  autoprobes (not  recommended),  edit the source code  near
line 5594 to reflect the I/O address  you’re using, or assign these when
loading by:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>insmod de4x5 io=0xghh           where g = bus number
                                     hh = device number
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>autoprobing for modules is now supported by default. You may just
use:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>insmod de4x5
</pre></div>
</div>
<p class="last">to load all available boards. For a specific board, still use
the ‘io=?’ above.</p>
</div>
</li>
<li><p class="first">compile  de4x5.c, but include -DMODULE in  the command line to ensure
that the correct bits are compiled (see end of source code).</p>
</li>
<li><p class="first">if you are wanting to add a new  card, goto 5. Otherwise, recompile a
kernel with the de4x5 configuration turned off and reboot.</p>
</li>
<li><p class="first">insmod de4x5 [io=0xghh]</p>
</li>
<li><p class="first">run the net startup bits for your new eth?? interface(s) manually
(usually /etc/rc.inet[12] at boot time).</p>
</li>
<li><p class="first">enjoy!</p>
</li>
</ol>
<p>To unload a module, turn off the associated interface(s)
‘ifconfig eth?? down’ then ‘rmmod de4x5’.</p>
<p>Automedia detection is included so that in  principle you can disconnect
from, e.g.  TP, reconnect  to BNC  and  things will still work  (after a
pause while the   driver figures out   where its media went).  My tests
using ping showed that it appears to work….</p>
<p>By  default,  the driver will  now   autodetect any  DECchip based card.
Should you have a need to restrict the driver to DIGITAL only cards, you
can compile with a  DEC_ONLY define, or if  loading as a module, use the
‘dec_only=1’  parameter.</p>
<p>I’ve changed the timing routines to  use the kernel timer and scheduling
functions  so that the  hangs  and other assorted problems that occurred
while autosensing the  media  should be gone.  A  bonus  for the DC21040
auto  media sense algorithm is  that it can now  use one that is more in
line with the  rest (the DC21040  chip doesn’t  have a hardware  timer).
The downside is the 1 ‘jiffies’ (10ms) resolution.</p>
<p>IEEE 802.3u MII interface code has  been added in anticipation that some
products may use it in the future.</p>
<p>The SMC9332 card  has a non-compliant SROM  which needs fixing -  I have
patched this  driver to detect it  because the SROM format used complies
to a previous DEC-STD format.</p>
<p>I have removed the buffer copies needed for receive on Intels.  I cannot
remove them for   Alphas since  the  Tulip hardware   only does longword
aligned  DMA transfers  and  the  Alphas get   alignment traps with  non
longword aligned data copies (which makes them really slow). No comment.</p>
<p>I  have added SROM decoding  routines to make this  driver work with any
card that  supports the Digital  Semiconductor SROM spec. This will help
all  cards running the dc2114x  series chips in particular.  Cards using
the dc2104x  chips should run correctly with  the basic  driver.  I’m in
debt to &lt;<a class="reference external" href="mailto:mjacob&#37;&#52;&#48;feral&#46;com">mjacob<span>&#64;</span>feral<span>&#46;</span>com</a>&gt; for the  testing and feedback that helped get
this feature working.  So far we have  tested KINGSTON, SMC8432, SMC9332
(with the latest SROM complying  with the SROM spec  V3: their first was
broken), ZNYX342  and  LinkSys. ZNYX314 (dual  21041  MAC) and  ZNYX 315
(quad 21041 MAC)  cards also  appear  to work despite their  incorrectly
wired IRQs.</p>
<p>I have added a temporary fix for interrupt problems when some SCSI cards
share the same interrupt as the DECchip based  cards. The problem occurs
because  the SCSI card wants to  grab the interrupt  as a fast interrupt
(runs the   service routine with interrupts turned   off) vs.  this card
which really needs to run the service routine with interrupts turned on.
This driver will  now   add the interrupt service   routine  as  a  fast
interrupt if it   is bounced from the   slow interrupt.  THIS IS NOT   A
RECOMMENDED WAY TO RUN THE DRIVER  and has been done  for a limited time
until  people   sort  out their  compatibility    issues and the  kernel
interrupt  service code  is  fixed.   YOU  SHOULD SEPARATE OUT  THE FAST
INTERRUPT CARDS FROM THE SLOW INTERRUPT CARDS to ensure that they do not
run on the same interrupt. PCMCIA/CardBus is another can of worms…</p>
<p>Finally, I think  I have really  fixed  the module  loading problem with
more than one DECchip based  card.  As a  side effect, I don’t mess with
the  device structure any  more which means that  if more than 1 card in
2.0.x is    installed (4  in   2.1.x),  the  user   will have   to  edit
linux/drivers/net/Space.c  to make room for  them. Hence, module loading
is  the preferred way to use   this driver, since  it  doesn’t have this
limitation.</p>
<p>Where SROM media  detection is used and  full duplex is specified in the
SROM,  the feature is  ignored unless  lp-&gt;params.fdx  is set at compile
time  OR during  a   module load  (insmod  de4x5   args=’eth??:fdx’ [see
below]).  This is because there  is no way  to automatically detect full
duplex   links  except through   autonegotiation.    When I  include the
autonegotiation feature in  the SROM autoconf  code, this detection will
occur automatically for that case.</p>
<p>Command line  arguments are  now allowed, similar to  passing  arguments
through LILO. This will allow a per adapter board set  up of full duplex
and media. The only lexical constraints are:  the board name (dev-&gt;name)
appears in  the list before its parameters.  The list of parameters ends
either at the end of the parameter list or with another board name.  The
following parameters are allowed:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="84%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>fdx</td>
<td>for full duplex</td>
</tr>
<tr class="row-even"><td>autosense</td>
<td>to set the media/speed; with the following
sub-parameters:
TP, TP_NW, BNC, AUI, BNC_AUI, 100Mb, 10Mb, AUTO</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Case sensitivity is important  for  the sub-parameters. They <em>must</em>   be
upper case. Examples:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>insmod de4x5 args=&#39;eth1:fdx autosense=BNC eth0:autosense=100Mb&#39;.
</pre></div>
</div>
<p>For a compiled in driver, in linux/drivers/net/CONFIG, place e.g.:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>DE4X5_OPTS = -DDE4X5_PARM=&#39;&quot;eth0:fdx autosense=AUI eth2:autosense=TP&quot;&#39;
</pre></div>
</div>
<p>Yes,  I know full duplex  isn’t permissible on BNC  or AUI; they’re just
examples. By default, full duplex is turned  off and AUTO is the default
autosense setting. In  reality, I expect only the  full duplex option to
be used. Note the use of single quotes in the two examples above and the
lack of commas to separate items.</p>
</div></blockquote>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>