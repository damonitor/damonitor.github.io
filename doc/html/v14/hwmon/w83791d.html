

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Kernel driver w83791d &mdash; The Linux Kernel  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.7.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/mm/damon/index.html">DAMON: Data Access MONitor</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Kernel driver w83791d</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/hwmon/w83791d.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="kernel-driver-w83791d">
<h1>Kernel driver w83791d<a class="headerlink" href="#kernel-driver-w83791d" title="Permalink to this headline">¶</a></h1>
<p>Supported chips:</p>
<blockquote>
<div><ul>
<li><p class="first">Winbond W83791D</p>
<p>Prefix: ‘w83791d’</p>
<p>Addresses scanned: I2C 0x2c - 0x2f</p>
<p>Datasheet: <a class="reference external" href="http://www.winbond-usa.com/products/winbond_products/pdfs/PCIC/W83791D_W83791Gb.pdf">http://www.winbond-usa.com/products/winbond_products/pdfs/PCIC/W83791D_W83791Gb.pdf</a></p>
</li>
</ul>
</div></blockquote>
<p>Author: Charles Spirakis &lt;<a class="reference external" href="mailto:bezaur&#37;&#52;&#48;gmail&#46;com">bezaur<span>&#64;</span>gmail<span>&#46;</span>com</a>&gt;</p>
<p>This driver was derived from the w83781d.c and w83792d.c source files.</p>
<p>Credits:</p>
<blockquote>
<div><p>w83781d.c:</p>
<blockquote>
<div><ul class="simple">
<li>Frodo Looijaard &lt;<a class="reference external" href="mailto:frodol&#37;&#52;&#48;dds&#46;nl">frodol<span>&#64;</span>dds<span>&#46;</span>nl</a>&gt;,</li>
<li>Philip Edelbrock &lt;<a class="reference external" href="mailto:phil&#37;&#52;&#48;netroedge&#46;com">phil<span>&#64;</span>netroedge<span>&#46;</span>com</a>&gt;,</li>
<li>Mark Studebaker &lt;<a class="reference external" href="mailto:mdsxyz123&#37;&#52;&#48;yahoo&#46;com">mdsxyz123<span>&#64;</span>yahoo<span>&#46;</span>com</a>&gt;</li>
</ul>
</div></blockquote>
<p>w83792d.c:</p>
<blockquote>
<div><ul class="simple">
<li>Shane Huang (Winbond),</li>
<li>Rudolf Marek &lt;<a class="reference external" href="mailto:r&#46;marek&#37;&#52;&#48;assembler&#46;cz">r<span>&#46;</span>marek<span>&#64;</span>assembler<span>&#46;</span>cz</a>&gt;</li>
</ul>
</div></blockquote>
</div></blockquote>
<p>Additional contributors:</p>
<blockquote>
<div><ul class="simple">
<li>Sven Anders &lt;<a class="reference external" href="mailto:anders&#37;&#52;&#48;anduras&#46;de">anders<span>&#64;</span>anduras<span>&#46;</span>de</a>&gt;</li>
<li>Marc Hulsman &lt;<a class="reference external" href="mailto:m&#46;hulsman&#37;&#52;&#48;tudelft&#46;nl">m<span>&#46;</span>hulsman<span>&#64;</span>tudelft<span>&#46;</span>nl</a>&gt;</li>
</ul>
</div></blockquote>
<div class="section" id="module-parameters">
<h2>Module Parameters<a class="headerlink" href="#module-parameters" title="Permalink to this headline">¶</a></h2>
<ul>
<li><dl class="first docutils">
<dt>init boolean</dt>
<dd><p class="first">(default 0)</p>
<p class="last">Use ‘init=1’ to have the driver do extra software initializations.
The default behavior is to do the minimum initialization possible
and depend on the BIOS to properly setup the chip. If you know you
have a w83791d and you’re having problems, try init=1 before trying
reset=1.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>reset boolean</dt>
<dd><p class="first">(default 0)</p>
<p class="last">Use ‘reset=1’ to reset the chip (via index 0x40, bit 7). The default
behavior is no chip reset to preserve BIOS settings.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>force_subclients=bus,caddr,saddr,saddr</dt>
<dd><p class="first last">This is used to force the i2c addresses for subclients of
a certain chip. Example usage is <cite>force_subclients=0,0x2f,0x4a,0x4b</cite>
to force the subclients of chip 0x2f on bus 0 to i2c addresses
0x4a and 0x4b.</p>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>This driver implements support for the Winbond W83791D chip. The W83791G
chip appears to be the same as the W83791D but is lead free.</p>
<p>Detection of the chip can sometimes be foiled because it can be in an
internal state that allows no clean access (Bank with ID register is not
currently selected). If you know the address of the chip, use a ‘force’
parameter; this will put it into a more well-behaved state first.</p>
<p>The driver implements three temperature sensors, ten voltage sensors,
five fan rotation speed sensors and manual PWM control of each fan.</p>
<p>Temperatures are measured in degrees Celsius and measurement resolution is 1
degC for temp1 and 0.5 degC for temp2 and temp3. An alarm is triggered when
the temperature gets higher than the Overtemperature Shutdown value; it stays
on until the temperature falls below the Hysteresis value.</p>
<p>Voltage sensors (also known as IN sensors) report their values in millivolts.
An alarm is triggered if the voltage has crossed a programmable minimum
or maximum limit.</p>
<p>Fan rotation speeds are reported in RPM (rotations per minute). An alarm is
triggered if the rotation speed has dropped below a programmable limit. Fan
readings can be divided by a programmable divider (1, 2, 4, 8, 16,
32, 64 or 128 for all fans) to give the readings more range or accuracy.</p>
<p>Each fan controlled is controlled by PWM. The PWM duty cycle can be read and
set for each fan separately. Valid values range from 0 (stop) to 255 (full).
PWM 1-3 support Thermal Cruise mode, in which the PWMs are automatically
regulated to keep respectively temp 1-3 at a certain target temperature.
See below for the description of the sysfs-interface.</p>
<p>The w83791d has a global bit used to enable beeping from the speaker when an
alarm is triggered as well as a bitmask to enable or disable the beep for
specific alarms. You need both the global beep enable bit and the
corresponding beep bit to be on for a triggered alarm to sound a beep.</p>
<p>The sysfs interface to the global enable is via the sysfs beep_enable file.
This file is used for both legacy and new code.</p>
<p>The sysfs interface to the beep bitmask has migrated from the original legacy
method of a single sysfs beep_mask file to a newer method using multiple
<cite>*_beep</cite> files as described in <cite>Documentation/hwmon/sysfs-interface.rst</cite>.</p>
<p>A similar change has occurred for the bitmap corresponding to the alarms. The
original legacy method used a single sysfs alarms file containing a bitmap
of triggered alarms. The newer method uses multiple sysfs <cite>*_alarm</cite> files
(again following the pattern described in sysfs-interface).</p>
<p>Since both methods read and write the underlying hardware, they can be used
interchangeably and changes in one will automatically be reflected by
the other. If you use the legacy bitmask method, your user-space code is
responsible for handling the fact that the alarms and beep_mask bitmaps
are not the same (see the table below).</p>
<p>NOTE: All new code should be written to use the newer sysfs-interface
specification as that avoids bitmap problems and is the preferred interface
going forward.</p>
<p>The driver reads the hardware chip values at most once every three seconds.
User mode code requesting values more often will receive cached values.</p>
</div>
<div class="section" id="sys-files">
<h2>/sys files<a class="headerlink" href="#sys-files" title="Permalink to this headline">¶</a></h2>
<p>The sysfs-interface is documented in the ‘sysfs-interface’ file. Only
chip-specific options are documented here.</p>
<table border="1" class="docutils">
<colgroup>
<col width="29%" />
<col width="71%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>pwm[1-3]_enable</td>
<td><p class="first">this file controls mode of fan/temperature control for
fan 1-3. Fan/PWM 4-5 only support manual mode.</p>
<blockquote class="last">
<div><ul class="simple">
<li>1 Manual mode</li>
<li>2 Thermal Cruise mode</li>
<li>3 Fan Speed Cruise mode (no further support)</li>
</ul>
</div></blockquote>
</td>
</tr>
<tr class="row-even"><td>temp[1-3]_target</td>
<td>defines the target temperature for Thermal Cruise mode.
Unit: millidegree Celsius
RW</td>
</tr>
<tr class="row-odd"><td>temp[1-3]_tolerance</td>
<td>temperature tolerance for Thermal Cruise mode.
Specifies an interval around the target temperature
in which the fan speed is not changed.
Unit: millidegree Celsius
RW</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="alarms-bitmap-vs-beep-mask-bitmask">
<h2>Alarms bitmap vs. beep_mask bitmask<a class="headerlink" href="#alarms-bitmap-vs-beep-mask-bitmask" title="Permalink to this headline">¶</a></h2>
<p>For legacy code using the alarms and beep_mask files:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="14%" />
<col width="16%" />
<col width="46%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Signal</th>
<th class="head">Alarms</th>
<th class="head">beep_mask</th>
<th class="head">Obs</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>in0 (VCORE)</td>
<td>0x000001</td>
<td>0x000001</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>in1 (VINR0)</td>
<td>0x000002</td>
<td>0x002000</td>
<td>&lt;== mismatch</td>
</tr>
<tr class="row-even"><td>in2 (+3.3VIN)</td>
<td>0x000004</td>
<td>0x000004</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>in3 (5VDD)</td>
<td>0x000008</td>
<td>0x000008</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>in4 (+12VIN)</td>
<td>0x000100</td>
<td>0x000100</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>in5 (-12VIN)</td>
<td>0x000200</td>
<td>0x000200</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>in6 (-5VIN)</td>
<td>0x000400</td>
<td>0x000400</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>in7 (VSB)</td>
<td>0x080000</td>
<td>0x010000</td>
<td>&lt;== mismatch</td>
</tr>
<tr class="row-even"><td>in8 (VBAT)</td>
<td>0x100000</td>
<td>0x020000</td>
<td>&lt;== mismatch</td>
</tr>
<tr class="row-odd"><td>in9 (VINR1)</td>
<td>0x004000</td>
<td>0x004000</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>temp1</td>
<td>0x000010</td>
<td>0x000010</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>temp2</td>
<td>0x000020</td>
<td>0x000020</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>temp3</td>
<td>0x002000</td>
<td>0x000002</td>
<td>&lt;== mismatch</td>
</tr>
<tr class="row-odd"><td>fan1</td>
<td>0x000040</td>
<td>0x000040</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>fan2</td>
<td>0x000080</td>
<td>0x000080</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>fan3</td>
<td>0x000800</td>
<td>0x000800</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>fan4</td>
<td>0x200000</td>
<td>0x200000</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>fan5</td>
<td>0x400000</td>
<td>0x400000</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>tart1</td>
<td>0x010000</td>
<td>0x040000</td>
<td>&lt;== mismatch</td>
</tr>
<tr class="row-odd"><td>tart2</td>
<td>0x020000</td>
<td>0x080000</td>
<td>&lt;== mismatch</td>
</tr>
<tr class="row-even"><td>tart3</td>
<td>0x040000</td>
<td>0x100000</td>
<td>&lt;== mismatch</td>
</tr>
<tr class="row-odd"><td>case_open</td>
<td>0x001000</td>
<td>0x001000</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>global_enable</td>
<td><ul class="first last simple">
<li></li>
</ul>
</td>
<td>0x800000</td>
<td>(modified via beep_enable)</td>
</tr>
</tbody>
</table>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>