

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Operating FCoE using bnx2fc &mdash; The Linux Kernel  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.7.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/mm/damon/index.html">DAMON: Data Access MONitor</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Operating FCoE using bnx2fc</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/scsi/bnx2fc.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="operating-fcoe-using-bnx2fc">
<h1>Operating FCoE using bnx2fc<a class="headerlink" href="#operating-fcoe-using-bnx2fc" title="Permalink to this headline">¶</a></h1>
<p>Broadcom FCoE offload through bnx2fc is full stateful hardware offload that
cooperates with all interfaces provided by the Linux ecosystem for FC/FCoE and
SCSI controllers.  As such, FCoE functionality, once enabled is largely
transparent. Devices discovered on the SAN will be registered and unregistered
automatically with the upper storage layers.</p>
<p>Despite the fact that the Broadcom’s FCoE offload is fully offloaded, it does
depend on the state of the network interfaces to operate. As such, the network
interface (e.g. eth0) associated with the FCoE offload initiator must be ‘up’.
It is recommended that the network interfaces be configured to be brought up
automatically at boot time.</p>
<p>Furthermore, the Broadcom FCoE offload solution creates VLAN interfaces to
support the VLANs that have been discovered for FCoE operation (e.g.
eth0.1001-fcoe).  Do not delete or disable these interfaces or FCoE operation
will be disrupted.</p>
<div class="section" id="driver-usage-model">
<h2>Driver Usage Model:<a class="headerlink" href="#driver-usage-model" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Ensure that fcoe-utils package is installed.</li>
</ol>
<p>2. Configure the interfaces on which bnx2fc driver has to operate on.
Here are the steps to configure:</p>
<blockquote>
<div><ol class="loweralpha simple">
<li>cd /etc/fcoe</li>
<li>copy cfg-ethx to cfg-eth5 if FCoE has to be enabled on eth5.</li>
<li>Repeat this for all the interfaces where FCoE has to be enabled.</li>
<li>Edit all the cfg-eth files to set “no” for DCB_REQUIRED** field, and
“yes” for AUTO_VLAN.</li>
<li>Other configuration parameters should be left as default</li>
</ol>
</div></blockquote>
<ol class="arabic simple" start="3">
<li>Ensure that “bnx2fc” is in SUPPORTED_DRIVERS list in /etc/fcoe/config.</li>
</ol>
<p>4. Start fcoe service. (service fcoe start). If Broadcom devices are present in
the system, bnx2fc driver would automatically claim the interfaces, starts vlan
discovery and log into the targets.</p>
<p>5. “Symbolic Name” in ‘fcoeadm -i’ output would display if bnx2fc has claimed
the interface.</p>
<p>Eg:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[root@bh2 ~]# fcoeadm -i
   Description:      NetXtreme II BCM57712 10 Gigabit Ethernet
   Revision:         01
   Manufacturer:     Broadcom Corporation
   Serial Number:    0010186FD558
   Driver:           bnx2x 1.70.00-0
   Number of Ports:  2

       Symbolic Name:     bnx2fc v1.0.5 over eth5.4
       OS Device Name:    host11
       Node Name:         0x10000010186FD559
       Port Name:         0x20000010186FD559
       FabricName:        0x2001000DECB3B681
       Speed:             10 Gbit
       Supported Speed:   10 Gbit
       MaxFrameSize:      2048
       FC-ID (Port ID):   0x0F0377
       State:             Online
</pre></div>
</div>
<ol class="arabic simple" start="6">
<li>Verify the vlan discovery is performed by running ifconfig and notice
&lt;INTERFACE&gt;.&lt;VLAN&gt;-fcoe interfaces are automatically created.</li>
</ol>
<p>Refer to fcoeadm manpage for more information on fcoeadm operations to
create/destroy interfaces or to display lun/target information.</p>
</div>
<div class="section" id="note">
<h2>NOTE<a class="headerlink" href="#note" title="Permalink to this headline">¶</a></h2>
<p>** Broadcom FCoE capable devices implement a DCBX/LLDP client on-chip. Only one
LLDP client is allowed per interface. For proper operation all host software
based DCBX/LLDP clients (e.g. lldpad) must be disabled. To disable lldpad on a
given interface, run the following command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>lldptool set-lldp -i &lt;interface_name&gt; adminStatus=disabled
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>