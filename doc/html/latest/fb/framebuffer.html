

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>The Frame Buffer Device &mdash; The Linux Kernel  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="What is gxfb?" href="gxfb.html" />
    <link rel="prev" title="The Framebuffer Console" href="fbcon.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.6.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/index.html">The Linux kernel user’s and administrator’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kbuild/index.html">Kernel Build System</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../firmware-guide/index.html">The Linux kernel firmware guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../userspace-api/index.html">The Linux kernel user-space API guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../process/index.html">Working with the kernel development community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev-tools/index.html">Development tools for the kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc-guide/index.html">How to write kernel documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kernel-hacking/index.html">Kernel Hacking Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trace/index.html">Linux Tracing Technologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../maintainer/index.html">Kernel Maintainer Handbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fault-injection/index.html">fault-injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../livepatch/index.html">Kernel Livepatching</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../driver-api/index.html">The Linux driver implementer’s API guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core-api/index.html">Core API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../locking/index.html">locking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../accounting/index.html">Accounting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../block/index.html">Block</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cdrom/index.html">cdrom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ide/index.html">Integrated Drive Electronics (IDE)</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Frame Buffer</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="api.html">The Frame Buffer Device API</a></li>
<li class="toctree-l2"><a class="reference internal" href="arkfb.html">arkfb - fbdev driver for ARK Logic chips</a></li>
<li class="toctree-l2"><a class="reference internal" href="aty128fb.html">What is aty128fb?</a></li>
<li class="toctree-l2"><a class="reference internal" href="cirrusfb.html">Framebuffer driver for Cirrus Logic chipsets</a></li>
<li class="toctree-l2"><a class="reference internal" href="cmap_xfbdev.html">Understanding fbdev’s cmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="deferred_io.html">Deferred IO</a></li>
<li class="toctree-l2"><a class="reference internal" href="efifb.html">What is efifb?</a></li>
<li class="toctree-l2"><a class="reference internal" href="ep93xx-fb.html">Driver for EP93xx LCD controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="ep93xx-fb.html#video-attribute-flags">Video Attribute Flags</a></li>
<li class="toctree-l2"><a class="reference internal" href="ep93xx-fb.html#platform-callbacks">Platform callbacks</a></li>
<li class="toctree-l2"><a class="reference internal" href="ep93xx-fb.html#setting-the-video-mode">Setting the video mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="ep93xx-fb.html#screenpage-bug">Screenpage bug</a></li>
<li class="toctree-l2"><a class="reference internal" href="fbcon.html">The Framebuffer Console</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">The Frame Buffer Device</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">0. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#user-s-view-of-dev-fb">1. User’s View of /dev/fb*</a></li>
<li class="toctree-l3"><a class="reference internal" href="#programmer-s-view-of-dev-fb">2. Programmer’s View of /dev/fb*</a></li>
<li class="toctree-l3"><a class="reference internal" href="#frame-buffer-resolution-maintenance">3. Frame Buffer Resolution Maintenance</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-x-server">4. The X Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="#video-mode-timings">5. Video Mode Timings</a></li>
<li class="toctree-l3"><a class="reference internal" href="#converting-xfree86-timing-values-info-frame-buffer-device-timings">6. Converting XFree86 timing values info frame buffer device timings</a></li>
<li class="toctree-l3"><a class="reference internal" href="#references">7. References</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mailing-list">8. Mailing list</a></li>
<li class="toctree-l3"><a class="reference internal" href="#downloading">9. Downloading</a></li>
<li class="toctree-l3"><a class="reference internal" href="#credits">10. Credits</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="gxfb.html">What is gxfb?</a></li>
<li class="toctree-l2"><a class="reference internal" href="intel810.html">Intel 810/815 Framebuffer driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="intelfb.html">Intel 830M/845G/852GM/855GM/865G/915G/945G Framebuffer driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="internals.html">Frame Buffer device internals</a></li>
<li class="toctree-l2"><a class="reference internal" href="lxfb.html">What is lxfb?</a></li>
<li class="toctree-l2"><a class="reference internal" href="matroxfb.html">What is matroxfb?</a></li>
<li class="toctree-l2"><a class="reference internal" href="metronomefb.html">Metronomefb</a></li>
<li class="toctree-l2"><a class="reference internal" href="modedb.html">modedb default video mode support</a></li>
<li class="toctree-l2"><a class="reference internal" href="pvr2fb.html">What is pvr2fb?</a></li>
<li class="toctree-l2"><a class="reference internal" href="pxafb.html">Driver for PXA25x LCD controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="s3fb.html">s3fb - fbdev driver for S3 Trio/Virge chips</a></li>
<li class="toctree-l2"><a class="reference internal" href="sa1100fb.html">What is sa1100fb?</a></li>
<li class="toctree-l2"><a class="reference internal" href="sh7760fb.html">SH7760/SH7763 integrated LCDC Framebuffer driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="sisfb.html">What is sisfb?</a></li>
<li class="toctree-l2"><a class="reference internal" href="sm501.html">sm501fb</a></li>
<li class="toctree-l2"><a class="reference internal" href="sm712fb.html">What is sm712fb?</a></li>
<li class="toctree-l2"><a class="reference internal" href="sstfb.html">sstfb</a></li>
<li class="toctree-l2"><a class="reference internal" href="tgafb.html">What is tgafb?</a></li>
<li class="toctree-l2"><a class="reference internal" href="tridentfb.html">Tridentfb</a></li>
<li class="toctree-l2"><a class="reference internal" href="udlfb.html">What is udlfb?</a></li>
<li class="toctree-l2"><a class="reference internal" href="uvesafb.html">uvesafb - A Generic Driver for VBE2+ compliant video cards</a></li>
<li class="toctree-l2"><a class="reference internal" href="vesafb.html">What is vesafb?</a></li>
<li class="toctree-l2"><a class="reference internal" href="viafb.html">VIA Integration Graphic Chip Console Framebuffer Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="vt8623fb.html">vt8623fb - fbdev driver for graphics core in VIA VT8623 chipset</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../fpga/index.html">fpga</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hid/index.html">Human Interface Devices (HID)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../i2c/index.html">I2C/SMBus Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../iio/index.html">Industrial I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../isdn/index.html">ISDN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infiniband/index.html">InfiniBand</a></li>
<li class="toctree-l1"><a class="reference internal" href="../leds/index.html">LEDs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../media/index.html">Linux Media Subsystem Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../netlabel/index.html">NetLabel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../networking/index.html">Linux Networking Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pcmcia/index.html">pcmcia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../power/index.html">Power Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../target/index.html">TCM Virtual Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../timers/index.html">timers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spi/index.html">Serial Peripheral Interface (SPI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../w1/index.html">1-Wire Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../watchdog/index.html">Linux Watchdog Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../virt/index.html">Linux Virtualization Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input/index.html">The Linux Input Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hwmon/index.html">Linux Hardware Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu/index.html">Linux GPU Driver Developer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security/index.html">Security Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sound/index.html">Linux Sound Subsystem Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../crypto/index.html">Linux Kernel Crypto API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../filesystems/index.html">Filesystems in the Linux kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vm/index.html">Linux Memory Management Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bpf/index.html">BPF Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usb/index.html">USB support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PCI/index.html">Linux PCI Bus Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc-devices/index.html">Assorted Miscellaneous Devices Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mic/index.html">Intel Many Integrated Core (MIC) architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scheduler/index.html">Linux Scheduler</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../asm-annotations.html">Assembler Annotations</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../arm/index.html">ARM Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../arm64/index.html">ARM64 Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ia64/index.html">IA-64 Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../m68k/index.html">m68k Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mips/index.html">MIPS-specific Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nios2/nios2.html">Linux on the Nios II architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../openrisc/index.html">OpenRISC Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parisc/index.html">PA-RISC Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../powerpc/index.html">powerpc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../riscv/index.html">RISC-V architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../s390/index.html">s390 Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sh/index.html">SuperH Interfaces Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sparc/index.html">Sparc Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../x86/index.html">x86-specific Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../xtensa/index.html">Xtensa Architecture</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../filesystems/ext4/index.html">ext4 Data Structures and Algorithms</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../translations/index.html">Translations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Frame Buffer</a> &raquo;</li>
        
      <li>The Frame Buffer Device</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/fb/framebuffer.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="the-frame-buffer-device">
<h1>The Frame Buffer Device<a class="headerlink" href="#the-frame-buffer-device" title="Permalink to this headline">¶</a></h1>
<p>Last revised: May 10, 2001</p>
<div class="section" id="introduction">
<h2>0. Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The frame buffer device provides an abstraction for the graphics hardware. It
represents the frame buffer of some video hardware and allows application
software to access the graphics hardware through a well-defined interface, so
the software doesn’t need to know anything about the low-level (hardware
register) stuff.</p>
<p>The device is accessed through special device nodes, usually located in the
/dev directory, i.e. /dev/fb*.</p>
</div>
<div class="section" id="user-s-view-of-dev-fb">
<h2>1. User’s View of /dev/fb*<a class="headerlink" href="#user-s-view-of-dev-fb" title="Permalink to this headline">¶</a></h2>
<p>From the user’s point of view, the frame buffer device looks just like any
other device in /dev. It’s a character device using major 29; the minor
specifies the frame buffer number.</p>
<p>By convention, the following device nodes are used (numbers indicate the device
minor numbers):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> 0 = /dev/fb0      First frame buffer
 1 = /dev/fb1      Second frame buffer
     ...
31 = /dev/fb31     32nd frame buffer
</pre></div>
</div>
<p>For backwards compatibility, you may want to create the following symbolic
links:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/dev/fb0current -&gt; fb0
/dev/fb1current -&gt; fb1
</pre></div>
</div>
<p>and so on…</p>
<p>The frame buffer devices are also <cite>normal</cite> memory devices, this means, you can
read and write their contents. You can, for example, make a screen snapshot by:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>cp /dev/fb0 myfile
</pre></div>
</div>
<p>There also can be more than one frame buffer at a time, e.g. if you have a
graphics card in addition to the built-in hardware. The corresponding frame
buffer devices (/dev/fb0 and /dev/fb1 etc.) work independently.</p>
<p>Application software that uses the frame buffer device (e.g. the X server) will
use /dev/fb0 by default (older software uses /dev/fb0current). You can specify
an alternative frame buffer device by setting the environment variable
$FRAMEBUFFER to the path name of a frame buffer device, e.g. (for sh/bash
users):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>export FRAMEBUFFER=/dev/fb1
</pre></div>
</div>
<p>or (for csh users):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>setenv FRAMEBUFFER /dev/fb1
</pre></div>
</div>
<p>After this the X server will use the second frame buffer.</p>
</div>
<div class="section" id="programmer-s-view-of-dev-fb">
<h2>2. Programmer’s View of /dev/fb*<a class="headerlink" href="#programmer-s-view-of-dev-fb" title="Permalink to this headline">¶</a></h2>
<p>As you already know, a frame buffer device is a memory device like /dev/mem and
it has the same features. You can read it, write it, seek to some location in
it and mmap() it (the main usage). The difference is just that the memory that
appears in the special file is not the whole memory, but the frame buffer of
some video hardware.</p>
<p>/dev/fb* also allows several ioctls on it, by which lots of information about
the hardware can be queried and set. The color map handling works via ioctls,
too. Look into &lt;linux/fb.h&gt; for more information on what ioctls exist and on
which data structures they work. Here’s just a brief overview:</p>
<blockquote>
<div><ul class="simple">
<li>You can request unchangeable information about the hardware, like name,
organization of the screen memory (planes, packed pixels, …) and address
and length of the screen memory.</li>
<li>You can request and change variable information about the hardware, like
visible and virtual geometry, depth, color map format, timing, and so on.
If you try to change that information, the driver maybe will round up some
values to meet the hardware’s capabilities (or return EINVAL if that isn’t
possible).</li>
<li>You can get and set parts of the color map. Communication is done with 16
bits per color part (red, green, blue, transparency) to support all
existing hardware. The driver does all the computations needed to apply
it to the hardware (round it down to less bits, maybe throw away
transparency).</li>
</ul>
</div></blockquote>
<p>All this hardware abstraction makes the implementation of application programs
easier and more portable. E.g. the X server works completely on /dev/fb* and
thus doesn’t need to know, for example, how the color registers of the concrete
hardware are organized. XF68_FBDev is a general X server for bitmapped,
unaccelerated video hardware. The only thing that has to be built into
application programs is the screen organization (bitplanes or chunky pixels
etc.), because it works on the frame buffer image data directly.</p>
<p>For the future it is planned that frame buffer drivers for graphics cards and
the like can be implemented as kernel modules that are loaded at runtime. Such
a driver just has to call <a class="reference internal" href="../driver-api/frame-buffer.html#c.register_framebuffer" title="register_framebuffer"><code class="xref c c-func docutils literal notranslate"><span class="pre">register_framebuffer()</span></code></a> and supply some functions.
Writing and distributing such drivers independently from the kernel will save
much trouble…</p>
</div>
<div class="section" id="frame-buffer-resolution-maintenance">
<h2>3. Frame Buffer Resolution Maintenance<a class="headerlink" href="#frame-buffer-resolution-maintenance" title="Permalink to this headline">¶</a></h2>
<p>Frame buffer resolutions are maintained using the utility <cite>fbset</cite>. It can
change the video mode properties of a frame buffer device. Its main usage is
to change the current video mode, e.g. during boot up in one of your <cite>/etc/rc.*</cite>
or <cite>/etc/init.d/*</cite> files.</p>
<p>Fbset uses a video mode database stored in a configuration file, so you can
easily add your own modes and refer to them with a simple identifier.</p>
</div>
<div class="section" id="the-x-server">
<h2>4. The X Server<a class="headerlink" href="#the-x-server" title="Permalink to this headline">¶</a></h2>
<p>The X server (XF68_FBDev) is the most notable application program for the frame
buffer device. Starting with XFree86 release 3.2, the X server is part of
XFree86 and has 2 modes:</p>
<blockquote>
<div><ul>
<li><p class="first">If the <cite>Display</cite> subsection for the <cite>fbdev</cite> driver in the /etc/XF86Config
file contains a:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Modes &quot;default&quot;
</pre></div>
</div>
<p>line, the X server will use the scheme discussed above, i.e. it will start
up in the resolution determined by /dev/fb0 (or $FRAMEBUFFER, if set). You
still have to specify the color depth (using the Depth keyword) and virtual
resolution (using the Virtual keyword) though. This is the default for the
configuration file supplied with XFree86. It’s the most simple
configuration, but it has some limitations.</p>
</li>
<li><p class="first">Therefore it’s also possible to specify resolutions in the /etc/XF86Config
file. This allows for on-the-fly resolution switching while retaining the
same virtual desktop size. The frame buffer device that’s used is still
/dev/fb0current (or $FRAMEBUFFER), but the available resolutions are
defined by /etc/XF86Config now. The disadvantage is that you have to
specify the timings in a different format (but <cite>fbset -x</cite> may help).</p>
</li>
</ul>
</div></blockquote>
<p>To tune a video mode, you can use fbset or xvidtune. Note that xvidtune doesn’t
work 100% with XF68_FBDev: the reported clock values are always incorrect.</p>
</div>
<div class="section" id="video-mode-timings">
<h2>5. Video Mode Timings<a class="headerlink" href="#video-mode-timings" title="Permalink to this headline">¶</a></h2>
<p>A monitor draws an image on the screen by using an electron beam (3 electron
beams for color models, 1 electron beam for monochrome monitors). The front of
the screen is covered by a pattern of colored phosphors (pixels). If a phosphor
is hit by an electron, it emits a photon and thus becomes visible.</p>
<p>The electron beam draws horizontal lines (scanlines) from left to right, and
from the top to the bottom of the screen. By modifying the intensity of the
electron beam, pixels with various colors and intensities can be shown.</p>
<p>After each scanline the electron beam has to move back to the left side of the
screen and to the next line: this is called the horizontal retrace. After the
whole screen (frame) was painted, the beam moves back to the upper left corner:
this is called the vertical retrace. During both the horizontal and vertical
retrace, the electron beam is turned off (blanked).</p>
<p>The speed at which the electron beam paints the pixels is determined by the
dotclock in the graphics board. For a dotclock of e.g. 28.37516 MHz (millions
of cycles per second), each pixel is 35242 ps (picoseconds) long:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>1/(28.37516E6 Hz) = 35.242E-9 s
</pre></div>
</div>
<p>If the screen resolution is 640x480, it will take:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>640*35.242E-9 s = 22.555E-6 s
</pre></div>
</div>
<p>to paint the 640 (xres) pixels on one scanline. But the horizontal retrace
also takes time (e.g. 272 <cite>pixels</cite>), so a full scanline takes:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>(640+272)*35.242E-9 s = 32.141E-6 s
</pre></div>
</div>
<p>We’ll say that the horizontal scanrate is about 31 kHz:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>1/(32.141E-6 s) = 31.113E3 Hz
</pre></div>
</div>
<p>A full screen counts 480 (yres) lines, but we have to consider the vertical
retrace too (e.g. 49 <cite>lines</cite>). So a full screen will take:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>(480+49)*32.141E-6 s = 17.002E-3 s
</pre></div>
</div>
<p>The vertical scanrate is about 59 Hz:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>1/(17.002E-3 s) = 58.815 Hz
</pre></div>
</div>
<p>This means the screen data is refreshed about 59 times per second. To have a
stable picture without visible flicker, VESA recommends a vertical scanrate of
at least 72 Hz. But the perceived flicker is very human dependent: some people
can use 50 Hz without any trouble, while I’ll notice if it’s less than 80 Hz.</p>
<p>Since the monitor doesn’t know when a new scanline starts, the graphics board
will supply a synchronization pulse (horizontal sync or hsync) for each
scanline.  Similarly it supplies a synchronization pulse (vertical sync or
vsync) for each new frame. The position of the image on the screen is
influenced by the moments at which the synchronization pulses occur.</p>
<p>The following picture summarizes all timings. The horizontal retrace time is
the sum of the left margin, the right margin and the hsync length, while the
vertical retrace time is the sum of the upper margin, the lower margin and the
vsync length:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>+----------+---------------------------------------------+----------+-------+
|          |                ↑                            |          |       |
|          |                |upper_margin                |          |       |
|          |                ↓                            |          |       |
+----------###############################################----------+-------+
|          #                ↑                            #          |       |
|          #                |                            #          |       |
|          #                |                            #          |       |
|          #                |                            #          |       |
|   left   #                |                            #  right   | hsync |
|  margin  #                |       xres                 #  margin  |  len  |
|&lt;--------&gt;#&lt;---------------+---------------------------&gt;#&lt;--------&gt;|&lt;-----&gt;|
|          #                |                            #          |       |
|          #                |                            #          |       |
|          #                |                            #          |       |
|          #                |yres                        #          |       |
|          #                |                            #          |       |
|          #                |                            #          |       |
|          #                |                            #          |       |
|          #                |                            #          |       |
|          #                |                            #          |       |
|          #                |                            #          |       |
|          #                |                            #          |       |
|          #                |                            #          |       |
|          #                ↓                            #          |       |
+----------###############################################----------+-------+
|          |                ↑                            |          |       |
|          |                |lower_margin                |          |       |
|          |                ↓                            |          |       |
+----------+---------------------------------------------+----------+-------+
|          |                ↑                            |          |       |
|          |                |vsync_len                   |          |       |
|          |                ↓                            |          |       |
+----------+---------------------------------------------+----------+-------+
</pre></div>
</div>
<p>The frame buffer device expects all horizontal timings in number of dotclocks
(in picoseconds, 1E-12 s), and vertical timings in number of scanlines.</p>
</div>
<div class="section" id="converting-xfree86-timing-values-info-frame-buffer-device-timings">
<h2>6. Converting XFree86 timing values info frame buffer device timings<a class="headerlink" href="#converting-xfree86-timing-values-info-frame-buffer-device-timings" title="Permalink to this headline">¶</a></h2>
<p>An XFree86 mode line consists of the following fields:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&quot;800x600&quot;     50      800  856  976 1040    600  637  643  666
&lt; name &gt;     DCF       HR  SH1  SH2  HFL     VR  SV1  SV2  VFL
</pre></div>
</div>
<p>The frame buffer device uses the following fields:</p>
<blockquote>
<div><ul class="simple">
<li>pixclock: pixel clock in ps (pico seconds)</li>
<li>left_margin: time from sync to picture</li>
<li>right_margin: time from picture to sync</li>
<li>upper_margin: time from sync to picture</li>
<li>lower_margin: time from picture to sync</li>
<li>hsync_len: length of horizontal sync</li>
<li>vsync_len: length of vertical sync</li>
</ul>
</div></blockquote>
<ol class="arabic">
<li><p class="first">Pixelclock:</p>
<p>xfree: in MHz</p>
<p>fb: in picoseconds (ps)</p>
<p>pixclock = 1000000 / DCF</p>
</li>
<li><p class="first">horizontal timings:</p>
<p>left_margin = HFL - SH2</p>
<p>right_margin = SH1 - HR</p>
<p>hsync_len = SH2 - SH1</p>
</li>
<li><p class="first">vertical timings:</p>
<p>upper_margin = VFL - SV2</p>
<p>lower_margin = SV1 - VR</p>
<p>vsync_len = SV2 - SV1</p>
</li>
</ol>
<p>Good examples for VESA timings can be found in the XFree86 source tree,
under “xc/programs/Xserver/hw/xfree86/doc/modeDB.txt”.</p>
</div>
<div class="section" id="references">
<h2>7. References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>For more specific information about the frame buffer device and its
applications, please refer to the Linux-fbdev website:</p>
<blockquote>
<div><a class="reference external" href="http://linux-fbdev.sourceforge.net/">http://linux-fbdev.sourceforge.net/</a></div></blockquote>
<p>and to the following documentation:</p>
<blockquote>
<div><ul>
<li><p class="first">The manual pages for fbset: fbset(8), fb.modes(5)</p>
</li>
<li><p class="first">The manual pages for XFree86: XF68_FBDev(1), XF86Config(4/5)</p>
</li>
<li><p class="first">The mighty kernel sources:</p>
<blockquote>
<div><ul class="simple">
<li>linux/drivers/video/</li>
<li>linux/include/linux/fb.h</li>
<li>linux/include/video/</li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="mailing-list">
<h2>8. Mailing list<a class="headerlink" href="#mailing-list" title="Permalink to this headline">¶</a></h2>
<p>There is a frame buffer device related mailing list at kernel.org:
<a class="reference external" href="mailto:linux-fbdev&#37;&#52;&#48;vger&#46;kernel&#46;org">linux-fbdev<span>&#64;</span>vger<span>&#46;</span>kernel<span>&#46;</span>org</a>.</p>
<p>Point your web browser to <a class="reference external" href="http://sourceforge.net/projects/linux-fbdev/">http://sourceforge.net/projects/linux-fbdev/</a> for
subscription information and archive browsing.</p>
</div>
<div class="section" id="downloading">
<h2>9. Downloading<a class="headerlink" href="#downloading" title="Permalink to this headline">¶</a></h2>
<p>All necessary files can be found at</p>
<blockquote>
<div><a class="reference external" href="ftp://ftp.uni-erlangen.de/pub/Linux/LOCAL/680x0/">ftp://ftp.uni-erlangen.de/pub/Linux/LOCAL/680x0/</a></div></blockquote>
<p>and on its mirrors.</p>
<p>The latest version of fbset can be found at</p>
<blockquote>
<div><a class="reference external" href="http://www.linux-fbdev.org/">http://www.linux-fbdev.org/</a></div></blockquote>
</div>
<div class="section" id="credits">
<h2>10. Credits<a class="headerlink" href="#credits" title="Permalink to this headline">¶</a></h2>
<p>This readme was written by Geert Uytterhoeven, partly based on the original
<cite>X-framebuffer.README</cite> by Roman Hodek and Martin Schaller. Section 6 was
provided by Frank Neumann.</p>
<p>The frame buffer device abstraction was designed by Martin Schaller.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="gxfb.html" class="btn btn-neutral float-right" title="What is gxfb?" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="fbcon.html" class="btn btn-neutral float-left" title="The Framebuffer Console" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>