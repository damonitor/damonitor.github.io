

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>5. 发送补丁 &mdash; The Linux Kernel  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../../',
              VERSION:'',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="6. 跟进" href="6.Followthrough.html" />
    <link rel="prev" title="4. 使代码正确" href="4.Coding.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.6.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../admin-guide/index.html">The Linux kernel user’s and administrator’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../kbuild/index.html">Kernel Build System</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../firmware-guide/index.html">The Linux kernel firmware guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../userspace-api/index.html">The Linux kernel user-space API guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../process/index.html">Working with the kernel development community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev-tools/index.html">Development tools for the kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../doc-guide/index.html">How to write kernel documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../kernel-hacking/index.html">Kernel Hacking Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../trace/index.html">Linux Tracing Technologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../maintainer/index.html">Kernel Maintainer Handbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fault-injection/index.html">fault-injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../livepatch/index.html">Kernel Livepatching</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../driver-api/index.html">The Linux driver implementer’s API guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../core-api/index.html">Core API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../locking/index.html">locking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../accounting/index.html">Accounting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../block/index.html">Block</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cdrom/index.html">cdrom</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ide/index.html">Integrated Drive Electronics (IDE)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fb/index.html">Frame Buffer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fpga/index.html">fpga</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../hid/index.html">Human Interface Devices (HID)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../i2c/index.html">I2C/SMBus Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../iio/index.html">Industrial I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../isdn/index.html">ISDN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../infiniband/index.html">InfiniBand</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../leds/index.html">LEDs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../media/index.html">Linux Media Subsystem Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../netlabel/index.html">NetLabel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../networking/index.html">Linux Networking Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pcmcia/index.html">pcmcia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../power/index.html">Power Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../target/index.html">TCM Virtual Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../timers/index.html">timers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../spi/index.html">Serial Peripheral Interface (SPI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../w1/index.html">1-Wire Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../watchdog/index.html">Linux Watchdog Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../virt/index.html">Linux Virtualization Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../input/index.html">The Linux Input Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../hwmon/index.html">Linux Hardware Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gpu/index.html">Linux GPU Driver Developer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../security/index.html">Security Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sound/index.html">Linux Sound Subsystem Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../crypto/index.html">Linux Kernel Crypto API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../filesystems/index.html">Filesystems in the Linux kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../vm/index.html">Linux Memory Management Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../bpf/index.html">BPF Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usb/index.html">USB support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../PCI/index.html">Linux PCI Bus Subsystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../misc-devices/index.html">Assorted Miscellaneous Devices Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mic/index.html">Intel Many Integrated Core (MIC) architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scheduler/index.html">Linux Scheduler</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../asm-annotations.html">Assembler Annotations</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../arm/index.html">ARM Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../arm64/index.html">ARM64 Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ia64/index.html">IA-64 Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../m68k/index.html">m68k Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mips/index.html">MIPS-specific Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nios2/nios2.html">Linux on the Nios II architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../openrisc/index.html">OpenRISC Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../parisc/index.html">PA-RISC Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../powerpc/index.html">powerpc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../riscv/index.html">RISC-V architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../s390/index.html">s390 Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sh/index.html">SuperH Interfaces Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sparc/index.html">Sparc Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../x86/index.html">x86-specific Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../xtensa/index.html">Xtensa Architecture</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../filesystems/ext4/index.html">ext4 Data Structures and Algorithms</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Translations</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">中文翻译</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="index.html">与Linux 内核社区一起工作</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="howto.html">如何参与Linux内核开发</a></li>
<li class="toctree-l4"><a class="reference internal" href="code-of-conduct.html">贡献者契约行为准则</a></li>
<li class="toctree-l4"><a class="reference internal" href="code-of-conduct-interpretation.html">Linux内核贡献者契约行为准则解释</a></li>
<li class="toctree-l4"><a class="reference internal" href="submitting-patches.html">如何让你的改动进入内核</a></li>
<li class="toctree-l4"><a class="reference internal" href="programming-language.html">程序设计语言</a></li>
<li class="toctree-l4"><a class="reference internal" href="coding-style.html">Linux 内核代码风格</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="development-process.html">内核开发过程指南</a></li>
<li class="toctree-l4"><a class="reference internal" href="email-clients.html">Linux邮件客户端配置信息</a></li>
<li class="toctree-l4"><a class="reference internal" href="license-rules.html">Linux内核许可规则</a></li>
<li class="toctree-l4"><a class="reference internal" href="kernel-enforcement-statement.html">Linux 内核执行声明</a></li>
<li class="toctree-l4"><a class="reference internal" href="kernel-driver-statement.html">内核驱动声明</a></li>
<li class="toctree-l4"><a class="reference internal" href="submitting-drivers.html">如何向 Linux 内核提交驱动程序</a></li>
<li class="toctree-l4"><a class="reference internal" href="submit-checklist.html">Linux内核补丁提交清单</a></li>
<li class="toctree-l4"><a class="reference internal" href="stable-api-nonsense.html">Linux 内核驱动接口</a></li>
<li class="toctree-l4"><a class="reference internal" href="stable-kernel-rules.html">所有你想知道的事情 - 关于linux稳定版发布</a></li>
<li class="toctree-l4"><a class="reference internal" href="management-style.html">Linux内核管理风格</a></li>
<li class="toctree-l4"><a class="reference internal" href="embargoed-hardware-issues.html">被限制的硬件问题</a></li>
<li class="toctree-l4"><a class="reference internal" href="magic-number.html">Linux 魔术数</a></li>
<li class="toctree-l4"><a class="reference internal" href="volatile-considered-harmful.html">为什么不应该使用“volatile”类型</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#id2">目录和表格</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../it_IT/index.html">Traduzione italiana</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ko_KR/index.html">한국어 번역</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ja_JP/index.html">Japanese translations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#disclaimer">Disclaimer</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Translations</a> &raquo;</li>
        
          <li><a href="../index.html">中文翻译</a> &raquo;</li>
        
          <li><a href="index.html">与Linux 内核社区一起工作</a> &raquo;</li>
        
          <li><a href="development-process.html">内核开发过程指南</a> &raquo;</li>
        
      <li>5. 发送补丁</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/translations/zh_CN/process/5.Posting.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">此文件的目的是为让中文读者更容易阅读和理解，而不是作为一个分支。 因此，
如果您对此文件有任何意见或更新，请先尝试更新原始英文文件。</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">如果您发现本文档与原始文件有任何不同或者有翻译问题，请联系该文件的译者，
或者请求时奎亮的帮助：&lt;<a class="reference external" href="mailto:alex&#46;shi&#37;&#52;&#48;linux&#46;alibaba&#46;com">alex<span>&#46;</span>shi<span>&#64;</span>linux<span>&#46;</span>alibaba<span>&#46;</span>com</a>&gt;。</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Original:</th><td class="field-body"><a class="reference internal" href="../../../process/5.Posting.html#development-posting"><span class="std std-ref">Documentation/process/5.Posting.rst</span></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Translator:</th><td class="field-body">Alex Shi &lt;<a class="reference external" href="mailto:alex&#46;shi&#37;&#52;&#48;linux&#46;alibaba&#46;com">alex<span>&#46;</span>shi<span>&#64;</span>linux<span>&#46;</span>alibaba<span>&#46;</span>com</a>&gt;</td>
</tr>
</tbody>
</table>
<div class="section" id="cn-development-posting">
<span id="id1"></span><h1>5. 发送补丁<a class="headerlink" href="#cn-development-posting" title="Permalink to this headline">¶</a></h1>
<p>迟早，当您的工作准备好提交给社区进行审查，并最终包含到主线内核中时。不出所料，
内核开发社区已经发展出一套用于发布补丁的约定和过程；遵循这些约定和过程将使
参与其中的每个人的生活更加轻松。本文件将试图合理详细地涵盖这些期望；更多信息
也可在以下文件中找到
<a class="reference internal" href="submitting-patches.html#cn-submittingpatches"><span class="std std-ref">Documentation/translations/zh_CN/process/submitting-patches.rst</span></a>,
<a class="reference internal" href="../../../process/submitting-drivers.html#submittingdrivers"><span class="std std-ref">Documentation/process/submitting-drivers.rst</span></a>
和 <a class="reference internal" href="submit-checklist.html#cn-submitchecklist"><span class="std std-ref">Documentation/translations/zh_CN/process/submit-checklist.rst</span></a>.</p>
<div class="section" id="id2">
<h2>5.1. 何时邮寄<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>在补丁完全“准备好”之前，有一个不断的诱惑来避免发布补丁。对于简单的补丁，
这不是问题。但是，如果正在完成的工作很复杂，那么在工作完成之前从社区获得
反馈就可以获得很多好处。因此，您应该考虑发布正在进行的工作，甚至使Git树
可用，以便感兴趣的开发人员可以随时赶上您的工作。</p>
<p>当发布还没有准备好包含的代码时，最好在发布本身中这样说。还应提及任何有待完成
的主要工作和任何已知问题。很少有人会看到那些被认为是半生不熟的补丁，但是那些
人会想到他们可以帮助你把工作推向正确的方向。</p>
</div>
<div class="section" id="id3">
<h2>5.2. 创建补丁之前<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>在考虑将补丁发送到开发社区之前，有许多事情应该做。这些包括：</p>
<blockquote>
<div><ul class="simple">
<li>尽可能地测试代码。利用内核的调试工具，确保内核使用所有合理的配置选项组合
进行构建，使用跨编译器为不同的体系结构进行构建等。</li>
<li>确保您的代码符合内核编码风格指南。</li>
<li>您的更改是否具有性能影响？如果是这样，您应该运行基准测试来显示您的变更的
影响（或好处）；结果的摘要应该包含在补丁中。</li>
<li>确保您有权发布代码。如果这项工作是为雇主完成的，雇主对这项工作具有所有权，
并且必须同意根据GPL对其进行放行。</li>
</ul>
</div></blockquote>
<p>一般来说，在发布代码之前进行一些额外的思考，几乎总是能在短时间内得到回报。</p>
</div>
<div class="section" id="id4">
<h2>5.3. 补丁准备<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>准备发布补丁可能是一个惊人的工作量，但再次尝试节省时间在这里通常是不明智的，
即使在短期内。</p>
<p>必须针对内核的特定版本准备补丁。作为一般规则，补丁程序应该基于Linus的Git树中
的当前主线。当以主线为基础时，从一个众所周知的发布点开始——一个稳定的或RC的
发布——而不是在一个主线分支任意点。</p>
<p>但是，可能需要针对-mm、linux-next或子系统树生成版本，以便于更广泛的测试和审查。
根据补丁的区域以及其他地方的情况，针对这些其他树建立补丁可能需要大量的工作来
解决冲突和处理API更改。</p>
<p>只有最简单的更改才应格式化为单个补丁；其他所有更改都应作为一系列逻辑更改进行。
分割补丁是一门艺术；一些开发人员花了很长时间来弄清楚如何按照社区期望的方式来
做。然而，有一些经验法则可以大大帮助：</p>
<blockquote>
<div><ul class="simple">
<li>您发布的补丁程序系列几乎肯定不会是工作系统中的一系列更改。相反，您所做的
更改需要在最终形式中加以考虑，然后以有意义的方式进行拆分。开发人员对离散的、
自包含的更改感兴趣，而不是您获取这些更改的路径。</li>
<li>每个逻辑上独立的变更都应该格式化为单独的补丁。这些更改可以是小的（“向此
结构添加字段”）或大的（例如，添加一个重要的新驱动程序），但它们在概念上
应该是小的，并且可以接受一行描述。每个补丁都应该做一个特定的更改，可以单独
检查并验证它所做的事情。</li>
<li>作为重申上述准则的一种方法：不要在同一补丁中混合不同类型的更改。如果一个
补丁修复了一个关键的安全漏洞，重新排列了一些结构，并重新格式化了代码，那么
很有可能它会被忽略，而重要的修复将丢失。</li>
<li>每个补丁都应该产生一个内核，它可以正确地构建和运行；如果补丁系列在中间被
中断，那么结果应该仍然是一个工作的内核。补丁系列的部分应用是使用
“git bisct”工具查找回归的一个常见场景；如果结果是一个损坏的内核，那么对于
那些从事追踪问题的高尚工作的开发人员和用户来说，将使他们的生活更加艰难。</li>
<li>不过，不要过分。一位开发人员曾经将一组编辑内容作为500个单独的补丁发布到一个
文件中，这并没有使他成为内核邮件列表中最受欢迎的人。一个补丁可以相当大，
只要它仍然包含一个单一的逻辑变更。</li>
<li>用一系列补丁添加一个全新的基础设施是很有诱惑力的，但是在系列中的最后一个
补丁启用整个补丁之前，该基础设施是不使用的。如果可能的话，应该避免这种
诱惑；如果这个系列增加了回归，那么二分法将指出最后一个补丁是导致问题的
补丁，即使真正的bug在其他地方。只要有可能，添加新代码的补丁程序应该立即
激活该代码。</li>
</ul>
</div></blockquote>
<p>创建完美补丁系列的工作可能是一个令人沮丧的过程，在完成“真正的工作”之后需要花费
大量的时间和思考。但是，如果做得好，这是一段很好的时间。</p>
</div>
<div class="section" id="id5">
<h2>5.4. 补丁格式和更改日志<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>所以现在你有了一系列完美的补丁可以发布，但是这项工作还没有完成。每个补丁都
需要被格式化成一条消息，它可以快速而清晰地将其目的传达给世界其他地方。为此，
每个补丁将由以下部分组成：</p>
<blockquote>
<div><ul>
<li><p class="first">命名补丁作者的可选“from”行。只有当你通过电子邮件传递别人的补丁时，这一行
才是必要的，但是如果有疑问，添加它不会有任何伤害。</p>
</li>
<li><p class="first">一行描述补丁的作用。对于没有其他上下文的读者来说，此消息应该足够了解补丁
的范围；这是将在“短格式”变更日志中显示的行。此消息通常首先用相关的子系统
名称格式化，然后是补丁的目的。例如：</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>gpio: fix build on CONFIG_GPIO_SYSFS=n
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">一个空白行，后面是补丁内容的详细描述。这个描述可以是必需的；它应该说明补丁
的作用以及为什么它应该应用于内核。</p>
</li>
<li><p class="first">一个或多个标记行，至少有一个由补丁作者的：signed-off-by 签名。签名将在下面
更详细地描述。</p>
</li>
</ul>
</div></blockquote>
<p>上面的项目一起构成补丁的变更日志。写一篇好的变更日志是一门至关重要但常常被
忽视的艺术；值得花一点时间来讨论这个问题。当你写一个变更日志时，你应该记住
有很多不同的人会读你的话。其中包括子系统维护人员和审查人员，他们需要决定是否
应该包括补丁，分销商和其他维护人员试图决定是否应该将补丁反向移植到其他内核，
bug搜寻人员想知道补丁是否负责他们正在追查的问题，想知道内核如何变化的用户。
等等。一个好的变更日志以最直接和最简洁的方式向所有这些人传达所需的信息。</p>
<p>为此，总结行应该描述变更的影响和动机，以及在一行约束条件下可能发生的变化。
然后，详细的描述可以详述这些主题，并提供任何需要的附加信息。如果补丁修复了
一个bug，请引用引入该bug的commit（如果可能，请在引用commits时同时提供commit id
和标题）。如果某个问题与特定的日志或编译器输出相关联，请包含该输出以帮助其他
人搜索同一问题的解决方案。如果更改是为了支持以后补丁中的其他更改，那么就这么
说。如果更改了内部API，请详细说明这些更改以及其他开发人员应该如何响应。一般
来说，你越能把自己放在每个阅读你的changelog的人的位置上，changelog（和内核
作为一个整体）就越好。</p>
<p>不用说，变更日志应该是将变更提交到修订控制系统时使用的文本。接下来是：</p>
<blockquote>
<div><ul class="simple">
<li>补丁本身，采用统一的（“-u”）补丁格式。将“-p”选项用于diff将使函数名与更改
相关联，从而使结果补丁更容易被其他人读取。</li>
</ul>
</div></blockquote>
<p>您应该避免在补丁中包括对不相关文件（例如，由构建过程生成的文件或编辑器
备份文件）的更改。文档目录中的文件“dontdiff”在这方面有帮助；使用“-X”选项将
其传递给diff。</p>
<p>上面提到的标签用于描述各种开发人员如何与这个补丁的开发相关联。
<a class="reference internal" href="submitting-patches.html#cn-submittingpatches"><span class="std std-ref">Documentation/translations/zh_CN/process/submitting-patches.rst</span></a>
文档中对它们进行了详细描述；下面是一个简短的总结。每一行的格式如下：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>tag: Full Name &lt;email address&gt;  optional-other-stuff
</pre></div>
</div>
<p>常用的标签有：</p>
<blockquote>
<div><ul class="simple">
<li>Signed-off-by: 这是一个开发人员的证明，他或她有权提交补丁以包含到内核中。
这是开发来源认证协议，其全文可在
<a class="reference internal" href="submitting-patches.html#cn-submittingpatches"><span class="std std-ref">Documentation/translations/zh_CN/process/submitting-patches.rst</span></a>
中找到，如果没有适当的签字，则不能合并到主线中。</li>
<li>Co-developed-by: 声明补丁是由多个开发人员共同创建的；当几个人在一个补丁上
工作时，它用于将属性赋予共同作者（除了 From: 所赋予的作者之外）。因为
Co-developed-by: 表示作者身份，所以每个共同开发人, 必须紧跟在相关合作作者
的签名之后。具体内容和示例可以在以下文件中找到
<a class="reference internal" href="submitting-patches.html#cn-submittingpatches"><span class="std std-ref">Documentation/translations/zh_CN/process/submitting-patches.rst</span></a></li>
<li>Acked-by: 表示另一个开发人员（通常是相关代码的维护人员）同意补丁适合包含
在内核中。</li>
<li>Tested-by: 声明指定的人已经测试了补丁并发现它可以工作。</li>
<li>Reviewed-by: 指定的开发人员已经审查了补丁的正确性；有关详细信息，请参阅
<a class="reference internal" href="submitting-patches.html#cn-submittingpatches"><span class="std std-ref">Documentation/translations/zh_CN/process/submitting-patches.rst</span></a></li>
<li>Reported-by: 指定报告此补丁修复的问题的用户；此标记用于提供感谢。</li>
<li>Cc：指定的人收到了补丁的副本，并有机会对此发表评论。</li>
</ul>
</div></blockquote>
<p>在补丁中添加标签时要小心：只有cc:才适合在没有指定人员明确许可的情况下添加。</p>
</div>
<div class="section" id="id6">
<h2>5.5. 发送补丁<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<p>在邮寄补丁之前，您还需要注意以下几点：</p>
<blockquote>
<div><ul>
<li><p class="first">您确定您的邮件发送程序不会损坏补丁吗？有免费的空白更改或由邮件客户端
执行的行包装的补丁不会在另一端复原，并且通常不会进行任何详细检查。如果有
任何疑问，把补丁寄给你自己，让你自己相信它是完好无损的。</p>
<p><a class="reference internal" href="email-clients.html#cn-email-clients"><span class="std std-ref">Documentation/translations/zh_CN/process/email-clients.rst</span></a>
提供了一些有用的提示，可以让特定的邮件客户机工作以发送补丁。</p>
</li>
<li><p class="first">你确定你的补丁没有愚蠢的错误吗？您应该始终通过scripts/checkpatch.pl运行
补丁程序，并解决它提出的投诉。请记住，checkpatch.pl虽然是大量思考内核
补丁应该是什么样子的体现，但它并不比您聪明。如果修复checkpatch.pl投诉会
使代码变得更糟，请不要这样做。</p>
</li>
</ul>
</div></blockquote>
<p>补丁应始终以纯文本形式发送。请不要将它们作为附件发送；这使得审阅者在答复中更难
引用补丁的部分。相反，只需将补丁直接放到您的消息中。</p>
<p>邮寄补丁时，重要的是将副本发送给任何可能感兴趣的人。与其他一些项目不同，内核
鼓励人们错误地发送过多的副本；不要假定相关人员会看到您在邮件列表中的发布。
尤其是，副本应发送至：</p>
<blockquote>
<div><ul class="simple">
<li>受影响子系统的维护人员。如前所述，维护人员文件是查找这些人员的第一个地方。</li>
<li>其他在同一领域工作的开发人员，尤其是那些现在可能在那里工作的开发人员。使用
git查看还有谁修改了您正在处理的文件，这很有帮助。</li>
<li>如果您对错误报告或功能请求做出响应，也可以抄送原始发送人。</li>
<li>将副本发送到相关邮件列表，或者，如果没有其他应用，则发送到Linux内核列表。</li>
<li>如果您正在修复一个bug，请考虑该修复是否应进入下一个稳定更新。如果是这样，
<a class="reference external" href="mailto:stable&#37;&#52;&#48;vger&#46;kernel&#46;org">stable<span>&#64;</span>vger<span>&#46;</span>kernel<span>&#46;</span>org</a> 应该得到补丁的副本。另外，在补丁本身的标签中添加
一个“cc:stable&#64;vger.kernel.org”；这将使稳定团队在修复进入主线时收到通知。</li>
</ul>
</div></blockquote>
<p>当为一个补丁选择接收者时，最好知道你认为谁最终会接受这个补丁并将其合并。虽然
可以将补丁直接发送给LinusTorvalds并让他合并，但通常情况下不会这样做。Linus
很忙，并且有子系统维护人员负责监视内核的特定部分。通常您会希望维护人员合并您
的补丁。如果没有明显的维护人员，Andrew Morton通常是最后的补丁目标。</p>
<p>补丁需要好的主题行。补丁程序行的规范格式如下：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[PATCH nn/mm] subsys: one-line description of the patch
</pre></div>
</div>
<p>其中“nn”是补丁的序号，“mm”是系列中补丁的总数，“subsys”是受影响子系统的名称。
显然，一个单独的补丁可以省略nn/mm。</p>
<p>如果您有一系列重要的补丁，那么通常将介绍性描述作为零部分发送。不过，这种约定
并没有得到普遍遵循；如果您使用它，请记住简介中的信息不会使它进入内核变更日志。
因此，请确保补丁本身具有完整的变更日志信息。</p>
<p>一般来说，多部分补丁的第二部分和后续部分应作为对第一部分的回复发送，以便它们
在接收端都连接在一起。像git和coilt这样的工具有命令，可以通过适当的线程发送
一组补丁。但是，如果您有一个长系列，并且正在使用git，请远离–chain reply-to
选项，以避免创建异常深的嵌套。</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="6.Followthrough.html" class="btn btn-neutral float-right" title="6. 跟进" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="4.Coding.html" class="btn btn-neutral float-left" title="4. 使代码正确" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>