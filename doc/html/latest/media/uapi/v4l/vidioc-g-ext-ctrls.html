

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>7.29. ioctl VIDIOC_G_EXT_CTRLS, VIDIOC_S_EXT_CTRLS, VIDIOC_TRY_EXT_CTRLS &mdash; The Linux Kernel  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../../',
              VERSION:'',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.7.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../admin-guide/mm/damon/index.html">DAMON: Data Access MONitor</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
      <li>7.29. ioctl VIDIOC_G_EXT_CTRLS, VIDIOC_S_EXT_CTRLS, VIDIOC_TRY_EXT_CTRLS</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/media/uapi/v4l/vidioc-g-ext-ctrls.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="ioctl-vidioc-g-ext-ctrls-vidioc-s-ext-ctrls-vidioc-try-ext-ctrls">
<span id="vidioc-g-ext-ctrls"></span><h1>7.29. ioctl VIDIOC_G_EXT_CTRLS, VIDIOC_S_EXT_CTRLS, VIDIOC_TRY_EXT_CTRLS<a class="headerlink" href="#ioctl-vidioc-g-ext-ctrls-vidioc-s-ext-ctrls-vidioc-try-ext-ctrls" title="Permalink to this headline">¶</a></h1>
<div class="section" id="name">
<h2>7.29.1. Name<a class="headerlink" href="#name" title="Permalink to this headline">¶</a></h2>
<p>VIDIOC_G_EXT_CTRLS - VIDIOC_S_EXT_CTRLS - VIDIOC_TRY_EXT_CTRLS - Get or set the value of several controls, try control values</p>
</div>
<div class="section" id="synopsis">
<h2>7.29.2. Synopsis<a class="headerlink" href="#synopsis" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="c.VIDIOC_G_EXT_CTRLS">
int <code class="descname">ioctl</code><span class="sig-paren">(</span>int<em>&nbsp;fd</em>, <a class="reference internal" href="#c.VIDIOC_G_EXT_CTRLS" title="VIDIOC_G_EXT_CTRLS">VIDIOC_G_EXT_CTRLS</a>, struct <a class="reference internal" href="#c.v4l2_ext_controls" title="v4l2_ext_controls">v4l2_ext_controls</a><em>&nbsp;*argp</em><span class="sig-paren">)</span><a class="headerlink" href="#c.VIDIOC_G_EXT_CTRLS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="c.VIDIOC_S_EXT_CTRLS">
int <code class="descname">ioctl</code><span class="sig-paren">(</span>int<em>&nbsp;fd</em>, <a class="reference internal" href="#c.VIDIOC_S_EXT_CTRLS" title="VIDIOC_S_EXT_CTRLS">VIDIOC_S_EXT_CTRLS</a>, struct <a class="reference internal" href="#c.v4l2_ext_controls" title="v4l2_ext_controls">v4l2_ext_controls</a><em>&nbsp;*argp</em><span class="sig-paren">)</span><a class="headerlink" href="#c.VIDIOC_S_EXT_CTRLS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="c.VIDIOC_TRY_EXT_CTRLS">
int <code class="descname">ioctl</code><span class="sig-paren">(</span>int<em>&nbsp;fd</em>, <a class="reference internal" href="#c.VIDIOC_TRY_EXT_CTRLS" title="VIDIOC_TRY_EXT_CTRLS">VIDIOC_TRY_EXT_CTRLS</a>, struct <a class="reference internal" href="#c.v4l2_ext_controls" title="v4l2_ext_controls">v4l2_ext_controls</a><em>&nbsp;*argp</em><span class="sig-paren">)</span><a class="headerlink" href="#c.VIDIOC_TRY_EXT_CTRLS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="arguments">
<h2>7.29.3. Arguments<a class="headerlink" href="#arguments" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">fd</span></code></dt>
<dd>File descriptor returned by <a class="reference internal" href="func-open.html#func-open"><span class="std std-ref">open()</span></a>.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">argp</span></code></dt>
<dd>Pointer to struct <a class="reference internal" href="#c.v4l2_ext_controls" title="v4l2_ext_controls"><code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_ext_controls</span></code></a>.</dd>
</dl>
</div>
<div class="section" id="description">
<h2>7.29.4. Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>These ioctls allow the caller to get or set multiple controls
atomically. Control IDs are grouped into control classes (see
<a class="reference internal" href="#ctrl-class"><span class="std std-ref">Control classes</span></a>) and all controls in the control array must belong
to the same control class.</p>
<p>Applications must always fill in the <code class="docutils literal notranslate"><span class="pre">count</span></code>, <code class="docutils literal notranslate"><span class="pre">which</span></code>, <code class="docutils literal notranslate"><span class="pre">controls</span></code>
and <code class="docutils literal notranslate"><span class="pre">reserved</span></code> fields of struct
<a class="reference internal" href="#c.v4l2_ext_controls" title="v4l2_ext_controls"><code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_ext_controls</span></code></a>, and initialize the
struct <a class="reference internal" href="#c.v4l2_ext_control" title="v4l2_ext_control"><code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_ext_control</span></code></a> array pointed to
by the <code class="docutils literal notranslate"><span class="pre">controls</span></code> fields.</p>
<p>To get the current value of a set of controls applications initialize
the <code class="docutils literal notranslate"><span class="pre">id</span></code>, <code class="docutils literal notranslate"><span class="pre">size</span></code> and <code class="docutils literal notranslate"><span class="pre">reserved2</span></code> fields of each struct
<a class="reference internal" href="#c.v4l2_ext_control" title="v4l2_ext_control"><code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_ext_control</span></code></a> and call the
<a class="reference internal" href="#vidioc-g-ext-ctrls"><span class="std std-ref">VIDIOC_G_EXT_CTRLS</span></a> ioctl. String controls controls must also set the
<code class="docutils literal notranslate"><span class="pre">string</span></code> field. Controls of compound types
(<code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_FLAG_HAS_PAYLOAD</span></code> is set) must set the <code class="docutils literal notranslate"><span class="pre">ptr</span></code> field.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">size</span></code> is too small to receive the control result (only
relevant for pointer-type controls like strings), then the driver will
set <code class="docutils literal notranslate"><span class="pre">size</span></code> to a valid value and return an <code class="docutils literal notranslate"><span class="pre">ENOSPC</span></code> error code. You
should re-allocate the memory to this new size and try again. For the
string type it is possible that the same issue occurs again if the
string has grown in the meantime. It is recommended to call
<a class="reference internal" href="vidioc-queryctrl.html#vidioc-queryctrl"><span class="std std-ref">ioctls VIDIOC_QUERYCTRL, VIDIOC_QUERY_EXT_CTRL and VIDIOC_QUERYMENU</span></a> first and use
<code class="docutils literal notranslate"><span class="pre">maximum</span></code>+1 as the new <code class="docutils literal notranslate"><span class="pre">size</span></code> value. It is guaranteed that that is
sufficient memory.</p>
<p>N-dimensional arrays are set and retrieved row-by-row. You cannot set a
partial array, all elements have to be set or retrieved. The total size
is calculated as <code class="docutils literal notranslate"><span class="pre">elems</span></code> * <code class="docutils literal notranslate"><span class="pre">elem_size</span></code>. These values can be obtained
by calling <a class="reference internal" href="vidioc-queryctrl.html#vidioc-queryctrl"><span class="std std-ref">VIDIOC_QUERY_EXT_CTRL</span></a>.</p>
<p>To change the value of a set of controls applications initialize the
<code class="docutils literal notranslate"><span class="pre">id</span></code>, <code class="docutils literal notranslate"><span class="pre">size</span></code>, <code class="docutils literal notranslate"><span class="pre">reserved2</span></code> and <code class="docutils literal notranslate"><span class="pre">value/value64/string/ptr</span></code> fields
of each struct <a class="reference internal" href="#c.v4l2_ext_control" title="v4l2_ext_control"><code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_ext_control</span></code></a> and call
the <a class="reference internal" href="#vidioc-g-ext-ctrls"><span class="std std-ref">VIDIOC_S_EXT_CTRLS</span></a> ioctl. The controls will only be set if <em>all</em>
control values are valid.</p>
<p>To check if a set of controls have correct values applications
initialize the <code class="docutils literal notranslate"><span class="pre">id</span></code>, <code class="docutils literal notranslate"><span class="pre">size</span></code>, <code class="docutils literal notranslate"><span class="pre">reserved2</span></code> and
<code class="docutils literal notranslate"><span class="pre">value/value64/string/ptr</span></code> fields of each struct
<a class="reference internal" href="#c.v4l2_ext_control" title="v4l2_ext_control"><code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_ext_control</span></code></a> and call the
<a class="reference internal" href="#vidioc-g-ext-ctrls"><span class="std std-ref">VIDIOC_TRY_EXT_CTRLS</span></a> ioctl. It is up to the driver whether wrong
values are automatically adjusted to a valid value or if an error is
returned.</p>
<p>When the <code class="docutils literal notranslate"><span class="pre">id</span></code> or <code class="docutils literal notranslate"><span class="pre">which</span></code> is invalid drivers return an <code class="docutils literal notranslate"><span class="pre">EINVAL</span></code> error
code. When the value is out of bounds drivers can choose to take the
closest valid value or return an <code class="docutils literal notranslate"><span class="pre">ERANGE</span></code> error code, whatever seems more
appropriate. In the first case the new value is set in struct
<a class="reference internal" href="#c.v4l2_ext_control" title="v4l2_ext_control"><code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_ext_control</span></code></a>. If the new control value
is inappropriate (e.g. the given menu index is not supported by the menu
control), then this will also result in an <code class="docutils literal notranslate"><span class="pre">EINVAL</span></code> error code error.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">request_fd</span></code> is set to a not-yet-queued <a class="reference internal" href="../mediactl/request-api.html#media-request-api"><span class="std std-ref">request</span></a>
file descriptor and <code class="docutils literal notranslate"><span class="pre">which</span></code> is set to <code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_WHICH_REQUEST_VAL</span></code>,
then the controls are not applied immediately when calling
<a class="reference internal" href="#vidioc-g-ext-ctrls"><span class="std std-ref">VIDIOC_S_EXT_CTRLS</span></a>, but instead are applied by
the driver for the buffer associated with the same request.
If the device does not support requests, then <code class="docutils literal notranslate"><span class="pre">EACCES</span></code> will be returned.
If requests are supported but an invalid request file descriptor is given,
then <code class="docutils literal notranslate"><span class="pre">EINVAL</span></code> will be returned.</p>
<p>An attempt to call <a class="reference internal" href="#vidioc-g-ext-ctrls"><span class="std std-ref">VIDIOC_S_EXT_CTRLS</span></a> for a
request that has already been queued will result in an <code class="docutils literal notranslate"><span class="pre">EBUSY</span></code> error.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">request_fd</span></code> is specified and <code class="docutils literal notranslate"><span class="pre">which</span></code> is set to
<code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_WHICH_REQUEST_VAL</span></code> during a call to
<a class="reference internal" href="#vidioc-g-ext-ctrls"><span class="std std-ref">VIDIOC_G_EXT_CTRLS</span></a>, then it will return the
values of the controls at the time of request completion.
If the request is not yet completed, then this will result in an
<code class="docutils literal notranslate"><span class="pre">EACCES</span></code> error.</p>
<p>The driver will only set/get these controls if all control values are
correct. This prevents the situation where only some of the controls
were set/get. Only low-level errors (e. g. a failed i2c command) can
still cause this situation.</p>
<dl class="type">
<dt id="c.v4l2_ext_control">
<code class="descname">v4l2_ext_control</code><a class="headerlink" href="#c.v4l2_ext_control" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<table border="1" class="docutils" id="id1">
<caption><span class="caption-text">struct v4l2_ext_control</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>__u32</td>
<td><code class="docutils literal notranslate"><span class="pre">id</span></code></td>
<td>Identifies the control, set by the application.</td>
</tr>
<tr class="row-even"><td>__u32</td>
<td><code class="docutils literal notranslate"><span class="pre">size</span></code></td>
<td><p class="first">The total size in bytes of the payload of this control. This is
normally 0, but for pointer controls this should be set to the
size of the memory containing the payload, or that will receive
the payload. If <a class="reference internal" href="#vidioc-g-ext-ctrls"><span class="std std-ref">VIDIOC_G_EXT_CTRLS</span></a> finds that this value is
less than is required to store the payload result, then it is set
to a value large enough to store the payload result and <code class="docutils literal notranslate"><span class="pre">ENOSPC</span></code> is
returned.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For string controls, this <code class="docutils literal notranslate"><span class="pre">size</span></code> field should
not be confused with the length of the string. This field refers
to the size of the memory that contains the string. The actual
<em>length</em> of the string may well be much smaller.</p>
</div>
</td>
</tr>
<tr class="row-odd"><td>__u32</td>
<td><code class="docutils literal notranslate"><span class="pre">reserved2</span></code>[1]</td>
<td>Reserved for future extensions. Drivers and applications must set
the array to zero.</td>
</tr>
<tr class="row-even"><td>union {</td>
<td colspan="2">(anonymous)</td>
</tr>
<tr class="row-odd"><td>__s32</td>
<td><code class="docutils literal notranslate"><span class="pre">value</span></code></td>
<td>New value or current value. Valid if this control is not of type
<code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_TYPE_INTEGER64</span></code> and <code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_FLAG_HAS_PAYLOAD</span></code> is
not set.</td>
</tr>
<tr class="row-even"><td>__s64</td>
<td><code class="docutils literal notranslate"><span class="pre">value64</span></code></td>
<td>New value or current value. Valid if this control is of type
<code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_TYPE_INTEGER64</span></code> and <code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_FLAG_HAS_PAYLOAD</span></code> is
not set.</td>
</tr>
<tr class="row-odd"><td>char *</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td>A pointer to a string. Valid if this control is of type
<code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_TYPE_STRING</span></code>.</td>
</tr>
<tr class="row-even"><td>__u8 *</td>
<td><code class="docutils literal notranslate"><span class="pre">p_u8</span></code></td>
<td>A pointer to a matrix control of unsigned 8-bit values. Valid if
this control is of type <code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_TYPE_U8</span></code>.</td>
</tr>
<tr class="row-odd"><td>__u16 *</td>
<td><code class="docutils literal notranslate"><span class="pre">p_u16</span></code></td>
<td>A pointer to a matrix control of unsigned 16-bit values. Valid if
this control is of type <code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_TYPE_U16</span></code>.</td>
</tr>
<tr class="row-even"><td>__u32 *</td>
<td><code class="docutils literal notranslate"><span class="pre">p_u32</span></code></td>
<td>A pointer to a matrix control of unsigned 32-bit values. Valid if
this control is of type <code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_TYPE_U32</span></code>.</td>
</tr>
<tr class="row-odd"><td><code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_area</span></code> *</td>
<td><code class="docutils literal notranslate"><span class="pre">p_area</span></code></td>
<td>A pointer to a struct <code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_area</span></code>. Valid if this control is
of type <code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_TYPE_AREA</span></code>.</td>
</tr>
<tr class="row-even"><td>void *</td>
<td><code class="docutils literal notranslate"><span class="pre">ptr</span></code></td>
<td>A pointer to a compound type which can be an N-dimensional array
and/or a compound type (the control’s type is &gt;=
<code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_COMPOUND_TYPES</span></code>). Valid if
<code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_FLAG_HAS_PAYLOAD</span></code> is set for this control.</td>
</tr>
<tr class="row-odd"><td>}</td>
<td colspan="2">&#160;</td>
</tr>
</tbody>
</table>
<dl class="type">
<dt id="c.v4l2_ext_controls">
<code class="descname">v4l2_ext_controls</code><a class="headerlink" href="#c.v4l2_ext_controls" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<table border="1" class="longtable docutils" id="id2">
<caption><span class="caption-text">struct v4l2_ext_controls</span><a class="headerlink" href="#id2" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>union {</td>
<td colspan="2">(anonymous)</td>
</tr>
<tr class="row-even"><td>__u32</td>
<td><code class="docutils literal notranslate"><span class="pre">ctrl_class</span></code></td>
<td>The control class to which all controls belong, see
<a class="reference internal" href="#ctrl-class"><span class="std std-ref">Control classes</span></a>. Drivers that use a kernel framework for
handling controls will also accept a value of 0 here, meaning that
the controls can belong to any control class. Whether drivers
support this can be tested by setting <code class="docutils literal notranslate"><span class="pre">ctrl_class</span></code> to 0 and
calling <a class="reference internal" href="#vidioc-g-ext-ctrls"><span class="std std-ref">VIDIOC_TRY_EXT_CTRLS</span></a> with a <code class="docutils literal notranslate"><span class="pre">count</span></code> of 0. If that
succeeds, then the driver supports this feature.</td>
</tr>
<tr class="row-odd"><td>__u32</td>
<td><code class="docutils literal notranslate"><span class="pre">which</span></code></td>
<td><p class="first">Which value of the control to get/set/try.
<code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_WHICH_CUR_VAL</span></code> will return the current value of the
control, <code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_WHICH_DEF_VAL</span></code> will return the default
value of the control and <code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_WHICH_REQUEST_VAL</span></code> indicates that
these controls have to be retrieved from a request or tried/set for
a request. In the latter case the <code class="docutils literal notranslate"><span class="pre">request_fd</span></code> field contains the
file descriptor of the request that should be used. If the device
does not support requests, then <code class="docutils literal notranslate"><span class="pre">EACCES</span></code> will be returned.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When using <code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_WHICH_DEF_VAL</span></code> be aware that you can only
get the default value of the control, you cannot set or try it.</p>
</div>
<p class="last">For backwards compatibility you can also use a control class here
(see <a class="reference internal" href="#ctrl-class"><span class="std std-ref">Control classes</span></a>). In that case all controls have to
belong to that control class. This usage is deprecated, instead
just use <code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_WHICH_CUR_VAL</span></code>. There are some very old
drivers that do not yet support <code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_WHICH_CUR_VAL</span></code> and
that require a control class here. You can test for such drivers
by setting ctrl_class to <code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_WHICH_CUR_VAL</span></code> and calling
VIDIOC_TRY_EXT_CTRLS with a count of 0. If that fails, then the
driver does not support <code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_WHICH_CUR_VAL</span></code>.</p>
</td>
</tr>
<tr class="row-even"><td>}</td>
<td colspan="2">&#160;</td>
</tr>
<tr class="row-odd"><td>__u32</td>
<td><code class="docutils literal notranslate"><span class="pre">count</span></code></td>
<td>The number of controls in the controls array. May also be zero.</td>
</tr>
<tr class="row-even"><td>__u32</td>
<td><code class="docutils literal notranslate"><span class="pre">error_idx</span></code></td>
<td><p class="first">Set by the driver in case of an error. If the error is associated
with a particular control, then <code class="docutils literal notranslate"><span class="pre">error_idx</span></code> is set to the index
of that control. If the error is not related to a specific
control, or the validation step failed (see below), then
<code class="docutils literal notranslate"><span class="pre">error_idx</span></code> is set to <code class="docutils literal notranslate"><span class="pre">count</span></code>. The value is undefined if the
ioctl returned 0 (success).</p>
<p>Before controls are read from/written to hardware a validation
step takes place: this checks if all controls in the list are
valid controls, if no attempt is made to write to a read-only
control or read from a write-only control, and any other up-front
checks that can be done without accessing the hardware. The exact
validations done during this step are driver dependent since some
checks might require hardware access for some devices, thus making
it impossible to do those checks up-front. However, drivers should
make a best-effort to do as many up-front checks as possible.</p>
<p>This check is done to avoid leaving the hardware in an
inconsistent state due to easy-to-avoid problems. But it leads to
another problem: the application needs to know whether an error
came from the validation step (meaning that the hardware was not
touched) or from an error during the actual reading from/writing
to hardware.</p>
<p>The, in hindsight quite poor, solution for that is to set
<code class="docutils literal notranslate"><span class="pre">error_idx</span></code> to <code class="docutils literal notranslate"><span class="pre">count</span></code> if the validation failed. This has the
unfortunate side-effect that it is not possible to see which
control failed the validation. If the validation was successful
and the error happened while accessing the hardware, then
<code class="docutils literal notranslate"><span class="pre">error_idx</span></code> is less than <code class="docutils literal notranslate"><span class="pre">count</span></code> and only the controls up to
<code class="docutils literal notranslate"><span class="pre">error_idx-1</span></code> were read or written correctly, and the state of
the remaining controls is undefined.</p>
<p class="last">Since <a class="reference internal" href="#vidioc-g-ext-ctrls"><span class="std std-ref">VIDIOC_TRY_EXT_CTRLS</span></a> does not access hardware there is
also no need to handle the validation step in this special way, so
<code class="docutils literal notranslate"><span class="pre">error_idx</span></code> will just be set to the control that failed the
validation step instead of to <code class="docutils literal notranslate"><span class="pre">count</span></code>. This means that if
<a class="reference internal" href="#vidioc-g-ext-ctrls"><span class="std std-ref">VIDIOC_S_EXT_CTRLS</span></a> fails with <code class="docutils literal notranslate"><span class="pre">error_idx</span></code> set to <code class="docutils literal notranslate"><span class="pre">count</span></code>,
then you can call <a class="reference internal" href="#vidioc-g-ext-ctrls"><span class="std std-ref">VIDIOC_TRY_EXT_CTRLS</span></a> to try to discover the
actual control that failed the validation step. Unfortunately,
there is no <code class="docutils literal notranslate"><span class="pre">TRY</span></code> equivalent for <a class="reference internal" href="#vidioc-g-ext-ctrls"><span class="std std-ref">VIDIOC_G_EXT_CTRLS</span></a>.</p>
</td>
</tr>
<tr class="row-odd"><td>__s32</td>
<td><code class="docutils literal notranslate"><span class="pre">request_fd</span></code></td>
<td>File descriptor of the request to be used by this operation. Only
valid if <code class="docutils literal notranslate"><span class="pre">which</span></code> is set to <code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_WHICH_REQUEST_VAL</span></code>.
If the device does not support requests, then <code class="docutils literal notranslate"><span class="pre">EACCES</span></code> will be returned.
If requests are supported but an invalid request file descriptor is
given, then <code class="docutils literal notranslate"><span class="pre">EINVAL</span></code> will be returned.</td>
</tr>
<tr class="row-even"><td>__u32</td>
<td><code class="docutils literal notranslate"><span class="pre">reserved</span></code>[1]</td>
<td><p class="first">Reserved for future extensions.</p>
<p class="last">Drivers and applications must set the array to zero.</p>
</td>
</tr>
<tr class="row-odd"><td>struct <a class="reference internal" href="#c.v4l2_ext_control" title="v4l2_ext_control"><code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_ext_control</span></code></a> *</td>
<td><code class="docutils literal notranslate"><span class="pre">controls</span></code></td>
<td><p class="first">Pointer to an array of <code class="docutils literal notranslate"><span class="pre">count</span></code> v4l2_ext_control structures.</p>
<p class="last">Ignored if <code class="docutils literal notranslate"><span class="pre">count</span></code> equals zero.</p>
</td>
</tr>
</tbody>
</table>
<span id="ctrl-class"></span><table border="1" class="docutils" id="id3">
<caption><span class="caption-text">Control classes</span><a class="headerlink" href="#id3" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="38%" />
<col width="13%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_CLASS_USER</span></code></td>
<td>0x980000</td>
<td>The class containing user controls. These controls are described
in <a class="reference internal" href="control.html#control"><span class="std std-ref">User Controls</span></a>. All controls that can be set using the
<a class="reference internal" href="vidioc-g-ctrl.html#vidioc-g-ctrl"><span class="std std-ref">VIDIOC_S_CTRL</span></a> and
<a class="reference internal" href="vidioc-g-ctrl.html#vidioc-g-ctrl"><span class="std std-ref">VIDIOC_G_CTRL</span></a> ioctl belong to this
class.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_CLASS_MPEG</span></code></td>
<td>0x990000</td>
<td>The class containing MPEG compression controls. These controls are
described in <a class="reference internal" href="ext-ctrls-codec.html#mpeg-controls"><span class="std std-ref">Codec Control Reference</span></a>.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_CLASS_CAMERA</span></code></td>
<td>0x9a0000</td>
<td>The class containing camera controls. These controls are described
in <a class="reference internal" href="ext-ctrls-camera.html#camera-controls"><span class="std std-ref">Camera Control Reference</span></a>.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_CLASS_FM_TX</span></code></td>
<td>0x9b0000</td>
<td>The class containing FM Transmitter (FM TX) controls. These
controls are described in <a class="reference internal" href="ext-ctrls-fm-tx.html#fm-tx-controls"><span class="std std-ref">FM Transmitter Control Reference</span></a>.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_CLASS_FLASH</span></code></td>
<td>0x9c0000</td>
<td>The class containing flash device controls. These controls are
described in <a class="reference internal" href="ext-ctrls-flash.html#flash-controls"><span class="std std-ref">Flash Control Reference</span></a>.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_CLASS_JPEG</span></code></td>
<td>0x9d0000</td>
<td>The class containing JPEG compression controls. These controls are
described in <a class="reference internal" href="ext-ctrls-jpeg.html#jpeg-controls"><span class="std std-ref">JPEG Control Reference</span></a>.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_CLASS_IMAGE_SOURCE</span></code></td>
<td>0x9e0000</td>
<td>The class containing image source controls. These controls are
described in <a class="reference internal" href="ext-ctrls-image-source.html#image-source-controls"><span class="std std-ref">Image Source Control Reference</span></a>.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_CLASS_IMAGE_PROC</span></code></td>
<td>0x9f0000</td>
<td>The class containing image processing controls. These controls are
described in <a class="reference internal" href="ext-ctrls-image-process.html#image-process-controls"><span class="std std-ref">Image Process Control Reference</span></a>.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_CLASS_FM_RX</span></code></td>
<td>0xa10000</td>
<td>The class containing FM Receiver (FM RX) controls. These controls
are described in <a class="reference internal" href="ext-ctrls-fm-rx.html#fm-rx-controls"><span class="std std-ref">FM Receiver Control Reference</span></a>.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_CLASS_RF_TUNER</span></code></td>
<td>0xa20000</td>
<td>The class containing RF tuner controls. These controls are
described in <a class="reference internal" href="ext-ctrls-rf-tuner.html#rf-tuner-controls"><span class="std std-ref">RF Tuner Control Reference</span></a>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="return-value">
<h2>7.29.5. Return Value<a class="headerlink" href="#return-value" title="Permalink to this headline">¶</a></h2>
<p>On success 0 is returned, on error -1 and the <code class="docutils literal notranslate"><span class="pre">errno</span></code> variable is set
appropriately. The generic error codes are described at the
<a class="reference internal" href="../gen-errors.html#id1"><span class="std std-ref">Generic Error Codes</span></a> chapter.</p>
<dl class="docutils">
<dt>EINVAL</dt>
<dd>The struct <a class="reference internal" href="#c.v4l2_ext_control" title="v4l2_ext_control"><code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_ext_control</span></code></a> <code class="docutils literal notranslate"><span class="pre">id</span></code> is
invalid, or the struct <a class="reference internal" href="#c.v4l2_ext_controls" title="v4l2_ext_controls"><code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_ext_controls</span></code></a>
<code class="docutils literal notranslate"><span class="pre">which</span></code> is invalid, or the struct
<a class="reference internal" href="#c.v4l2_ext_control" title="v4l2_ext_control"><code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_ext_control</span></code></a> <code class="docutils literal notranslate"><span class="pre">value</span></code> was
inappropriate (e.g. the given menu index is not supported by the
driver), or the <code class="docutils literal notranslate"><span class="pre">which</span></code> field was set to <code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_WHICH_REQUEST_VAL</span></code>
but the given <code class="docutils literal notranslate"><span class="pre">request_fd</span></code> was invalid or <code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_WHICH_REQUEST_VAL</span></code>
is not supported by the kernel.
This error code is also returned by the
<a class="reference internal" href="#vidioc-g-ext-ctrls"><span class="std std-ref">VIDIOC_S_EXT_CTRLS</span></a> and <a class="reference internal" href="#vidioc-g-ext-ctrls"><span class="std std-ref">VIDIOC_TRY_EXT_CTRLS</span></a> ioctls if two or
more control values are in conflict.</dd>
<dt>ERANGE</dt>
<dd>The struct <a class="reference internal" href="#c.v4l2_ext_control" title="v4l2_ext_control"><code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_ext_control</span></code></a> <code class="docutils literal notranslate"><span class="pre">value</span></code>
is out of bounds.</dd>
<dt>EBUSY</dt>
<dd>The control is temporarily not changeable, possibly because another
applications took over control of the device function this control
belongs to, or (if the <code class="docutils literal notranslate"><span class="pre">which</span></code> field was set to
<code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_WHICH_REQUEST_VAL</span></code>) the request was queued but not yet
completed.</dd>
<dt>ENOSPC</dt>
<dd>The space reserved for the control’s payload is insufficient. The
field <code class="docutils literal notranslate"><span class="pre">size</span></code> is set to a value that is enough to store the payload
and this error code is returned.</dd>
<dt>EACCES</dt>
<dd><p class="first">Attempt to try or set a read-only control, or to get a write-only
control, or to get a control from a request that has not yet been
completed.</p>
<p class="last">Or the <code class="docutils literal notranslate"><span class="pre">which</span></code> field was set to <code class="docutils literal notranslate"><span class="pre">V4L2_CTRL_WHICH_REQUEST_VAL</span></code> but the
device does not support requests.</p>
</dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>