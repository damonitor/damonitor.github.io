

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Driver for the Intel Wireless Wimax Connection 2400m &mdash; The Linux Kernel  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.10.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../mm/damon/index.html">Monitoring Data Accesses</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../vm/damon/index.html">DAMON: Data Access MONitor</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Driver for the Intel Wireless Wimax Connection 2400m</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/admin-guide/wimax/i2400m.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="driver-for-the-intel-wireless-wimax-connection-2400m">
<h1>Driver for the Intel Wireless Wimax Connection 2400m<a class="headerlink" href="#driver-for-the-intel-wireless-wimax-connection-2400m" title="Permalink to this headline">¶</a></h1>
<dl class="field-list">
<dt class="field-odd">Copyright</dt>
<dd class="field-odd"><p>© 2008 Intel Corporation &lt; <a class="reference external" href="mailto:linux-wimax&#37;&#52;&#48;intel&#46;com">linux-wimax<span>&#64;</span>intel<span>&#46;</span>com</a> &gt;</p>
<p>This provides a driver for the Intel Wireless WiMAX Connection 2400m
and a basic Linux kernel WiMAX stack.</p>
</dd>
</dl>
<div class="section" id="requirements">
<h2>1. Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul>
<li><p>Linux installation with Linux kernel 2.6.22 or newer (if building
from a separate tree)</p></li>
<li><p>Intel i2400m Echo Peak or Baxter Peak; this includes the Intel
Wireless WiMAX/WiFi Link 5x50 series.</p></li>
<li><p>build tools:</p>
<blockquote>
<div><ul class="simple">
<li><p>Linux kernel development package for the target kernel; to
build against your currently running kernel, you need to have
the kernel development package corresponding to the running
image installed (usually if your kernel is named
linux-VERSION, the development package is called
linux-dev-VERSION or linux-headers-VERSION).</p></li>
<li><p>GNU C Compiler, make</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="compilation-and-installation">
<h2>2. Compilation and installation<a class="headerlink" href="#compilation-and-installation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="compilation-of-the-drivers-included-in-the-kernel">
<h3>2.1. Compilation of the drivers included in the kernel<a class="headerlink" href="#compilation-of-the-drivers-included-in-the-kernel" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Configure the kernel; to enable the WiMAX drivers select Drivers &gt;
Networking Drivers &gt; WiMAX device support. Enable all of them as
modules (easier).</p>
<p>If USB or SDIO are not enabled in the kernel configuration, the options
to build the i2400m USB or SDIO drivers will not show. Enable said
subsystems and go back to the WiMAX menu to enable the drivers.</p>
<p>Compile and install your kernel as usual.</p>
</div></blockquote>
</div>
<div class="section" id="compilation-of-the-drivers-distributed-as-an-standalone-module">
<h3>2.2. Compilation of the drivers distributed as an standalone module<a class="headerlink" href="#compilation-of-the-drivers-distributed-as-an-standalone-module" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>To compile:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ cd source/directory
$ make
</pre></div>
</div>
<p>Once built you can load and unload using the provided load.sh script;
load.sh will load the modules, load.sh u will unload them.</p>
<p>To install in the default kernel directories (and enable auto loading
when the device is plugged):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ make install
$ depmod -a
</pre></div>
</div>
<p>If your kernel development files are located in a non standard
directory or if you want to build for a kernel that is not the
currently running one, set KDIR to the right location:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ make KDIR=/path/to/kernel/dev/tree
</pre></div>
</div>
<p>For more information, please contact <a class="reference external" href="mailto:linux-wimax&#37;&#52;&#48;intel&#46;com">linux-wimax<span>&#64;</span>intel<span>&#46;</span>com</a>.</p>
</div></blockquote>
</div>
<div class="section" id="installing-the-firmware">
<h3>3. Installing the firmware<a class="headerlink" href="#installing-the-firmware" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>The firmware can be obtained from <a class="reference external" href="http://linuxwimax.org">http://linuxwimax.org</a> or might have
been supplied with your hardware.</p>
<p>It has to be installed in the target system:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>   $ cp FIRMWAREFILE.sbcf /lib/firmware/i2400m-fw-BUSTYPE-1.3.sbcf

* NOTE: if your firmware came in an .rpm or .deb file, just install
  it as normal, with the rpm (rpm -i FIRMWARE.rpm) or dpkg
  (dpkg -i FIRMWARE.deb) commands. No further action is needed.
* BUSTYPE will be usb or sdio, depending on the hardware you have.
  Each hardware type comes with its own firmware and will not work
  with other types.
</pre></div>
</div>
</div></blockquote>
</div>
</div>
<div class="section" id="design">
<h2>4. Design<a class="headerlink" href="#design" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>This package contains two major parts: a WiMAX kernel stack and a
driver for the Intel i2400m.</p>
<p>The WiMAX stack is designed to provide for common WiMAX control
services to current and future WiMAX devices from any vendor; please
see README.wimax for details.</p>
<p>The i2400m kernel driver is broken up in two main parts: the bus
generic driver and the bus-specific drivers. The bus generic driver
forms the drivercore and contain no knowledge of the actual method we
use to connect to the device. The bus specific drivers are just the
glue to connect the bus-generic driver and the device. Currently only
USB and SDIO are supported. See drivers/net/wimax/i2400m/i2400m.h for
more information.</p>
<p>The bus generic driver is logically broken up in two parts: OS-glue and
hardware-glue. The OS-glue interfaces with Linux. The hardware-glue
interfaces with the device on using an interface provided by the
bus-specific driver. The reason for this breakup is to be able to
easily reuse the hardware-glue to write drivers for other OSes; note
the hardware glue part is written as a native Linux driver; no
abstraction layers are used, so to port to another OS, the Linux kernel
API calls should be replaced with the target OS’s.</p>
</div></blockquote>
</div>
<div class="section" id="usage">
<h2>5. Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>To load the driver, follow the instructions in the install section;
once the driver is loaded, plug in the device (unless it is permanently
plugged in). The driver will enumerate the device, upload the firmware
and output messages in the kernel log (dmesg, /var/log/messages or
/var/log/kern.log) such as:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>...
i2400m_usb 5-4:1.0: firmware interface version 8.0.0
i2400m_usb 5-4:1.0: WiMAX interface wmx0 (00:1d:e1:01:94:2c) ready
</pre></div>
</div>
<p>At this point the device is ready to work.</p>
<p>Current versions require the Intel WiMAX Network Service in userspace
to make things work. See the network service’s README for instructions
on how to scan, connect and disconnect.</p>
</div></blockquote>
<div class="section" id="module-parameters">
<h3>5.1. Module parameters<a class="headerlink" href="#module-parameters" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Module parameters can be set at kernel or module load time or by
echoing values:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ echo VALUE &gt; /sys/module/MODULENAME/parameters/PARAMETERNAME
</pre></div>
</div>
<p>To make changes permanent, for example, for the i2400m module, you can
also create a file named /etc/modprobe.d/i2400m containing:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>options i2400m idle_mode_disabled=1
</pre></div>
</div>
<p>To find which parameters are supported by a module, run:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ modinfo path/to/module.ko
</pre></div>
</div>
<p>During kernel bootup (if the driver is linked in the kernel), specify
the following to the kernel command line:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>i2400m.PARAMETER=VALUE
</pre></div>
</div>
</div></blockquote>
<div class="section" id="i2400m-idle-mode-disabled">
<h4>5.1.1. i2400m: idle_mode_disabled<a class="headerlink" href="#i2400m-idle-mode-disabled" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>The i2400m module supports a parameter to disable idle mode. This
parameter, once set, will take effect only when the device is
reinitialized by the driver (eg: following a reset or a reconnect).</p>
</div></blockquote>
</div>
</div>
<div class="section" id="debug-operations-debugfs-entries">
<h3>5.2. Debug operations: debugfs entries<a class="headerlink" href="#debug-operations-debugfs-entries" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>The driver will register debugfs entries that allow the user to tweak
debug settings. There are three main container directories where
entries are placed, which correspond to the three blocks a i2400m WiMAX
driver has:</p>
<blockquote>
<div><ul class="simple">
<li><p>/sys/kernel/debug/wimax:DEVNAME/ for the generic WiMAX stack
controls</p></li>
<li><p>/sys/kernel/debug/wimax:DEVNAME/i2400m for the i2400m generic
driver controls</p></li>
<li><p>/sys/kernel/debug/wimax:DEVNAME/i2400m-usb (or -sdio) for the
bus-specific i2400m-usb or i2400m-sdio controls).</p></li>
</ul>
</div></blockquote>
<p>Of course, if debugfs is mounted in a directory other than
/sys/kernel/debug, those paths will change.</p>
</div></blockquote>
<div class="section" id="increasing-debug-output">
<h4>5.2.1. Increasing debug output<a class="headerlink" href="#increasing-debug-output" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>The files named <em>dl_</em> indicate knobs for controlling the debug output
of different submodules:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># find /sys/kernel/debug/wimax\:wmx0 -name \*dl_\*
/sys/kernel/debug/wimax:wmx0/i2400m-usb/dl_tx
/sys/kernel/debug/wimax:wmx0/i2400m-usb/dl_rx
/sys/kernel/debug/wimax:wmx0/i2400m-usb/dl_notif
/sys/kernel/debug/wimax:wmx0/i2400m-usb/dl_fw
/sys/kernel/debug/wimax:wmx0/i2400m-usb/dl_usb
/sys/kernel/debug/wimax:wmx0/i2400m/dl_tx
/sys/kernel/debug/wimax:wmx0/i2400m/dl_rx
/sys/kernel/debug/wimax:wmx0/i2400m/dl_rfkill
/sys/kernel/debug/wimax:wmx0/i2400m/dl_netdev
/sys/kernel/debug/wimax:wmx0/i2400m/dl_fw
/sys/kernel/debug/wimax:wmx0/i2400m/dl_debugfs
/sys/kernel/debug/wimax:wmx0/i2400m/dl_driver
/sys/kernel/debug/wimax:wmx0/i2400m/dl_control
/sys/kernel/debug/wimax:wmx0/wimax_dl_stack
/sys/kernel/debug/wimax:wmx0/wimax_dl_op_rfkill
/sys/kernel/debug/wimax:wmx0/wimax_dl_op_reset
/sys/kernel/debug/wimax:wmx0/wimax_dl_op_msg
/sys/kernel/debug/wimax:wmx0/wimax_dl_id_table
/sys/kernel/debug/wimax:wmx0/wimax_dl_debugfs
</pre></div>
</div>
<p>By reading the file you can obtain the current value of said debug
level; by writing to it, you can set it.</p>
<p>To increase the debug level of, for example, the i2400m’s generic TX
engine, just write:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ echo 3 &gt; /sys/kernel/debug/wimax:wmx0/i2400m/dl_tx
</pre></div>
</div>
<p>Increasing numbers yield increasing debug information; for details of
what is printed and the available levels, check the source. The code
uses 0 for disabled and increasing values until 8.</p>
</div></blockquote>
</div>
<div class="section" id="rx-and-tx-statistics">
<h4>5.2.2. RX and TX statistics<a class="headerlink" href="#rx-and-tx-statistics" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>The i2400m/rx_stats and i2400m/tx_stats provide statistics about the
data reception/delivery from the device:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ cat /sys/kernel/debug/wimax:wmx0/i2400m/rx_stats
45 1 3 34 3104 48 480
</pre></div>
</div>
<p>The numbers reported are:</p>
<blockquote>
<div><ul class="simple">
<li><p>packets/RX-buffer: total, min, max</p></li>
<li><p>RX-buffers: total RX buffers received, accumulated RX buffer size
in bytes, min size received, max size received</p></li>
</ul>
</div></blockquote>
<p>Thus, to find the average buffer size received, divide accumulated
RX-buffer / total RX-buffers.</p>
<p>To clear the statistics back to 0, write anything to the rx_stats file:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ echo 1 &gt; /sys/kernel/debug/wimax:wmx0/i2400m_rx_stats
</pre></div>
</div>
<p>Likewise for TX.</p>
<p>Note the packets this debug file refers to are not network packet, but
packets in the sense of the device-specific protocol for communication
to the host. See drivers/net/wimax/i2400m/tx.c.</p>
</div></blockquote>
</div>
<div class="section" id="tracing-messages-received-from-user-space">
<h4>5.2.3. Tracing messages received from user space<a class="headerlink" href="#tracing-messages-received-from-user-space" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>To echo messages received from user space into the trace pipe that the
i2400m driver creates, set the debug file i2400m/trace_msg_from_user to
1:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ echo 1 &gt; /sys/kernel/debug/wimax:wmx0/i2400m/trace_msg_from_user
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="performing-a-device-reset">
<h4>5.2.4. Performing a device reset<a class="headerlink" href="#performing-a-device-reset" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>By writing a 0, a 1 or a 2 to the file
/sys/kernel/debug/wimax:wmx0/reset, the driver performs a warm (without
disconnecting from the bus), cold (disconnecting from the bus) or bus
(bus specific) reset on the device.</p>
</div></blockquote>
</div>
<div class="section" id="asking-the-device-to-enter-power-saving-mode">
<h4>5.2.5. Asking the device to enter power saving mode<a class="headerlink" href="#asking-the-device-to-enter-power-saving-mode" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>By writing any value to the /sys/kernel/debug/wimax:wmx0 file, the
device will attempt to enter power saving mode.</p>
</div></blockquote>
</div>
</div>
</div>
<div class="section" id="troubleshooting">
<h2>6. Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this headline">¶</a></h2>
<div class="section" id="driver-complains-about-i2400m-fw-usb-1-2-sbcf-request-failed">
<h3>6.1. Driver complains about <code class="docutils literal notranslate"><span class="pre">i2400m-fw-usb-1.2.sbcf:</span> <span class="pre">request</span> <span class="pre">failed</span></code><a class="headerlink" href="#driver-complains-about-i2400m-fw-usb-1-2-sbcf-request-failed" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>If upon connecting the device, the following is output in the kernel
log:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>i2400m_usb 5-4:1.0: fw i2400m-fw-usb-1.3.sbcf: request failed: -2
</pre></div>
</div>
<p>This means that the driver cannot locate the firmware file named
/lib/firmware/i2400m-fw-usb-1.2.sbcf. Check that the file is present in
the right location.</p>
</div></blockquote>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright The kernel development community

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>