

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Information regarding the Enhanced IDE drive &mdash; The Linux Kernel  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.7.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/mm/damon/index.html">DAMON: Data Access MONitor</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Information regarding the Enhanced IDE drive</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/ide/ide.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="information-regarding-the-enhanced-ide-drive">
<h1>Information regarding the Enhanced IDE drive<a class="headerlink" href="#information-regarding-the-enhanced-ide-drive" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div>The hdparm utility can be used to control various IDE features on a
running system. It is packaged separately.  Please Look for it on popular
linux FTP sites.</div></blockquote>
<hr class="docutils" />
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p>BUGGY IDE CHIPSETS CAN CORRUPT DATA!!</p>
<blockquote class="last">
<div><p>PCI versions of the CMD640 and RZ1000 interfaces are now detected
automatically at startup when PCI BIOS support is configured.</p>
<p>Linux disables the “prefetch” (“readahead”) mode of the RZ1000
to prevent data corruption possible due to hardware design flaws.</p>
<p>For the CMD640, linux disables “IRQ unmasking” (hdparm -u1) on any
drive for which the “prefetch” mode of the CMD640 is turned on.
If “prefetch” is disabled (hdparm -p8), then “IRQ unmasking” can be
used again.</p>
<p>For the CMD640, linux disables “32bit I/O” (hdparm -c1) on any drive
for which the “prefetch” mode of the CMD640 is turned off.
If “prefetch” is enabled (hdparm -p9), then “32bit I/O” can be
used again.</p>
<p>The CMD640 is also used on some Vesa Local Bus (VLB) cards, and is <em>NOT</em>
automatically detected by Linux.  For safe, reliable operation with such
interfaces, one <em>MUST</em> use the “cmd640.probe_vlb” kernel option.</p>
<p>Use of the “serialize” option is no longer necessary.</p>
</div></blockquote>
</div>
<hr class="docutils" />
<div class="section" id="common-pitfalls">
<h2>Common pitfalls<a class="headerlink" href="#common-pitfalls" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>40-conductor IDE cables are capable of transferring data in DMA modes up to
udma2, but no faster.</li>
<li>If possible devices should be attached to separate channels if they are
available. Typically the disk on the first and CD-ROM on the second.</li>
<li>If you mix devices on the same cable, please consider using similar devices
in respect of the data transfer mode they support.</li>
<li>Even better try to stick to the same vendor and device type on the same
cable.</li>
</ul>
</div>
<div class="section" id="this-is-the-multiple-ide-interface-driver-as-evolved-from-hd-c">
<h2>This is the multiple IDE interface driver, as evolved from hd.c<a class="headerlink" href="#this-is-the-multiple-ide-interface-driver-as-evolved-from-hd-c" title="Permalink to this headline">¶</a></h2>
<p>It supports up to 9 IDE interfaces per default, on one or more IRQs (usually
14 &amp; 15).  There can be up to two drives per interface, as per the ATA-6 spec.:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Primary:    ide0, port 0x1f0; major=3;  hda is minor=0; hdb is minor=64
Secondary:  ide1, port 0x170; major=22; hdc is minor=0; hdd is minor=64
Tertiary:   ide2, port 0x1e8; major=33; hde is minor=0; hdf is minor=64
Quaternary: ide3, port 0x168; major=34; hdg is minor=0; hdh is minor=64
fifth..     ide4, usually PCI, probed
sixth..     ide5, usually PCI, probed
</pre></div>
</div>
<p>To access devices on interfaces &gt; ide0, device entries please make sure that
device files for them are present in /dev.  If not, please create such
entries, by using /dev/MAKEDEV.</p>
<p>This driver automatically probes for most IDE interfaces (including all PCI
ones), for the drives/geometries attached to those interfaces, and for the IRQ
lines being used by the interfaces (normally 14, 15 for ide0/ide1).</p>
<p>Any number of interfaces may share a single IRQ if necessary, at a slight
performance penalty, whether on separate cards or a single VLB card.
The IDE driver automatically detects and handles this.  However, this may
or may not be harmful to your hardware.. two or more cards driving the same IRQ
can potentially burn each other’s bus driver, though in practice this
seldom occurs.  Be careful, and if in doubt, don’t do it!</p>
<p>Drives are normally found by auto-probing and/or examining the CMOS/BIOS data.
For really weird situations, the apparent (fdisk) geometry can also be specified
on the kernel “command line” using LILO.  The format of such lines is:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ide_core.chs=[interface_number.device_number]:cyls,heads,sects
</pre></div>
</div>
<p>or:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ide_core.cdrom=[interface_number.device_number]
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ide_core.chs=1.0:1050,32,64  ide_core.cdrom=1.1
</pre></div>
</div>
<p>The results of successful auto-probing may override the physical geometry/irq
specified, though the “original” geometry may be retained as the “logical”
geometry for partitioning purposes (fdisk).</p>
<p>If the auto-probing during boot time confuses a drive (ie. the drive works
with hd.c but not with ide.c), then an command line option may be specified
for each drive for which you’d like the drive to skip the hardware
probe/identification sequence.  For example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ide_core.noprobe=0.1
</pre></div>
</div>
<p>or:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ide_core.chs=1.0:768,16,32
ide_core.noprobe=1.0
</pre></div>
</div>
<p>Note that when only one IDE device is attached to an interface, it should be
jumpered as “single” or “master”, <em>not</em> “slave”.  Many folks have had
“trouble” with cdroms because of this requirement, so the driver now probes
for both units, though success is more likely when the drive is jumpered
correctly.</p>
<p>Courtesy of Scott Snyder and others, the driver supports ATAPI cdrom drives
such as the NEC-260 and the new MITSUMI triple/quad speed drives.
Such drives will be identified at boot time, just like a hard disk.</p>
<p>If for some reason your cdrom drive is <em>not</em> found at boot time, you can force
the probe to look harder by supplying a kernel command line parameter
via LILO, such as::</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ide_core.cdrom=1.0      /* &quot;master&quot; on second interface (hdc) */
</pre></div>
</div>
<p>or:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ide_core.cdrom=1.1      /* &quot;slave&quot; on second interface (hdd) */
</pre></div>
</div>
<p>For example, a GW2000 system might have a hard drive on the primary
interface (/dev/hda) and an IDE cdrom drive on the secondary interface
(/dev/hdc).  To mount a CD in the cdrom drive, one would use something like:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ln -sf /dev/hdc /dev/cdrom
mkdir /mnt/cdrom
mount /dev/cdrom /mnt/cdrom -t iso9660 -o ro
</pre></div>
</div>
<p>If, after doing all of the above, mount doesn’t work and you see
errors from the driver (with dmesg) complaining about <cite>status=0xff</cite>,
this means that the hardware is not responding to the driver’s attempts
to read it.  One of the following is probably the problem:</p>
<blockquote>
<div><ul class="simple">
<li>Your hardware is broken.</li>
<li>You are using the wrong address for the device, or you have the
drive jumpered wrong.  Review the configuration instructions above.</li>
<li>Your IDE controller requires some nonstandard initialization sequence
before it will work properly.  If this is the case, there will often
be a separate MS-DOS driver just for the controller.  IDE interfaces
on sound cards usually fall into this category.  Such configurations
can often be made to work by first booting MS-DOS, loading the
appropriate drivers, and then warm-booting linux (without powering
off).  This can be automated using loadlin in the MS-DOS autoexec.</li>
</ul>
</div></blockquote>
<p>If you always get timeout errors, interrupts from the drive are probably
not making it to the host.  Check how you have the hardware jumpered
and make sure it matches what the driver expects (see the configuration
instructions above).  If you have a PCI system, also check the BIOS
setup; I’ve had one report of a system which was shipped with IRQ 15
disabled by the BIOS.</p>
<p>The kernel is able to execute binaries directly off of the cdrom,
provided it is mounted with the default block size of 1024 (as above).</p>
<p>Please pass on any feedback on any of this stuff to the maintainer,
whose address can be found in linux/MAINTAINERS.</p>
<p>The IDE driver is modularized.  The high level disk/CD-ROM/tape/floppy
drivers can always be compiled as loadable modules, the chipset drivers
can only be compiled into the kernel, and the core code (ide.c) can be
compiled as a loadable module provided no chipset support is needed.</p>
<p>When using ide.c as a module in combination with kmod, add:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>alias block-major-3 ide-probe
</pre></div>
</div>
<p>to a configuration file in /etc/modprobe.d/.</p>
<p>When ide.c is used as a module, you can pass command line parameters to the
driver using the “options=” keyword to insmod, while replacing any ‘,’ with
‘;’.</p>
</div>
<div class="section" id="summary-of-ide-driver-parameters-for-kernel-command-line">
<h2>Summary of ide driver parameters for kernel command line<a class="headerlink" href="#summary-of-ide-driver-parameters-for-kernel-command-line" title="Permalink to this headline">¶</a></h2>
<p>For legacy IDE VLB host drivers (ali14xx/dtc2278/ht6560b/qd65xx/umc8672)
you need to explicitly enable probing by using “probe” kernel parameter,
i.e. to enable probing for ALI M14xx chipsets (ali14xx host driver) use:</p>
<ul class="simple">
<li>“ali14xx.probe” boot option when ali14xx driver is built-in the kernel</li>
<li>“probe” module parameter when ali14xx driver is compiled as module
(“modprobe ali14xx probe”)</li>
</ul>
<p>Also for legacy CMD640 host driver (cmd640) you need to use “probe_vlb”
kernel paremeter to enable probing for VLB version of the chipset (PCI ones
are detected automatically).</p>
<p>You also need to use “probe” kernel parameter for ide-4drives driver
(support for IDE generic chipset with four drives on one port).</p>
<p>To enable support for IDE doublers on Amiga use “doubler” kernel parameter
for gayle host driver (i.e. “gayle.doubler” if the driver is built-in).</p>
<p>To force ignoring cable detection (this should be needed only if you’re using
short 40-wires cable which cannot be automatically detected - if this is not
a case please report it as a bug instead) use “ignore_cable” kernel parameter:</p>
<ul class="simple">
<li>“ide_core.ignore_cable=[interface_number]” boot option if IDE is built-in
(i.e. “ide_core.ignore_cable=1” to force ignoring cable for “ide1”)</li>
<li>“ignore_cable=[interface_number]” module parameter (for ide_core module)
if IDE is compiled as module</li>
</ul>
<p>Other kernel parameters for ide_core are:</p>
<ul class="simple">
<li>“nodma=[interface_number.device_number]” to disallow DMA for a device</li>
<li>“noflush=[interface_number.device_number]” to disable flush requests</li>
<li>“nohpa=[interface_number.device_number]” to disable Host Protected Area</li>
<li>“noprobe=[interface_number.device_number]” to skip probing</li>
<li>“nowerr=[interface_number.device_number]” to ignore the WRERR_STAT bit</li>
<li>“cdrom=[interface_number.device_number]” to force device as a CD-ROM</li>
<li>“chs=[interface_number.device_number]” to force device as a disk (using CHS)</li>
</ul>
</div>
<div class="section" id="some-terminology">
<h2>Some Terminology<a class="headerlink" href="#some-terminology" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>IDE</dt>
<dd>Integrated Drive Electronics, meaning that each drive has a built-in
controller, which is why an “IDE interface card” is not a “controller card”.</dd>
<dt>ATA</dt>
<dd><p class="first">AT (the old IBM 286 computer) Attachment Interface, a draft American
National Standard for connecting hard drives to PCs.  This is the official
name for “IDE”.</p>
<p class="last">The latest standards define some enhancements, known as the ATA-6 spec,
which grew out of vendor-specific “Enhanced IDE” (EIDE) implementations.</p>
</dd>
<dt>ATAPI</dt>
<dd>ATA Packet Interface, a new protocol for controlling the drives,
similar to SCSI protocols, created at the same time as the ATA2 standard.
ATAPI is currently used for controlling CDROM, TAPE and FLOPPY (ZIP or
LS120/240) devices, removable R/W cartridges, and for high capacity hard disk
drives.</dd>
</dl>
<p><a class="reference external" href="mailto:mlord&#37;&#52;&#48;pobox&#46;com">mlord<span>&#64;</span>pobox<span>&#46;</span>com</a></p>
<p>Wed Apr 17 22:52:44 CEST 2002 edited by Marcin Dalecki, the current
maintainer.</p>
<p>Wed Aug 20 22:31:29 CEST 2003 updated ide boot options to current ide.c
comments at 2.6.0-test4 time. Maciej Soltysiak &lt;<a class="reference external" href="mailto:solt&#37;&#52;&#48;dns&#46;toxicfilms&#46;tv">solt<span>&#64;</span>dns<span>&#46;</span>toxicfilms<span>&#46;</span>tv</a>&gt;</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>