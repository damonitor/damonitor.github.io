

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>16. Walkera WK-0701 transmitter &mdash; The Linux Kernel  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../',
              VERSION:'',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.8.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../admin-guide/mm/damon/index.html">Monitoring Data Accesses</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../vm/damon/index.html">DAMON: Data Access MONitor</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>16. Walkera WK-0701 transmitter</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/input/devices/walkera0701.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="walkera-wk-0701-transmitter">
<h1>16. Walkera WK-0701 transmitter<a class="headerlink" href="#walkera-wk-0701-transmitter" title="Permalink to this headline">¶</a></h1>
<p>Walkera WK-0701 transmitter is supplied with a ready to fly Walkera
helicopters such as HM36, HM37, HM60. The walkera0701 module enables to use
this transmitter as joystick</p>
<p>Devel homepage and download:
<a class="reference external" href="http://zub.fei.tuke.sk/walkera-wk0701/">http://zub.fei.tuke.sk/walkera-wk0701/</a></p>
<p>or use cogito:
cg-clone <a class="reference external" href="http://zub.fei.tuke.sk/GIT/walkera0701-joystick">http://zub.fei.tuke.sk/GIT/walkera0701-joystick</a></p>
<div class="section" id="connecting-to-pc">
<h2>16.1. Connecting to PC<a class="headerlink" href="#connecting-to-pc" title="Permalink to this headline">¶</a></h2>
<p>At back side of transmitter S-video connector can be found. Modulation
pulses from processor to HF part can be found at pin 2 of this connector,
pin 3 is GND. Between pin 3 and CPU 5k6 resistor can be found. To get
modulation pulses to PC, signal pulses must be amplified.</p>
<p>Cable: (walkera TX to parport)</p>
<p>Walkera WK-0701 TX S-VIDEO connector:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>(back side of TX)
    __   __              S-video:                                  canon25
   /  |_|  \             pin 2 (signal)              NPN           parport
  / O 4 3 O \            pin 3 (GND)        LED        ________________  10 ACK
 ( O 2   1 O )                                         | C
  \   ___   /      2 ________________________|\|_____|/
   | [___] |                                 |/|   B |\
    -------        3 __________________________________|________________ 25 GND
                                                         E
</pre></div>
</div>
<p>I use green LED and BC109 NPN transistor.</p>
</div>
<div class="section" id="software">
<h2>16.2. Software<a class="headerlink" href="#software" title="Permalink to this headline">¶</a></h2>
<p>Build kernel with walkera0701 module. Module walkera0701 need exclusive
access to parport, modules like lp must be unloaded before loading
walkera0701 module, check dmesg for error messages. Connect TX to PC by
cable and run jstest /dev/input/js0 to see values from TX. If no value can
be changed by TX “joystick”, check output from /proc/interrupts. Value for
(usually irq7) parport must increase if TX is on.</p>
</div>
<div class="section" id="technical-details">
<h2>16.3. Technical details<a class="headerlink" href="#technical-details" title="Permalink to this headline">¶</a></h2>
<p>Driver use interrupt from parport ACK input bit to measure pulse length
using hrtimers.</p>
<p>Frame format:
Based on walkera WK-0701 PCM Format description by Shaul Eizikovich.
(downloaded from <a class="reference external" href="http://www.smartpropoplus.com/Docs/Walkera_Wk-0701_PCM.pdf">http://www.smartpropoplus.com/Docs/Walkera_Wk-0701_PCM.pdf</a>)</p>
<div class="section" id="signal-pulses">
<h3>16.3.1. Signal pulses<a class="headerlink" href="#signal-pulses" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>                   (ANALOG)
    SYNC      BIN   OCT
  +---------+      +------+
  |         |      |      |
--+         +------+      +---
</pre></div>
</div>
</div>
<div class="section" id="frame">
<h3>16.3.2. Frame<a class="headerlink" href="#frame" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>SYNC , BIN1, OCT1, BIN2, OCT2 ... BIN24, OCT24, BIN25, next frame SYNC ..
</pre></div>
</div>
</div>
<div class="section" id="pulse-length">
<h3>16.3.3. pulse length<a class="headerlink" href="#pulse-length" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> Binary values:               Analog octal values:

 288 uS Binary 0              318 uS       000
 438 uS Binary 1              398 uS       001
                              478 uS       010
                              558 uS       011
                              638 uS       100
1306 uS SYNC                  718 uS       101
                              798 uS       110
                              878 uS       111
</pre></div>
</div>
<p>24 bin+oct values + 1 bin value = 24*4+1 bits  = 97 bits</p>
<p>(Warning, pulses on ACK are inverted by transistor, irq is raised up on sync
to bin change or octal value to bin change).</p>
</div>
<div class="section" id="binary-data-representations">
<h3>16.3.4. Binary data representations<a class="headerlink" href="#binary-data-representations" title="Permalink to this headline">¶</a></h3>
<p>One binary and octal value can be grouped to nibble. 24 nibbles + one binary
values can be sampled between sync pulses.</p>
<p>Values for first four channels (analog joystick values) can be found in
first 10 nibbles. Analog value is represented by one sign bit and 9 bit
absolute binary value. (10 bits per channel). Next nibble is checksum for
first ten nibbles.</p>
<p>Next nibbles 12 .. 21 represents four channels (not all channels can be
directly controlled from TX). Binary representations are the same as in first
four channels. In nibbles 22 and 23 is a special magic number. Nibble 24 is
checksum for nibbles 12..23.</p>
<p>After last octal value for nibble 24 and next sync pulse one additional
binary value can be sampled. This bit and magic number is not used in
software driver. Some details about this magic numbers can be found in
Walkera_Wk-0701_PCM.pdf.</p>
</div>
<div class="section" id="checksum-calculation">
<h3>16.3.5. Checksum calculation<a class="headerlink" href="#checksum-calculation" title="Permalink to this headline">¶</a></h3>
<p>Summary of octal values in nibbles must be same as octal value in checksum
nibble (only first 3 bits are used). Binary value for checksum nibble is
calculated by sum of binary values in checked nibbles + sum of octal values
in checked nibbles divided by 8. Only bit 0 of this sum is used.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>