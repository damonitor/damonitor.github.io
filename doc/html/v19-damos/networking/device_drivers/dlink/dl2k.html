

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>D-Link DL2000-based Gigabit Ethernet Adapter Installation &mdash; The Linux Kernel  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../../',
              VERSION:'',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.8.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../admin-guide/mm/damon/index.html">Monitoring Data Accesses</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../vm/damon/index.html">DAMON: Data Access MONitor</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
      <li>D-Link DL2000-based Gigabit Ethernet Adapter Installation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/networking/device_drivers/dlink/dl2k.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="d-link-dl2000-based-gigabit-ethernet-adapter-installation">
<h1>D-Link DL2000-based Gigabit Ethernet Adapter Installation<a class="headerlink" href="#d-link-dl2000-based-gigabit-ethernet-adapter-installation" title="Permalink to this headline">¶</a></h1>
<p>May 23, 2002</p>
<div class="section" id="compatibility-list">
<h2>Compatibility List<a class="headerlink" href="#compatibility-list" title="Permalink to this headline">¶</a></h2>
<p>Adapter Support:</p>
<ul class="simple">
<li>D-Link DGE-550T Gigabit Ethernet Adapter.</li>
<li>D-Link DGE-550SX Gigabit Ethernet Adapter.</li>
<li>D-Link DL2000-based Gigabit Ethernet Adapter.</li>
</ul>
<p>The driver support Linux kernel 2.4.7 later. We had tested it
on the environments below.</p>
<blockquote>
<div>. Red Hat v6.2 (update kernel to 2.4.7)
. Red Hat v7.0 (update kernel to 2.4.7)
. Red Hat v7.1 (kernel 2.4.7)
. Red Hat v7.2 (kernel 2.4.7-10)</div></blockquote>
</div>
<div class="section" id="quick-install">
<h2>Quick Install<a class="headerlink" href="#quick-install" title="Permalink to this headline">¶</a></h2>
<p>Install linux driver as following command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>1. make all
2. insmod dl2k.ko
3. ifconfig eth0 up 10.xxx.xxx.xxx netmask 255.0.0.0
                    ^^^^^^^^^^^^^^^\            ^^^^^^^^\
                                    IP                   NETMASK
</pre></div>
</div>
<p>Now eth0 should active, you can test it by “ping” or get more information by
“ifconfig”. If tested ok, continue the next step.</p>
<ol class="arabic" start="4">
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">cp</span> <span class="pre">dl2k.ko</span> <span class="pre">/lib/modules/`uname</span> <span class="pre">-r`/kernel/drivers/net</span></code></p>
</li>
<li><p class="first">Add the following line to /etc/modprobe.d/dl2k.conf:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>alias eth0 dl2k
</pre></div>
</div>
</li>
<li><p class="first">Run <code class="docutils literal notranslate"><span class="pre">depmod</span></code> to updated module indexes.</p>
</li>
<li><p class="first">Run <code class="docutils literal notranslate"><span class="pre">netconfig</span></code> or <code class="docutils literal notranslate"><span class="pre">netconf</span></code> to create configuration script ifcfg-eth0
located at /etc/sysconfig/network-scripts or create it manually.</p>
<p>[see - Configuration Script Sample]</p>
</li>
<li><p class="first">Driver will automatically load and configure at next boot time.</p>
</li>
</ol>
</div>
<div class="section" id="compiling-the-driver">
<h2>Compiling the Driver<a class="headerlink" href="#compiling-the-driver" title="Permalink to this headline">¶</a></h2>
<p>In Linux, NIC drivers are most commonly configured as loadable modules.
The approach of building a monolithic kernel has become obsolete. The driver
can be compiled as part of a monolithic kernel, but is strongly discouraged.
The remainder of this section assumes the driver is built as a loadable module.
In the Linux environment, it is a good idea to rebuild the driver from the
source instead of relying on a precompiled version. This approach provides
better reliability since a precompiled driver might depend on libraries or
kernel features that are not present in a given Linux installation.</p>
<p>The 3 files necessary to build Linux device driver are dl2k.c, dl2k.h and
Makefile. To compile, the Linux installation must include the gcc compiler,
the kernel source, and the kernel headers. The Linux driver supports Linux
Kernels 2.4.7. Copy the files to a directory and enter the following command
to compile and link the driver:</p>
<div class="section" id="cd-rom-drive">
<h3>CD-ROM drive<a class="headerlink" href="#cd-rom-drive" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[root@XXX /] mkdir cdrom
[root@XXX /] mount -r -t iso9660 -o conv=auto /dev/cdrom /cdrom
[root@XXX /] cd root
[root@XXX /root] mkdir dl2k
[root@XXX /root] cd dl2k
[root@XXX dl2k] cp /cdrom/linux/dl2k.tgz /root/dl2k
[root@XXX dl2k] tar xfvz dl2k.tgz
[root@XXX dl2k] make all
</pre></div>
</div>
</div>
<div class="section" id="floppy-disc-drive">
<h3>Floppy disc drive<a class="headerlink" href="#floppy-disc-drive" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[root@XXX /] cd root
[root@XXX /root] mkdir dl2k
[root@XXX /root] cd dl2k
[root@XXX dl2k] mcopy a:/linux/dl2k.tgz /root/dl2k
[root@XXX dl2k] tar xfvz dl2k.tgz
[root@XXX dl2k] make all
</pre></div>
</div>
</div>
</div>
<div class="section" id="installing-the-driver">
<h2>Installing the Driver<a class="headerlink" href="#installing-the-driver" title="Permalink to this headline">¶</a></h2>
<div class="section" id="manual-installation">
<h3>Manual Installation<a class="headerlink" href="#manual-installation" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Once the driver has been compiled, it must be loaded, enabled, and bound
to a protocol stack in order to establish network connectivity. To load a
module enter the command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>insmod dl2k.o
</pre></div>
</div>
<p>or:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>insmod dl2k.o &lt;optional parameter&gt;  ; add parameter
</pre></div>
</div>
</div></blockquote>
<hr class="docutils" />
<blockquote>
<div><p>example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> insmod dl2k.o media=100mbps_hd

or::

 insmod dl2k.o media=3

or::

 insmod dl2k.o media=3,2     ; for 2 cards
</pre></div>
</div>
</div></blockquote>
<hr class="docutils" />
<blockquote>
<div><p>Please reference the list of the command line parameters supported by
the Linux device driver below.</p>
<p>The insmod command only loads the driver and gives it a name of the form
eth0, eth1, etc. To bring the NIC into an operational state,
it is necessary to issue the following command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ifconfig eth0 up
</pre></div>
</div>
<p>Finally, to bind the driver to the active protocol (e.g., TCP/IP with
Linux), enter the following command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ifup eth0
</pre></div>
</div>
<p>Note that this is meaningful only if the system can find a configuration
script that contains the necessary network information. A sample will be
given in the next paragraph.</p>
<p>The commands to unload a driver are as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ifdown eth0
ifconfig eth0 down
rmmod dl2k.o
</pre></div>
</div>
<p>The following are the commands to list the currently loaded modules and
to see the current network configuration:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>lsmod
ifconfig
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="automated-installation">
<h3>Automated Installation<a class="headerlink" href="#automated-installation" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>This section describes how to install the driver such that it is
automatically loaded and configured at boot time. The following description
is based on a Red Hat 6.0/7.0 distribution, but it can easily be ported to
other distributions as well.</div></blockquote>
</div>
<div class="section" id="red-hat-v6-x-v7-x">
<h3>Red Hat v6.x/v7.x<a class="headerlink" href="#red-hat-v6-x-v7-x" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ol class="arabic">
<li><p class="first">Copy dl2k.o to the network modules directory, typically
/lib/modules/2.x.x-xx/net or /lib/modules/2.x.x/kernel/drivers/net.</p>
</li>
<li><p class="first">Locate the boot module configuration file, most commonly in the
/etc/modprobe.d/ directory. Add the following lines:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>alias ethx dl2k
options dl2k &lt;optional parameters&gt;
</pre></div>
</div>
<p>where ethx will be eth0 if the NIC is the only ethernet adapter, eth1 if
one other ethernet adapter is installed, etc. Refer to the table in the
previous section for the list of optional parameters.</p>
</li>
<li><p class="first">Locate the network configuration scripts, normally the
/etc/sysconfig/network-scripts directory, and create a configuration
script named ifcfg-ethx that contains network information.</p>
</li>
<li><p class="first">Note that for most Linux distributions, Red Hat included, a configuration
utility with a graphical user interface is provided to perform steps 2
and 3 above.</p>
</li>
</ol>
</div></blockquote>
</div>
</div>
<div class="section" id="parameter-description">
<h2>Parameter Description<a class="headerlink" href="#parameter-description" title="Permalink to this headline">¶</a></h2>
<p>You can install this driver without any additional parameter. However, if you
are going to have extensive functions then it is necessary to set extra
parameter. Below is a list of the command line parameters supported by the
Linux device
driver.</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>mtu=packet_size</td>
<td>Specifies the maximum packet size. default
is 1500.</td>
</tr>
<tr class="row-even"><td>media=media_type</td>
<td><p class="first">Specifies the media type the NIC operates at.
autosense     Autosensing active media.</p>
<table border="1" class="docutils">
<colgroup>
<col width="31%" />
<col width="69%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>10mbps_hd</td>
<td>10Mbps half duplex.</td>
</tr>
<tr class="row-even"><td>10mbps_fd</td>
<td>10Mbps full duplex.</td>
</tr>
<tr class="row-odd"><td>100mbps_hd</td>
<td>100Mbps half duplex.</td>
</tr>
<tr class="row-even"><td>100mbps_fd</td>
<td>100Mbps full duplex.</td>
</tr>
<tr class="row-odd"><td>1000mbps_fd</td>
<td>1000Mbps full duplex.</td>
</tr>
<tr class="row-even"><td>1000mbps_hd</td>
<td>1000Mbps half duplex.</td>
</tr>
<tr class="row-odd"><td>0</td>
<td>Autosensing active media.</td>
</tr>
<tr class="row-even"><td>1</td>
<td>10Mbps half duplex.</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>10Mbps full duplex.</td>
</tr>
<tr class="row-even"><td>3</td>
<td>100Mbps half duplex.</td>
</tr>
<tr class="row-odd"><td>4</td>
<td>100Mbps full duplex.</td>
</tr>
<tr class="row-even"><td>5</td>
<td>1000Mbps half duplex.</td>
</tr>
<tr class="row-odd"><td>6</td>
<td>1000Mbps full duplex.</td>
</tr>
</tbody>
</table>
<p class="last">By default, the NIC operates at autosense.
1000mbps_fd and 1000mbps_hd types are only
available for fiber adapter.</p>
</td>
</tr>
<tr class="row-even"><td>vlan=n</td>
<td>Specifies the VLAN ID. If vlan=0, the
Virtual Local Area Network (VLAN) function is
disable.</td>
</tr>
<tr class="row-odd"><td>jumbo=[0|1]</td>
<td>Specifies the jumbo frame support. If jumbo=1,
the NIC accept jumbo frames. By default, this
function is disabled.
Jumbo frame usually improve the performance
int gigabit.
This feature need jumbo frame compatible
remote.</td>
</tr>
<tr class="row-even"><td>rx_coalesce=m</td>
<td>Number of rx frame handled each interrupt.</td>
</tr>
<tr class="row-odd"><td>rx_timeout=n</td>
<td><p class="first">Rx DMA wait time for an interrupt.
If set rx_coalesce &gt; 0, hardware only assert
an interrupt for m frames. Hardware won’t
assert rx interrupt until m frames received or
reach timeout of n * 640 nano seconds.
Set proper rx_coalesce and rx_timeout can
reduce congestion collapse and overload which
has been a bottleneck for high speed network.</p>
<p class="last">For example, rx_coalesce=10 rx_timeout=800.
that is, hardware assert only 1 interrupt
for 10 frames received or timeout of 512 us.</p>
</td>
</tr>
<tr class="row-even"><td>tx_coalesce=n</td>
<td>Number of tx frame handled each interrupt.
Set n &gt; 1 can reduce the interrupts
congestion usually lower performance of
high speed network card. Default is 16.</td>
</tr>
<tr class="row-odd"><td>tx_flow=[1|0]</td>
<td>Specifies the Tx flow control. If tx_flow=0,
the Tx flow control disable else driver
autodetect.</td>
</tr>
<tr class="row-even"><td>rx_flow=[1|0]</td>
<td>Specifies the Rx flow control. If rx_flow=0,
the Rx flow control enable else driver
autodetect.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="configuration-script-sample">
<h2>Configuration Script Sample<a class="headerlink" href="#configuration-script-sample" title="Permalink to this headline">¶</a></h2>
<p>Here is a sample of a simple configuration script:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>DEVICE=eth0
USERCTL=no
ONBOOT=yes
POOTPROTO=none
BROADCAST=207.200.5.255
NETWORK=207.200.5.0
NETMASK=255.255.255.0
IPADDR=207.200.5.2
</pre></div>
</div>
</div>
<div class="section" id="troubleshooting">
<h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this headline">¶</a></h2>
<p>Q1. Source files contain ^ M behind every line.</p>
<blockquote>
<div><p>Make sure all files are Unix file format (no LF). Try the following
shell command to convert files:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>cat dl2k.c | col -b &gt; dl2k.tmp
mv dl2k.tmp dl2k.c
</pre></div>
</div>
<p>OR:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>cat dl2k.c | tr -d &quot;\r&quot; &gt; dl2k.tmp
mv dl2k.tmp dl2k.c
</pre></div>
</div>
</div></blockquote>
<p>Q2: Could not find header files (<code class="docutils literal notranslate"><span class="pre">*.h</span></code>)?</p>
<blockquote>
<div><p>To compile the driver, you need kernel header files. After
installing the kernel source, the header files are usually located in
/usr/src/linux/include, which is the default include directory configured
in Makefile. For some distributions, there is a copy of header files in
/usr/src/include/linux and /usr/src/include/asm, that you can change the
INCLUDEDIR in Makefile to /usr/include without installing kernel source.</p>
<p>Note that RH 7.0 didn’t provide correct header files in /usr/include,
including those files will make a wrong version driver.</p>
</div></blockquote>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>