

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>RapidIO subsystem Channelized Messaging character device driver (rio_cm.c) &mdash; The Linux Kernel  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../',
              VERSION:'',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.6.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../admin-guide/mm/damon/index.html">DAMON: Data Access MONitor</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>RapidIO subsystem Channelized Messaging character device driver (rio_cm.c)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/driver-api/rapidio/rio_cm.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="rapidio-subsystem-channelized-messaging-character-device-driver-rio-cm-c">
<h1>RapidIO subsystem Channelized Messaging character device driver (rio_cm.c)<a class="headerlink" href="#rapidio-subsystem-channelized-messaging-character-device-driver-rio-cm-c" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>1. Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>This device driver is the result of collaboration within the RapidIO.org
Software Task Group (STG) between Texas Instruments, Prodrive Technologies,
Nokia Networks, BAE and IDT.  Additional input was received from other members
of RapidIO.org.</p>
<p>The objective was to create a character mode driver interface which exposes
messaging capabilities of RapidIO endpoint devices (mports) directly
to applications, in a manner that allows the numerous and varied RapidIO
implementations to interoperate.</p>
<p>This driver (RIO_CM) provides to user-space applications shared access to
RapidIO mailbox messaging resources.</p>
<p>RapidIO specification (Part 2) defines that endpoint devices may have up to four
messaging mailboxes in case of multi-packet message (up to 4KB) and
up to 64 mailboxes if single-packet messages (up to 256 B) are used. In addition
to protocol definition limitations, a particular hardware implementation can
have reduced number of messaging mailboxes.  RapidIO aware applications must
therefore share the messaging resources of a RapidIO endpoint.</p>
<p>Main purpose of this device driver is to provide RapidIO mailbox messaging
capability to large number of user-space processes by introducing socket-like
operations using a single messaging mailbox.  This allows applications to
use the limited RapidIO messaging hardware resources efficiently.</p>
<p>Most of device driver’s operations are supported through ‘ioctl’ system calls.</p>
<p>When loaded this device driver creates a single file system node named rio_cm
in /dev directory common for all registered RapidIO mport devices.</p>
<p>Following ioctl commands are available to user-space applications:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>RIO_CM_MPORT_GET_LIST:</dt>
<dd>Returns to caller list of local mport devices that
support messaging operations (number of entries up to RIO_MAX_MPORTS).
Each list entry is combination of mport’s index in the system and RapidIO
destination ID assigned to the port.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>RIO_CM_EP_GET_LIST_SIZE:</dt>
<dd>Returns number of messaging capable remote endpoints
in a RapidIO network associated with the specified mport device.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>RIO_CM_EP_GET_LIST:</dt>
<dd>Returns list of RapidIO destination IDs for messaging
capable remote endpoints (peers) available in a RapidIO network associated
with the specified mport device.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>RIO_CM_CHAN_CREATE:</dt>
<dd>Creates RapidIO message exchange channel data structure
with channel ID assigned automatically or as requested by a caller.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>RIO_CM_CHAN_BIND:</dt>
<dd>Binds the specified channel data structure to the specified
mport device.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>RIO_CM_CHAN_LISTEN:</dt>
<dd>Enables listening for connection requests on the specified
channel.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>RIO_CM_CHAN_ACCEPT:</dt>
<dd>Accepts a connection request from peer on the specified
channel. If wait timeout for this request is specified by a caller it is
a blocking call. If timeout set to 0 this is non-blocking call - ioctl
handler checks for a pending connection request and if one is not available
exits with -EGAIN error status immediately.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>RIO_CM_CHAN_CONNECT:</dt>
<dd>Sends a connection request to a remote peer/channel.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>RIO_CM_CHAN_SEND:</dt>
<dd>Sends a data message through the specified channel.
The handler for this request assumes that message buffer specified by
a caller includes the reserved space for a packet header required by
this driver.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>RIO_CM_CHAN_RECEIVE:</dt>
<dd>Receives a data message through a connected channel.
If the channel does not have an incoming message ready to return this ioctl
handler will wait for new message until timeout specified by a caller
expires. If timeout value is set to 0, ioctl handler uses a default value
defined by MAX_SCHEDULE_TIMEOUT.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>RIO_CM_CHAN_CLOSE:</dt>
<dd>Closes a specified channel and frees associated buffers.
If the specified channel is in the CONNECTED state, sends close notification
to the remote peer.</dd>
</dl>
</li>
</ul>
<p>The ioctl command codes and corresponding data structures intended for use by
user-space applications are defined in ‘include/uapi/linux/rio_cm_cdev.h’.</p>
</div>
<div class="section" id="hardware-compatibility">
<h2>2. Hardware Compatibility<a class="headerlink" href="#hardware-compatibility" title="Permalink to this headline">¶</a></h2>
<p>This device driver uses standard interfaces defined by kernel RapidIO subsystem
and therefore it can be used with any mport device driver registered by RapidIO
subsystem with limitations set by available mport HW implementation of messaging
mailboxes.</p>
</div>
<div class="section" id="module-parameters">
<h2>3. Module parameters<a class="headerlink" href="#module-parameters" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><dl class="first docutils">
<dt>‘dbg_level’</dt>
<dd><ul class="first last">
<li>This parameter allows to control amount of debug information
generated by this device driver. This parameter is formed by set of
bit masks that correspond to the specific functional block.
For mask definitions see ‘drivers/rapidio/devices/rio_cm.c’
This parameter can be changed dynamically.
Use CONFIG_RAPIDIO_DEBUG=y to enable debug output at the top level.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>‘cmbox’</dt>
<dd><ul class="first last">
<li>Number of RapidIO mailbox to use (default value is 1).
This parameter allows to set messaging mailbox number that will be used
within entire RapidIO network. It can be used when default mailbox is
used by other device drivers or is not supported by some nodes in the
RapidIO network.</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>‘chstart’</dt>
<dd><ul class="first last">
<li>Start channel number for dynamic assignment. Default value - 256.
Allows to exclude channel numbers below this parameter from dynamic
allocation to avoid conflicts with software components that use
reserved predefined channel numbers.</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="known-problems">
<h2>4. Known problems<a class="headerlink" href="#known-problems" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>None.</div></blockquote>
</div>
<div class="section" id="user-space-applications-and-api-library">
<h2>5. User-space Applications and API Library<a class="headerlink" href="#user-space-applications-and-api-library" title="Permalink to this headline">¶</a></h2>
<p>Messaging API library and applications that use this device driver are available
from RapidIO.org.</p>
</div>
<div class="section" id="todo-list">
<h2>6. TODO List<a class="headerlink" href="#todo-list" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Add support for system notification messages (reserved channel 0).</li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>