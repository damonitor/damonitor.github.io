

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Linux Security Module Development &mdash; The Linux Kernel  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.7.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/mm/damon/index.html">Monitoring Data Accesses</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../vm/damon/index.html">DAMON: Data Access MONitor</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Linux Security Module Development</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/security/lsm-development.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="linux-security-module-development">
<h1>Linux Security Module Development<a class="headerlink" href="#linux-security-module-development" title="Permalink to this headline">¶</a></h1>
<p>Based on <a class="reference external" href="https://lkml.org/lkml/2007/10/26/215">https://lkml.org/lkml/2007/10/26/215</a>,
a new LSM is accepted into the kernel when its intent (a description of
what it tries to protect against and in what cases one would expect to
use it) has been appropriately documented in <code class="docutils literal notranslate"><span class="pre">Documentation/admin-guide/LSM/</span></code>.
This allows an LSM’s code to be easily compared to its goals, and so
that end users and distros can make a more informed decision about which
LSMs suit their requirements.</p>
<p>For extensive documentation on the available LSM hook interfaces, please
see <code class="docutils literal notranslate"><span class="pre">include/linux/lsm_hooks.h</span></code> and associated structures:</p>
<dl class="type">
<dt id="c.security_list_options">
union <code class="descname">security_list_options</code><a class="headerlink" href="#c.security_list_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Linux Security Module hook function list</p>
</dd></dl>

<p><strong>Definition</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>union security_list_options {
#define LSM_HOOK(RET, DEFAULT, NAME, ...) RET (*NAME)(__VA_ARGS__);
  ;
#include &quot;lsm_hook_defs.h&quot;;
#undef LSM_HOOK;
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<p><strong>Description</strong></p>
<p>Security hooks for program execution operations.</p>
<dl class="docutils">
<dt>Security hooks for mount using fs_context.</dt>
<dd>[See also Documentation/filesystems/mount_api.txt]</dd>
</dl>
<p>Security hooks for filesystem operations.</p>
<p>Security hooks for inode operations.</p>
<p>Security hooks for kernfs node operations</p>
<blockquote>
<div><strong>kn_dir</strong> the parent kernfs node
<strong>kn</strong> the new child kernfs node</div></blockquote>
<p>Security hooks for file operations</p>
<p>Security hooks for task operations.</p>
<p>Security hooks for Netlink messaging.</p>
<p>Security hooks for Unix domain networking.</p>
<p>The <strong>unix_stream_connect</strong> and <strong>unix_may_send</strong> hooks were necessary because
Linux provides an alternative to the conventional file name space for Unix
domain sockets.  Whereas binding and connecting to sockets in the file name
space is mediated by the typical file permissions (and caught by the mknod
and permission hooks in inode_security_ops), binding and connecting to
sockets in the abstract name space is completely unmediated.  Sufficient
control of Unix domain sockets in the abstract name space isn’t possible
using only the socket layer hooks, since we need to know the actual target
socket, which is not looked up until we are inside the af_unix code.</p>
<p>Security hooks for socket operations.</p>
<p>Security hooks for SCTP</p>
<p>Security hooks for Infiniband</p>
<p>Security hooks for XFRM operations.</p>
<p>Security hooks affecting all Key Management operations</p>
<p>Security hooks affecting all System V IPC operations.</p>
<p>Security hooks for individual messages held in System V IPC message queues</p>
<p>Security hooks for System V IPC Message Queues</p>
<p>Security hooks for System V Shared Memory Segments</p>
<p>Security hooks for System V Semaphores</p>
<p>Security hooks for Audit</p>
<p>Security hooks for using the eBPF maps and programs functionalities through
eBPF syscalls.</p>
<p>Security hooks for perf events</p>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>