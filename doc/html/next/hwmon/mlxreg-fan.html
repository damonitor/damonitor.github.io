

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Kernel driver mlxreg-fan &mdash; The Linux Kernel  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.7.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/mm/damon/index.html">Monitoring Data Accesses</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../vm/damon/index.html">DAMON: Data Access MONitor</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Kernel driver mlxreg-fan</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/hwmon/mlxreg-fan.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="kernel-driver-mlxreg-fan">
<h1>Kernel driver mlxreg-fan<a class="headerlink" href="#kernel-driver-mlxreg-fan" title="Permalink to this headline">¶</a></h1>
<p>Provides FAN control for the next Mellanox systems:</p>
<ul class="simple">
<li>QMB700, equipped with 40x200GbE InfiniBand ports;</li>
<li>MSN3700, equipped with 32x200GbE or 16x400GbE Ethernet ports;</li>
<li>MSN3410, equipped with 6x400GbE plus 48x50GbE Ethernet ports;</li>
<li>MSN3800, equipped with 64x1000GbE Ethernet ports;</li>
</ul>
<p>Author: Vadim Pasternak &lt;<a class="reference external" href="mailto:vadimp&#37;&#52;&#48;mellanox&#46;com">vadimp<span>&#64;</span>mellanox<span>&#46;</span>com</a>&gt;</p>
<p>These are the Top of the Rack systems, equipped with Mellanox switch
board with Mellanox Quantum or Spectrume-2 devices.
FAN controller is implemented by the programmable device logic.</p>
<p>The default registers offsets set within the programmable device is as
following:</p>
<table border="1" class="docutils">
<colgroup>
<col width="85%" />
<col width="15%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>pwm1</td>
<td>0xe3</td>
</tr>
<tr class="row-even"><td>fan1 (tacho1)</td>
<td>0xe4</td>
</tr>
<tr class="row-odd"><td>fan2 (tacho2)</td>
<td>0xe5</td>
</tr>
<tr class="row-even"><td>fan3 (tacho3)</td>
<td>0xe6</td>
</tr>
<tr class="row-odd"><td>fan4 (tacho4)</td>
<td>0xe7</td>
</tr>
<tr class="row-even"><td>fan5 (tacho5)</td>
<td>0xe8</td>
</tr>
<tr class="row-odd"><td>fan6 (tacho6)</td>
<td>0xe9</td>
</tr>
<tr class="row-even"><td>fan7 (tacho7)</td>
<td>0xea</td>
</tr>
<tr class="row-odd"><td>fan8 (tacho8)</td>
<td>0xeb</td>
</tr>
<tr class="row-even"><td>fan9 (tacho9)</td>
<td>0xec</td>
</tr>
<tr class="row-odd"><td>fan10 (tacho10)</td>
<td>0xed</td>
</tr>
<tr class="row-even"><td>fan11 (tacho11)</td>
<td>0xee</td>
</tr>
<tr class="row-odd"><td>fan12 (tacho12)</td>
<td>0xef</td>
</tr>
</tbody>
</table>
<p>This setup can be re-programmed with other registers.</p>
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>The driver implements a simple interface for driving a fan connected to
a PWM output and tachometer inputs.
This driver obtains PWM and tachometers registers location according to
the system configuration and creates FAN/PWM hwmon objects and a cooling
device. PWM and tachometers are sensed through the on-board programmable
device, which exports its register map. This device could be attached to
any bus type, for which register mapping is supported.
Single instance is created with one PWM control, up to 12 tachometers and
one cooling device. It could be as many instances as programmable device
supports.
The driver exposes the fan to the user space through the hwmon’s and
thermal’s sysfs interfaces.</p>
</div>
<div class="section" id="sys-files-in-hwmon-subsystem">
<h2>/sys files in hwmon subsystem<a class="headerlink" href="#sys-files-in-hwmon-subsystem" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="3%" />
<col width="73%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>fan[1-12]_fault</td>
<td>RO</td>
<td>files for tachometers TACH1-TACH12 fault indication</td>
</tr>
<tr class="row-even"><td>fan[1-12]_input</td>
<td>RO</td>
<td>files for tachometers TACH1-TACH12 input (in RPM)</td>
</tr>
<tr class="row-odd"><td>pwm1</td>
<td>RW</td>
<td>file for fan[1-12] target duty cycle (0..255)</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="sys-files-in-thermal-subsystem">
<h2>/sys files in thermal subsystem<a class="headerlink" href="#sys-files-in-thermal-subsystem" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="3%" />
<col width="73%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>cur_state</td>
<td>RW</td>
<td>file for current cooling state of the cooling device
(0..max_state)</td>
</tr>
<tr class="row-even"><td>max_state</td>
<td>RO</td>
<td>file for maximum cooling state of the cooling device</td>
</tr>
</tbody>
</table>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>