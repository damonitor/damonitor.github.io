

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Kernel driver adm9240 &mdash; The Linux Kernel  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.6.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/mm/damon/index.html">DAMON: Data Access MONitor</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Kernel driver adm9240</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/hwmon/adm9240.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="kernel-driver-adm9240">
<h1>Kernel driver adm9240<a class="headerlink" href="#kernel-driver-adm9240" title="Permalink to this headline">¶</a></h1>
<p>Supported chips:</p>
<blockquote>
<div><ul>
<li><p class="first">Analog Devices ADM9240</p>
<p>Prefix: ‘adm9240’</p>
<p>Addresses scanned: I2C 0x2c - 0x2f</p>
<p>Datasheet: Publicly available at the Analog Devices website</p>
<blockquote>
<div><p><a class="reference external" href="http://www.analog.com/UploadedFiles/Data_Sheets/79857778ADM9240_0.pdf">http://www.analog.com/UploadedFiles/Data_Sheets/79857778ADM9240_0.pdf</a></p>
</div></blockquote>
</li>
<li><p class="first">Dallas Semiconductor DS1780</p>
<p>Prefix: ‘ds1780’</p>
<p>Addresses scanned: I2C 0x2c - 0x2f</p>
<p>Datasheet: Publicly available at the Dallas Semiconductor (Maxim) website</p>
<blockquote>
<div><p><a class="reference external" href="http://pdfserv.maxim-ic.com/en/ds/DS1780.pdf">http://pdfserv.maxim-ic.com/en/ds/DS1780.pdf</a></p>
</div></blockquote>
</li>
<li><p class="first">National Semiconductor LM81</p>
<p>Prefix: ‘lm81’</p>
<p>Addresses scanned: I2C 0x2c - 0x2f</p>
<p>Datasheet: Publicly available at the National Semiconductor website</p>
<blockquote>
<div><p><a class="reference external" href="http://www.national.com/ds.cgi/LM/LM81.pdf">http://www.national.com/ds.cgi/LM/LM81.pdf</a></p>
</div></blockquote>
</li>
</ul>
</div></blockquote>
<dl class="docutils">
<dt>Authors:</dt>
<dd><ul class="first last simple">
<li>Frodo Looijaard &lt;<a class="reference external" href="mailto:frodol&#37;&#52;&#48;dds&#46;nl">frodol<span>&#64;</span>dds<span>&#46;</span>nl</a>&gt;,</li>
<li>Philip Edelbrock &lt;<a class="reference external" href="mailto:phil&#37;&#52;&#48;netroedge&#46;com">phil<span>&#64;</span>netroedge<span>&#46;</span>com</a>&gt;,</li>
<li>Michiel Rook &lt;<a class="reference external" href="mailto:michiel&#37;&#52;&#48;grendelproject&#46;nl">michiel<span>&#64;</span>grendelproject<span>&#46;</span>nl</a>&gt;,</li>
<li>Grant Coady &lt;<a class="reference external" href="mailto:gcoady&#46;lk&#37;&#52;&#48;gmail&#46;com">gcoady<span>&#46;</span>lk<span>&#64;</span>gmail<span>&#46;</span>com</a>&gt; with guidance
from Jean Delvare &lt;<a class="reference external" href="mailto:jdelvare&#37;&#52;&#48;suse&#46;de">jdelvare<span>&#64;</span>suse<span>&#46;</span>de</a>&gt;</li>
</ul>
</dd>
</dl>
<div class="section" id="interface">
<h2>Interface<a class="headerlink" href="#interface" title="Permalink to this headline">¶</a></h2>
<p>The I2C addresses listed above assume BIOS has not changed the
chip MSB 5-bit address. Each chip reports a unique manufacturer
identification code as well as the chip revision/stepping level.</p>
</div>
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>[From ADM9240] The ADM9240 is a complete system hardware monitor for
microprocessor-based systems, providing measurement and limit comparison
of up to four power supplies and two processor core voltages, plus
temperature, two fan speeds and chassis intrusion. Measured values can
be read out via an I2C-compatible serial System Management Bus, and values
for limit comparisons can be programmed in over the same serial bus. The
high speed successive approximation ADC allows frequent sampling of all
analog channels to ensure a fast interrupt response to any out-of-limit
measurement.</p>
<p>The ADM9240, DS1780 and LM81 are register compatible, the following
details are common to the three chips. Chip differences are described
after this section.</p>
</div>
<div class="section" id="measurements">
<h2>Measurements<a class="headerlink" href="#measurements" title="Permalink to this headline">¶</a></h2>
<p>The measurement cycle</p>
<p>The adm9240 driver will take a measurement reading no faster than once
each two seconds. User-space may read sysfs interface faster than the
measurement update rate and will receive cached data from the most
recent measurement.</p>
<p>ADM9240 has a very fast 320us temperature and voltage measurement cycle
with independent fan speed measurement cycles counting alternating rising
edges of the fan tacho inputs.</p>
<p>DS1780 measurement cycle is about once per second including fan speed.</p>
<p>LM81 measurement cycle is about once per 400ms including fan speed.
The LM81 12-bit extended temperature measurement mode is not supported.</p>
</div>
<div class="section" id="temperature">
<h2>Temperature<a class="headerlink" href="#temperature" title="Permalink to this headline">¶</a></h2>
<p>On chip temperature is reported as degrees Celsius as 9-bit signed data
with resolution of 0.5 degrees Celsius. High and low temperature limits
are 8-bit signed data with resolution of one degree Celsius.</p>
<p>Temperature alarm is asserted once the temperature exceeds the high limit,
and is cleared when the temperature falls below the temp1_max_hyst value.</p>
</div>
<div class="section" id="fan-speed">
<h2>Fan Speed<a class="headerlink" href="#fan-speed" title="Permalink to this headline">¶</a></h2>
<p>Two fan tacho inputs are provided, the ADM9240 gates an internal 22.5kHz
clock via a divider to an 8-bit counter. Fan speed (rpm) is calculated by:</p>
<p>rpm = (22500 * 60) / (count * divider)</p>
<p>Automatic fan clock divider</p>
<blockquote>
<div><ul class="simple">
<li>User sets 0 to fan_min limit<ul>
<li>low speed alarm is disabled</li>
<li>fan clock divider not changed</li>
<li>auto fan clock adjuster enabled for valid fan speed reading</li>
</ul>
</li>
<li>User sets fan_min limit too low<ul>
<li>low speed alarm is enabled</li>
<li>fan clock divider set to max</li>
<li>fan_min set to register value 254 which corresponds
to 664 rpm on adm9240</li>
<li>low speed alarm will be asserted if fan speed is
less than minimum measurable speed</li>
<li>auto fan clock adjuster disabled</li>
</ul>
</li>
<li>User sets reasonable fan speed<ul>
<li>low speed alarm is enabled</li>
<li>fan clock divider set to suit fan_min</li>
<li>auto fan clock adjuster enabled: adjusts fan_min</li>
</ul>
</li>
<li>User sets unreasonably high low fan speed limit<ul>
<li>resolution of the low speed limit may be reduced</li>
<li>alarm will be asserted</li>
<li>auto fan clock adjuster enabled: adjusts fan_min</li>
</ul>
</li>
<li>fan speed may be displayed as zero until the auto fan clock divider
adjuster brings fan speed clock divider back into chip measurement
range, this will occur within a few measurement cycles.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="analog-output">
<h2>Analog Output<a class="headerlink" href="#analog-output" title="Permalink to this headline">¶</a></h2>
<p>An analog output provides a 0 to 1.25 volt signal intended for an external
fan speed amplifier circuit. The analog output is set to maximum value on
power up or reset. This doesn’t do much on the test Intel SE440BX-2.</p>
<p>Voltage Monitor</p>
<hr class="docutils" />
<p>Voltage (IN) measurement is internally scaled:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="25%" />
<col width="25%" />
<col width="20%" />
<col width="23%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">nr</th>
<th class="head">label</th>
<th class="head"><dl class="first last docutils">
<dt>nominal</dt>
<dd>mV</dd>
</dl>
</th>
<th class="head"><dl class="first last docutils">
<dt>maximum</dt>
<dd>mV</dd>
</dl>
</th>
<th class="head"><dl class="first last docutils">
<dt>resolution</dt>
<dd>mV</dd>
</dl>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>+2.5V</td>
<td>2500</td>
<td>3320</td>
<td>13.0</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>Vccp1</td>
<td>2700</td>
<td>3600</td>
<td>14.1</td>
</tr>
<tr class="row-even"><td>2</td>
<td>+3.3V</td>
<td>3300</td>
<td>4380</td>
<td>17.2</td>
</tr>
<tr class="row-odd"><td>3</td>
<td>+5V</td>
<td>5000</td>
<td>6640</td>
<td>26.0</td>
</tr>
<tr class="row-even"><td>4</td>
<td>+12V</td>
<td>12000</td>
<td>15940</td>
<td>62.5</td>
</tr>
<tr class="row-odd"><td>5</td>
<td>Vccp2</td>
<td>2700</td>
<td>3600</td>
<td>14.1</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>The reading is an unsigned 8-bit value, nominal voltage measurement is
represented by a reading of 192, being 3/4 of the measurement range.</p>
<p>An alarm is asserted for any voltage going below or above the set limits.</p>
<p>The driver reports and accepts voltage limits scaled to the above table.</p>
</div>
<div class="section" id="vid-monitor">
<h2>VID Monitor<a class="headerlink" href="#vid-monitor" title="Permalink to this headline">¶</a></h2>
<p>The chip has five inputs to read the 5-bit VID and reports the mV value
based on detected CPU type.</p>
</div>
<div class="section" id="chassis-intrusion">
<h2>Chassis Intrusion<a class="headerlink" href="#chassis-intrusion" title="Permalink to this headline">¶</a></h2>
<p>An alarm is asserted when the CI pin goes active high. The ADM9240
Datasheet has an example of an external temperature sensor driving
this pin. On an Intel SE440BX-2 the Chassis Intrusion header is
connected to a normally open switch.</p>
<p>The ADM9240 provides an internal open drain on this line, and may output
a 20 ms active low pulse to reset an external Chassis Intrusion latch.</p>
<p>Clear the CI latch by writing value 0 to the sysfs intrusion0_alarm file.</p>
<p>Alarm flags reported as 16-bit word</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="31%" />
<col width="62%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">bit</th>
<th class="head">label</th>
<th class="head">comment</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>+2.5 V_Error</td>
<td>high or low limit exceeded</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>VCCP_Error</td>
<td>high or low limit exceeded</td>
</tr>
<tr class="row-even"><td>2</td>
<td>+3.3 V_Error</td>
<td>high or low limit exceeded</td>
</tr>
<tr class="row-odd"><td>3</td>
<td>+5 V_Error</td>
<td>high or low limit exceeded</td>
</tr>
<tr class="row-even"><td>4</td>
<td>Temp_Error</td>
<td>temperature error</td>
</tr>
<tr class="row-odd"><td>6</td>
<td>FAN1_Error</td>
<td>fan low limit exceeded</td>
</tr>
<tr class="row-even"><td>7</td>
<td>FAN2_Error</td>
<td>fan low limit exceeded</td>
</tr>
<tr class="row-odd"><td>8</td>
<td>+12 V_Error</td>
<td>high or low limit exceeded</td>
</tr>
<tr class="row-even"><td>9</td>
<td>VCCP2_Error</td>
<td>high or low limit exceeded</td>
</tr>
<tr class="row-odd"><td>12</td>
<td>Chassis_Error</td>
<td>CI pin went high</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Remaining bits are reserved and thus undefined. It is important to note
that alarm bits may be cleared on read, user-space may latch alarms and
provide the end-user with a method to clear alarm memory.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>