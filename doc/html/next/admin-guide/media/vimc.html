

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>6.22. The Virtual Media Controller Driver (vimc) &mdash; The Linux Kernel  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_rtd_colors.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.16.0-rc7-mm1-damon
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../mm/damon/index.html">Monitoring Data Accesses</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../vm/damon/index.html">DAMON: Data Access MONitor</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li><span class="section-number">6.22. </span>The Virtual Media Controller Driver (vimc)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/admin-guide/media/vimc.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="the-virtual-media-controller-driver-vimc">
<h1><span class="section-number">6.22. </span>The Virtual Media Controller Driver (vimc)<a class="headerlink" href="#the-virtual-media-controller-driver-vimc" title="Permalink to this headline">¶</a></h1>
<p>The vimc driver emulates complex video hardware using the V4L2 API and the Media
API. It has a capture device and three subdevices: sensor, debayer and scaler.</p>
<div class="section" id="topology">
<h2><span class="section-number">6.22.1. </span>Topology<a class="headerlink" href="#topology" title="Permalink to this headline">¶</a></h2>
<p>The topology is hardcoded, although you could modify it in vimc-core and
recompile the driver to achieve your own topology. This is the default topology:</p>
<div class="figure align-center" id="id1">
<img alt="Diagram of the default media pipeline topology" src="../../_images/vimc.svg" /><p class="caption"><span class="caption-text">Media pipeline graph on vimc</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="configuring-the-topology">
<h3><span class="section-number">6.22.1.1. </span>Configuring the topology<a class="headerlink" href="#configuring-the-topology" title="Permalink to this headline">¶</a></h3>
<p>Each subdevice will come with its default configuration (pixelformat, height,
width, …). One needs to configure the topology in order to match the
configuration on each linked subdevice to stream frames through the pipeline.
If the configuration doesn’t match, the stream will fail. The <code class="docutils literal notranslate"><span class="pre">v4l-utils</span></code>
package is a bundle of user-space applications, that comes with <code class="docutils literal notranslate"><span class="pre">media-ctl</span></code> and
<code class="docutils literal notranslate"><span class="pre">v4l2-ctl</span></code> that can be used to configure the vimc configuration. This sequence
of commands fits for the default topology:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>media-ctl -d platform:vimc -V <span class="s1">&#39;&quot;Sensor A&quot;:0[fmt:SBGGR8_1X8/640x480]&#39;</span>
media-ctl -d platform:vimc -V <span class="s1">&#39;&quot;Debayer A&quot;:0[fmt:SBGGR8_1X8/640x480]&#39;</span>
media-ctl -d platform:vimc -V <span class="s1">&#39;&quot;Sensor B&quot;:0[fmt:SBGGR8_1X8/640x480]&#39;</span>
media-ctl -d platform:vimc -V <span class="s1">&#39;&quot;Debayer B&quot;:0[fmt:SBGGR8_1X8/640x480]&#39;</span>
v4l2-ctl -z platform:vimc -d <span class="s2">&quot;RGB/YUV Capture&quot;</span> -v <span class="nv">width</span><span class="o">=</span><span class="m">1920</span>,height<span class="o">=</span><span class="m">1440</span>
v4l2-ctl -z platform:vimc -d <span class="s2">&quot;Raw Capture 0&quot;</span> -v <span class="nv">pixelformat</span><span class="o">=</span>BA81
v4l2-ctl -z platform:vimc -d <span class="s2">&quot;Raw Capture 1&quot;</span> -v <span class="nv">pixelformat</span><span class="o">=</span>BA81
</pre></div>
</div>
</div>
</div>
<div class="section" id="subdevices">
<h2><span class="section-number">6.22.2. </span>Subdevices<a class="headerlink" href="#subdevices" title="Permalink to this headline">¶</a></h2>
<p>Subdevices define the behavior of an entity in the topology. Depending on the
subdevice, the entity can have multiple pads of type source or sink.</p>
<dl class="simple">
<dt>vimc-sensor:</dt><dd><p>Generates images in several formats using video test pattern generator.
Exposes:</p>
<ul class="simple">
<li><p>1 Pad source</p></li>
</ul>
</dd>
<dt>vimc-debayer:</dt><dd><p>Transforms images in bayer format into a non-bayer format.
Exposes:</p>
<ul class="simple">
<li><p>1 Pad sink</p></li>
<li><p>1 Pad source</p></li>
</ul>
</dd>
<dt>vimc-scaler:</dt><dd><p>Re-size the image to meet the source pad resolution. E.g.: if the sync
pad is configured to 360x480 and the source to 1280x720, the image will
be stretched to fit the source resolution. Works for any resolution
within the vimc limitations (even shrinking the image if necessary).
Exposes:</p>
<ul class="simple">
<li><p>1 Pad sink</p></li>
<li><p>1 Pad source</p></li>
</ul>
</dd>
<dt>vimc-capture:</dt><dd><p>Exposes node /dev/videoX to allow userspace to capture the stream.
Exposes:</p>
<ul class="simple">
<li><p>1 Pad sink</p></li>
<li><p>1 Pad source</p></li>
</ul>
</dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright The kernel development community.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>