

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>device-mapper uevent &mdash; The Linux Kernel  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_rtd_colors.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.16.0-rc7-mm1-damon
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../mm/damon/index.html">Monitoring Data Accesses</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../vm/damon/index.html">DAMON: Data Access MONitor</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>device-mapper uevent</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/admin-guide/device-mapper/dm-uevent.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="device-mapper-uevent">
<h1>device-mapper uevent<a class="headerlink" href="#device-mapper-uevent" title="Permalink to this headline">¶</a></h1>
<p>The device-mapper uevent code adds the capability to device-mapper to create
and send kobject uevents (uevents).  Previously device-mapper events were only
available through the ioctl interface.  The advantage of the uevents interface
is the event contains environment attributes providing increased context for
the event avoiding the need to query the state of the device-mapper device after
the event is received.</p>
<p>There are two functions currently for device-mapper events.  The first function
listed creates the event and the second function sends the event(s):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>void dm_path_uevent(enum dm_uevent_type event_type, struct dm_target *ti,
                    const char *path, unsigned nr_valid_paths)

void dm_send_uevents(struct list_head *events, struct kobject *kobj)
</pre></div>
</div>
<p>The variables added to the uevent environment are:</p>
<div class="section" id="variable-name-dm-target">
<h2>Variable Name: DM_TARGET<a class="headerlink" href="#variable-name-dm-target" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Uevent Action(s)</dt>
<dd class="field-odd"><p>KOBJ_CHANGE</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>string</p>
</dd>
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">Value</dt>
<dd class="field-even"><p>Name of device-mapper target that generated the event.</p>
</dd>
</dl>
</div>
<div class="section" id="variable-name-dm-action">
<h2>Variable Name: DM_ACTION<a class="headerlink" href="#variable-name-dm-action" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Uevent Action(s)</dt>
<dd class="field-odd"><p>KOBJ_CHANGE</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>string</p>
</dd>
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">Value</dt>
<dd class="field-even"><p>Device-mapper specific action that caused the uevent action.
PATH_FAILED - A path has failed;
PATH_REINSTATED - A path has been reinstated.</p>
</dd>
</dl>
</div>
<div class="section" id="variable-name-dm-seqnum">
<h2>Variable Name: DM_SEQNUM<a class="headerlink" href="#variable-name-dm-seqnum" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Uevent Action(s)</dt>
<dd class="field-odd"><p>KOBJ_CHANGE</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>unsigned integer</p>
</dd>
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>A sequence number for this specific device-mapper device.</p>
</dd>
<dt class="field-even">Value</dt>
<dd class="field-even"><p>Valid unsigned integer range.</p>
</dd>
</dl>
</div>
<div class="section" id="variable-name-dm-path">
<h2>Variable Name: DM_PATH<a class="headerlink" href="#variable-name-dm-path" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Uevent Action(s)</dt>
<dd class="field-odd"><p>KOBJ_CHANGE</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>string</p>
</dd>
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Major and minor number of the path device pertaining to this
event.</p>
</dd>
<dt class="field-even">Value</dt>
<dd class="field-even"><p>Path name in the form of “Major:Minor”</p>
</dd>
</dl>
</div>
<div class="section" id="variable-name-dm-nr-valid-paths">
<h2>Variable Name: DM_NR_VALID_PATHS<a class="headerlink" href="#variable-name-dm-nr-valid-paths" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Uevent Action(s)</dt>
<dd class="field-odd"><p>KOBJ_CHANGE</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>unsigned integer</p>
</dd>
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">Value</dt>
<dd class="field-even"><p>Valid unsigned integer range.</p>
</dd>
</dl>
</div>
<div class="section" id="variable-name-dm-name">
<h2>Variable Name: DM_NAME<a class="headerlink" href="#variable-name-dm-name" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Uevent Action(s)</dt>
<dd class="field-odd"><p>KOBJ_CHANGE</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>string</p>
</dd>
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Name of the device-mapper device.</p>
</dd>
<dt class="field-even">Value</dt>
<dd class="field-even"><p>Name</p>
</dd>
</dl>
</div>
<div class="section" id="variable-name-dm-uuid">
<h2>Variable Name: DM_UUID<a class="headerlink" href="#variable-name-dm-uuid" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Uevent Action(s)</dt>
<dd class="field-odd"><p>KOBJ_CHANGE</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>string</p>
</dd>
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>UUID of the device-mapper device.</p>
</dd>
<dt class="field-even">Value</dt>
<dd class="field-even"><p>UUID. (Empty string if there isn’t one.)</p>
</dd>
</dl>
<p>An example of the uevents generated as captured by udevmonitor is shown
below</p>
<p>1.) Path failure:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>UEVENT[1192521009.711215] change@/block/dm-3
ACTION=change
DEVPATH=/block/dm-3
SUBSYSTEM=block
DM_TARGET=multipath
DM_ACTION=PATH_FAILED
DM_SEQNUM=1
DM_PATH=8:32
DM_NR_VALID_PATHS=0
DM_NAME=mpath2
DM_UUID=mpath-35333333000002328
MINOR=3
MAJOR=253
SEQNUM=1130
</pre></div>
</div>
<p>2.) Path reinstate:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>UEVENT[1192521132.989927] change@/block/dm-3
ACTION=change
DEVPATH=/block/dm-3
SUBSYSTEM=block
DM_TARGET=multipath
DM_ACTION=PATH_REINSTATED
DM_SEQNUM=2
DM_PATH=8:32
DM_NR_VALID_PATHS=1
DM_NAME=mpath2
DM_UUID=mpath-35333333000002328
MINOR=3
MAJOR=253
SEQNUM=1131
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright The kernel development community.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>