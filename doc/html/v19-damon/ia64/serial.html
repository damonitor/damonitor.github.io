

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Serial Devices &mdash; The Linux Kernel  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.8.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/mm/damon/index.html">Monitoring Data Accesses</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../vm/damon/index.html">DAMON: Data Access MONitor</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Serial Devices</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/ia64/serial.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="serial-devices">
<h1>Serial Devices<a class="headerlink" href="#serial-devices" title="Permalink to this headline">¶</a></h1>
<div class="section" id="serial-device-naming">
<h2>Serial Device Naming<a class="headerlink" href="#serial-device-naming" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>As of 2.6.10, serial devices on ia64 are named based on the
order of ACPI and PCI enumeration.  The first device in the
ACPI namespace (if any) becomes /dev/ttyS0, the second becomes
/dev/ttyS1, etc., and PCI devices are named sequentially
starting after the ACPI devices.</p>
<p>Prior to 2.6.10, there were confusing exceptions to this:</p>
<blockquote>
<div><ul class="simple">
<li>Firmware on some machines (mostly from HP) provides an HCDP
table[1] that tells the kernel about devices that can be used
as a serial console.  If the user specified “console=ttyS0”
or the EFI ConOut path contained only UART devices, the
kernel registered the device described by the HCDP as
/dev/ttyS0.</li>
<li>If there was no HCDP, we assumed there were UARTs at the
legacy COM port addresses (I/O ports 0x3f8 and 0x2f8), so
the kernel registered those as /dev/ttyS0 and /dev/ttyS1.</li>
</ul>
</div></blockquote>
<p>Any additional ACPI or PCI devices were registered sequentially
after /dev/ttyS0 as they were discovered.</p>
<p>With an HCDP, device names changed depending on EFI configuration
and “console=” arguments.  Without an HCDP, device names didn’t
change, but we registered devices that might not really exist.</p>
<p>For example, an HP rx1600 with a single built-in serial port
(described in the ACPI namespace) plus an MP[2] (a PCI device) has
these ports:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="24%" />
<col width="24%" />
<col width="14%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Type</th>
<th class="head">MMIO
address</th>
<th class="head"><p class="first">pre-2.6.10</p>
<p class="last">(EFI console
on builtin)</p>
</th>
<th class="head"><p class="first">pre-2.6.10</p>
<p class="last">(EFI console
on MP port)</p>
</th>
<th class="head">2.6.10+</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>builtin</td>
<td>0xff5e0000</td>
<td>ttyS0</td>
<td>ttyS1</td>
<td>ttyS0</td>
</tr>
<tr class="row-odd"><td>MP UPS</td>
<td>0xf8031000</td>
<td>ttyS1</td>
<td>ttyS2</td>
<td>ttyS1</td>
</tr>
<tr class="row-even"><td>MP Console</td>
<td>0xf8030000</td>
<td>ttyS2</td>
<td>ttyS0</td>
<td>ttyS2</td>
</tr>
<tr class="row-odd"><td>MP 2</td>
<td>0xf8030010</td>
<td>ttyS3</td>
<td>ttyS3</td>
<td>ttyS3</td>
</tr>
<tr class="row-even"><td>MP 3</td>
<td>0xf8030038</td>
<td>ttyS4</td>
<td>ttyS4</td>
<td>ttyS4</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="console-selection">
<h2>Console Selection<a class="headerlink" href="#console-selection" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>EFI knows what your console devices are, but it doesn’t tell the
kernel quite enough to actually locate them.  The DIG64 HCDP
table[1] does tell the kernel where potential serial console
devices are, but not all firmware supplies it.  Also, EFI supports
multiple simultaneous consoles and doesn’t tell the kernel which
should be the “primary” one.</p>
<p>So how do you tell Linux which console device to use?</p>
<blockquote>
<div><ul>
<li><p class="first">If your firmware supplies the HCDP, it is simplest to
configure EFI with a single device (either a UART or a VGA
card) as the console.  Then you don’t need to tell Linux
anything; the kernel will automatically use the EFI console.</p>
<p>(This works only in 2.6.6 or later; prior to that you had
to specify “console=ttyS0” to get a serial console.)</p>
</li>
<li><p class="first">Without an HCDP, Linux defaults to a VGA console unless you
specify a “console=” argument.</p>
</li>
</ul>
</div></blockquote>
<p>NOTE: Don’t assume that a serial console device will be /dev/ttyS0.
It might be ttyS1, ttyS2, etc.  Make sure you have the appropriate
entries in /etc/inittab (for getty) and /etc/securetty (to allow
root login).</p>
</div></blockquote>
</div>
<div class="section" id="early-serial-console">
<h2>Early Serial Console<a class="headerlink" href="#early-serial-console" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>The kernel can’t start using a serial console until it knows where
the device lives.  Normally this happens when the driver enumerates
all the serial devices, which can happen a minute or more after the
kernel starts booting.</p>
<p>2.6.10 and later kernels have an “early uart” driver that works
very early in the boot process.  The kernel will automatically use
this if the user supplies an argument like “console=uart,io,0x3f8”,
or if the EFI console path contains only a UART device and the
firmware supplies an HCDP.</p>
</div></blockquote>
</div>
<div class="section" id="troubleshooting-serial-console-problems">
<h2>Troubleshooting Serial Console Problems<a class="headerlink" href="#troubleshooting-serial-console-problems" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>No kernel output after elilo prints “Uncompressing Linux… done”:</p>
<blockquote>
<div><ul class="simple">
<li>You specified “console=ttyS0” but Linux changed the device
to which ttyS0 refers.  Configure exactly one EFI console
device[3] and remove the “console=” option.</li>
<li>The EFI console path contains both a VGA device and a UART.
EFI and elilo use both, but Linux defaults to VGA.  Remove
the VGA device from the EFI console path[3].</li>
<li>Multiple UARTs selected as EFI console devices.  EFI and
elilo use all selected devices, but Linux uses only one.
Make sure only one UART is selected in the EFI console
path[3].</li>
<li>You’re connected to an HP MP port[2] but have a non-MP UART
selected as EFI console device.  EFI uses the MP as a
console device even when it isn’t explicitly selected.
Either move the console cable to the non-MP UART, or change
the EFI console path[3] to the MP UART.</li>
</ul>
</div></blockquote>
<p>Long pause (60+ seconds) between “Uncompressing Linux… done” and
start of kernel output:</p>
<blockquote>
<div><ul class="simple">
<li>No early console because you used “console=ttyS&lt;n&gt;”.  Remove
the “console=” option if your firmware supplies an HCDP.</li>
<li>If you don’t have an HCDP, the kernel doesn’t know where
your console lives until the driver discovers serial
devices.  Use “console=uart,io,0x3f8” (or appropriate
address for your machine).</li>
</ul>
</div></blockquote>
<p>Kernel and init script output works fine, but no “login:” prompt:</p>
<blockquote>
<div><ul class="simple">
<li>Add getty entry to /etc/inittab for console tty.  Look for
the “Adding console on ttyS&lt;n&gt;” message that tells you which
device is the console.</li>
</ul>
</div></blockquote>
<p>“login:” prompt, but can’t login as root:</p>
<blockquote>
<div><ul class="simple">
<li>Add entry to /etc/securetty for console tty.</li>
</ul>
</div></blockquote>
<p>No ACPI serial devices found in 2.6.17 or later:</p>
<blockquote>
<div><ul class="simple">
<li>Turn on CONFIG_PNP and CONFIG_PNPACPI.  Prior to 2.6.17, ACPI
serial devices were discovered by 8250_acpi.  In 2.6.17,
8250_acpi was replaced by the combination of 8250_pnp and
CONFIG_PNPACPI.</li>
</ul>
</div></blockquote>
</div></blockquote>
<dl class="docutils">
<dt>[1]</dt>
<dd><a class="reference external" href="http://www.dig64.org/specifications/agreement">http://www.dig64.org/specifications/agreement</a>
The table was originally defined as the “HCDP” for “Headless
Console/Debug Port.”  The current version is the “PCDP” for
“Primary Console and Debug Port Devices.”</dd>
<dt>[2]</dt>
<dd>The HP MP (management processor) is a PCI device that provides
several UARTs.  One of the UARTs is often used as a console; the
EFI Boot Manager identifies it as “Acpi(HWP0002,700)/Pci(…)/Uart”.
The external connection is usually a 25-pin connector, and a
special dongle converts that to three 9-pin connectors, one of
which is labelled “Console.”</dd>
<dt>[3]</dt>
<dd>EFI console devices are configured using the EFI Boot Manager
“Boot option maintenance” menu.  You may have to interrupt the
boot sequence to use this menu, and you will have to reset the
box after changing console configuration.</dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>