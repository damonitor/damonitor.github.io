

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Kernel driver ds2490 &mdash; The Linux Kernel  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../',
              VERSION:'',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.8.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../admin-guide/mm/damon/index.html">Monitoring Data Accesses</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../vm/damon/index.html">DAMON: Data Access MONitor</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Kernel driver ds2490</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/w1/masters/ds2490.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="kernel-driver-ds2490">
<h1>Kernel driver ds2490<a class="headerlink" href="#kernel-driver-ds2490" title="Permalink to this headline">¶</a></h1>
<p>Supported chips:</p>
<blockquote>
<div><ul class="simple">
<li>Maxim DS2490 based</li>
</ul>
</div></blockquote>
<p>Author: Evgeniy Polyakov &lt;<a class="reference external" href="mailto:johnpol&#37;&#52;&#48;2ka&#46;mipt&#46;ru">johnpol<span>&#64;</span>2ka<span>&#46;</span>mipt<span>&#46;</span>ru</a>&gt;</p>
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>The Maxim/Dallas Semiconductor DS2490 is a chip
which allows to build USB &lt;-&gt; W1 bridges.</p>
<p>DS9490(R) is a USB &lt;-&gt; W1 bus master device
which has 0x81 family ID integrated chip and DS2490
low-level operational chip.</p>
<p>Notes and limitations.</p>
<ul class="simple">
<li>The weak pullup current is a minimum of 0.9mA and maximum of 6.0mA.</li>
<li>The 5V strong pullup is supported with a minimum of 5.9mA and a
maximum of 30.4 mA.  (From DS2490.pdf)</li>
<li>The hardware will detect when devices are attached to the bus on the
next bus (reset?) operation, however only a message is printed as
the core w1 code doesn’t make use of the information.  Connecting
one device tends to give multiple new device notifications.</li>
<li>The number of USB bus transactions could be reduced if w1_reset_send
was added to the API.  The name is just a suggestion.  It would take
a write buffer and a read buffer (along with sizes) as arguments.
The ds2490 block I/O command supports reset, write buffer, read
buffer, and strong pullup all in one command, instead of the current
1 reset bus, 2 write the match rom command and slave rom id, 3 block
write and read data.  The write buffer needs to have the match rom
command and slave rom id prepended to the front of the requested
write buffer, both of which are known to the driver.</li>
<li>The hardware supports normal, flexible, and overdrive bus
communication speeds, but only the normal is supported.</li>
<li>The registered w1_bus_master functions don’t define error
conditions.  If a bus search is in progress and the ds2490 is
removed it can produce a good amount of error output before the bus
search finishes.</li>
<li>The hardware supports detecting some error conditions, such as
short, alarming presence on reset, and no presence on reset, but the
driver doesn’t query those values.</li>
<li>The ds2490 specification doesn’t cover short bulk in reads in
detail, but my observation is if fewer bytes are requested than are
available, the bulk read will return an error and the hardware will
clear the entire bulk in buffer.  It would be possible to read the
maximum buffer size to not run into this error condition, only extra
bytes in the buffer is a logic error in the driver.  The code should
should match reads and writes as well as data sizes.  Reads and
writes are serialized and the status verifies that the chip is idle
(and data is available) before the read is executed, so it should
not happen.</li>
<li>Running x86_64 2.6.24 UHCI under qemu 0.9.0 under x86_64 2.6.22-rc6
with a OHCI controller, ds2490 running in the guest would operate
normally the first time the module was loaded after qemu attached
the ds2490 hardware, but if the module was unloaded, then reloaded
most of the time one of the bulk out or in, and usually the bulk in
would fail.  qemu sets a 50ms timeout and the bulk in would timeout
even when the status shows data available.  A bulk out write would
show a successful completion, but the ds2490 status register would
show 0 bytes written.  Detaching qemu from the ds2490 hardware and
reattaching would clear the problem.  usbmon output in the guest and
host did not explain the problem.  My guess is a bug in either qemu
or the host OS and more likely the host OS.</li>
</ul>
<p>03-06-2008 David Fries &lt;<a class="reference external" href="mailto:David&#37;&#52;&#48;Fries&#46;net">David<span>&#64;</span>Fries<span>&#46;</span>net</a>&gt;</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>