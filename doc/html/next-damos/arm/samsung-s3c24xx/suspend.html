

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>S3C24XX Suspend Support &mdash; The Linux Kernel  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../',
              VERSION:'',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.7.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../admin-guide/mm/damon/index.html">DAMON: Data Access MONitor</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>S3C24XX Suspend Support</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/arm/samsung-s3c24xx/suspend.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="s3c24xx-suspend-support">
<h1>S3C24XX Suspend Support<a class="headerlink" href="#s3c24xx-suspend-support" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>The S3C24XX supports a low-power suspend mode, where the SDRAM is kept
in Self-Refresh mode, and all but the essential peripheral blocks are
powered down. For more information on how this works, please look
at the relevant CPU datasheet from Samsung.</div></blockquote>
</div>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ol class="arabic simple">
<li>A bootloader that can support the necessary resume operation</li>
<li>Support for at least 1 source for resume</li>
<li>CONFIG_PM enabled in the kernel</li>
<li>Any peripherals that are going to be powered down at the same
time require suspend/resume support.</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="resuming">
<h2>Resuming<a class="headerlink" href="#resuming" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>The S3C2410 user manual defines the process of sending the CPU to
sleep and how it resumes. The default behaviour of the Linux code
is to set the GSTATUS3 register to the physical address of the
code to resume Linux operation.</p>
<p>GSTATUS4 is currently left alone by the sleep code, and is free to
use for any other purposes (for example, the EB2410ITX uses this to
save memory configuration in).</p>
</div></blockquote>
</div>
<div class="section" id="machine-support">
<h2>Machine Support<a class="headerlink" href="#machine-support" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>The machine specific functions must call the s3c_pm_init() function
to say that its bootloader is capable of resuming. This can be as
simple as adding the following to the machine’s definition:</p>
<p>INITMACHINE(s3c_pm_init)</p>
<p>A board can do its own setup before calling s3c_pm_init, if it
needs to setup anything else for power management support.</p>
<p>There is currently no support for over-riding the default method of
saving the resume address, if your board requires it, then contact
the maintainer and discuss what is required.</p>
<p>Note, the original method of adding an late_initcall() is wrong,
and will end up initialising all compiled machines’ pm init!</p>
<p>The following is an example of code used for testing wakeup from
an falling edge on IRQ_EINT0:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>static irqreturn_t button_irq(int irq, void *pw)
{
    return IRQ_HANDLED;
}

statuc void __init machine_init(void)
{
    ...

    request_irq(IRQ_EINT0, button_irq, IRQF_TRIGGER_FALLING,
               &quot;button-irq-eint0&quot;, NULL);

    enable_irq_wake(IRQ_EINT0);

    s3c_pm_init();
}
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="debugging">
<h2>Debugging<a class="headerlink" href="#debugging" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>There are several important things to remember when using PM suspend:</p>
<ol class="arabic">
<li><p class="first">The uart drivers will disable the clocks to the UART blocks when
suspending, which means that use of printascii() or similar direct
access to the UARTs will cause the debug to stop.</p>
</li>
<li><p class="first">While the pm code itself will attempt to re-enable the UART clocks,
care should be taken that any external clock sources that the UARTs
rely on are still enabled at that point.</p>
</li>
<li><p class="first">If any debugging is placed in the resume path, then it must have the
relevant clocks and peripherals setup before use (ie, bootloader).</p>
<p>For example, if you transmit a character from the UART, the baud
rate and uart controls must be setup beforehand.</p>
</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>The S3C2410 specific configuration in <cite>System Type</cite> defines various
aspects of how the S3C2410 suspend and resume support is configured</p>
<p><cite>S3C2410 PM Suspend debug</cite></p>
<blockquote>
<div>This option prints messages to the serial console before and after
the actual suspend, giving detailed information on what is
happening</div></blockquote>
<p><cite>S3C2410 PM Suspend Memory CRC</cite></p>
<blockquote>
<div><p>Allows the entire memory to be checksummed before and after the
suspend to see if there has been any corruption of the contents.</p>
<p>Note, the time to calculate the CRC is dependent on the CPU speed
and the size of memory. For an 64Mbyte RAM area on an 200MHz
S3C2410, this can take approximately 4 seconds to complete.</p>
<p>This support requires the CRC32 function to be enabled.</p>
</div></blockquote>
<p><cite>S3C2410 PM Suspend CRC Chunksize (KiB)</cite></p>
<blockquote>
<div>Defines the size of memory each CRC chunk covers. A smaller value
will mean that the CRC data block will take more memory, but will
identify any faults with better precision</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="document-author">
<h2>Document Author<a class="headerlink" href="#document-author" title="Permalink to this headline">¶</a></h2>
<p>Ben Dooks, Copyright 2004 Simtec Electronics</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>