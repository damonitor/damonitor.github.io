

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Generic System Interconnect Subsystem &mdash; The Linux Kernel  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.7.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/mm/damon/index.html">Monitoring Data Accesses</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../vm/damon/index.html">DAMON: Data Access MONitor</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Generic System Interconnect Subsystem</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/driver-api/interconnect.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="generic-system-interconnect-subsystem">
<h1>Generic System Interconnect Subsystem<a class="headerlink" href="#generic-system-interconnect-subsystem" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This framework is designed to provide a standard kernel interface to control
the settings of the interconnects on an SoC. These settings can be throughput,
latency and priority between multiple interconnected devices or functional
blocks. This can be controlled dynamically in order to save power or provide
maximum performance.</p>
<p>The interconnect bus is hardware with configurable parameters, which can be
set on a data path according to the requests received from various drivers.
An example of interconnect buses are the interconnects between various
components or functional blocks in chipsets. There can be multiple interconnects
on an SoC that can be multi-tiered.</p>
<p>Below is a simplified diagram of a real-world SoC interconnect bus topology.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>+----------------+    +----------------+
| HW Accelerator |---&gt;|      M NoC     |&lt;---------------+
+----------------+    +----------------+                |
                        |      |                    +------------+
 +-----+  +-------------+      V       +------+     |            |
 | DDR |  |                +--------+  | PCIe |     |            |
 +-----+  |                | Slaves |  +------+     |            |
   ^ ^    |                +--------+     |         |   C NoC    |
   | |    V                               V         |            |
+------------------+   +------------------------+   |            |   +-----+
|                  |--&gt;|                        |--&gt;|            |--&gt;| CPU |
|                  |--&gt;|                        |&lt;--|            |   +-----+
|     Mem NoC      |   |         S NoC          |   +------------+
|                  |&lt;--|                        |---------+    |
|                  |&lt;--|                        |&lt;------+ |    |   +--------+
+------------------+   +------------------------+       | |    +--&gt;| Slaves |
  ^  ^    ^    ^          ^                             | |        +--------+
  |  |    |    |          |                             | V
+------+  |  +-----+   +-----+  +---------+   +----------------+   +--------+
| CPUs |  |  | GPU |   | DSP |  | Masters |--&gt;|       P NoC    |--&gt;| Slaves |
+------+  |  +-----+   +-----+  +---------+   +----------------+   +--------+
          |
      +-------+
      | Modem |
      +-------+
</pre></div>
</div>
</div>
<div class="section" id="terminology">
<h2>Terminology<a class="headerlink" href="#terminology" title="Permalink to this headline">¶</a></h2>
<p>Interconnect provider is the software definition of the interconnect hardware.
The interconnect providers on the above diagram are M NoC, S NoC, C NoC, P NoC
and Mem NoC.</p>
<p>Interconnect node is the software definition of the interconnect hardware
port. Each interconnect provider consists of multiple interconnect nodes,
which are connected to other SoC components including other interconnect
providers. The point on the diagram where the CPUs connect to the memory is
called an interconnect node, which belongs to the Mem NoC interconnect provider.</p>
<p>Interconnect endpoints are the first or the last element of the path. Every
endpoint is a node, but not every node is an endpoint.</p>
<p>Interconnect path is everything between two endpoints including all the nodes
that have to be traversed to reach from a source to destination node. It may
include multiple master-slave pairs across several interconnect providers.</p>
<p>Interconnect consumers are the entities which make use of the data paths exposed
by the providers. The consumers send requests to providers requesting various
throughput, latency and priority. Usually the consumers are device drivers, that
send request based on their needs. An example for a consumer is a video decoder
that supports various formats and image sizes.</p>
</div>
<div class="section" id="interconnect-providers">
<h2>Interconnect providers<a class="headerlink" href="#interconnect-providers" title="Permalink to this headline">¶</a></h2>
<p>Interconnect provider is an entity that implements methods to initialize and
configure interconnect bus hardware. The interconnect provider drivers should
be registered with the interconnect provider core.</p>
<dl class="type">
<dt id="c.icc_onecell_data">
struct <code class="descname">icc_onecell_data</code><a class="headerlink" href="#c.icc_onecell_data" title="Permalink to this definition">¶</a></dt>
<dd><p>driver data for onecell interconnect providers</p>
</dd></dl>

<p><strong>Definition</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct icc_onecell_data {
  unsigned int num_nodes;
  struct icc_node *nodes[];
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">num_nodes</span></code></dt>
<dd>number of nodes in this device</dd>
<dt><code class="docutils literal notranslate"><span class="pre">nodes</span></code></dt>
<dd>array of pointers to the nodes in this device</dd>
</dl>
<dl class="type">
<dt id="c.icc_provider">
struct <code class="descname">icc_provider</code><a class="headerlink" href="#c.icc_provider" title="Permalink to this definition">¶</a></dt>
<dd><p>interconnect provider (controller) entity that might provide multiple interconnect controls</p>
</dd></dl>

<p><strong>Definition</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct icc_provider {
  struct list_head        provider_list;
  struct list_head        nodes;
  int (*set)(struct icc_node *src, struct icc_node *dst);
  int (*aggregate)(struct icc_node *node, u32 tag, u32 avg_bw, u32 peak_bw, u32 *agg_avg, u32 *agg_peak);
  void (*pre_aggregate)(struct icc_node *node);
  struct icc_node* (*xlate)(struct of_phandle_args *spec, void *data);
  struct device           *dev;
  int users;
  void *data;
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">provider_list</span></code></dt>
<dd>list of the registered interconnect providers</dd>
<dt><code class="docutils literal notranslate"><span class="pre">nodes</span></code></dt>
<dd>internal list of the interconnect provider nodes</dd>
<dt><code class="docutils literal notranslate"><span class="pre">set</span></code></dt>
<dd>pointer to device specific set operation function</dd>
<dt><code class="docutils literal notranslate"><span class="pre">aggregate</span></code></dt>
<dd>pointer to device specific aggregate operation function</dd>
<dt><code class="docutils literal notranslate"><span class="pre">pre_aggregate</span></code></dt>
<dd>pointer to device specific function that is called
before the aggregation begins (optional)</dd>
<dt><code class="docutils literal notranslate"><span class="pre">xlate</span></code></dt>
<dd>provider-specific callback for mapping nodes from phandle arguments</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dev</span></code></dt>
<dd>the device this interconnect provider belongs to</dd>
<dt><code class="docutils literal notranslate"><span class="pre">users</span></code></dt>
<dd>count of active users</dd>
<dt><code class="docutils literal notranslate"><span class="pre">data</span></code></dt>
<dd>pointer to private data</dd>
</dl>
<dl class="type">
<dt id="c.icc_node">
struct <code class="descname">icc_node</code><a class="headerlink" href="#c.icc_node" title="Permalink to this definition">¶</a></dt>
<dd><p>entity that is part of the interconnect topology</p>
</dd></dl>

<p><strong>Definition</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct icc_node {
  int id;
  const char              *name;
  struct icc_node         **links;
  size_t num_links;
  struct icc_provider     *provider;
  struct list_head        node_list;
  struct list_head        search_list;
  struct icc_node         *reverse;
  u8 is_traversed:1;
  struct hlist_head       req_list;
  u32 avg_bw;
  u32 peak_bw;
  void *data;
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">id</span></code></dt>
<dd>platform specific node id</dd>
<dt><code class="docutils literal notranslate"><span class="pre">name</span></code></dt>
<dd>node name used in debugfs</dd>
<dt><code class="docutils literal notranslate"><span class="pre">links</span></code></dt>
<dd>a list of targets pointing to where we can go next when traversing</dd>
<dt><code class="docutils literal notranslate"><span class="pre">num_links</span></code></dt>
<dd>number of links to other interconnect nodes</dd>
<dt><code class="docutils literal notranslate"><span class="pre">provider</span></code></dt>
<dd>points to the interconnect provider of this node</dd>
<dt><code class="docutils literal notranslate"><span class="pre">node_list</span></code></dt>
<dd>the list entry in the parent provider’s “nodes” list</dd>
<dt><code class="docutils literal notranslate"><span class="pre">search_list</span></code></dt>
<dd>list used when walking the nodes graph</dd>
<dt><code class="docutils literal notranslate"><span class="pre">reverse</span></code></dt>
<dd>pointer to previous node when walking the nodes graph</dd>
<dt><code class="docutils literal notranslate"><span class="pre">is_traversed</span></code></dt>
<dd>flag that is used when walking the nodes graph</dd>
<dt><code class="docutils literal notranslate"><span class="pre">req_list</span></code></dt>
<dd>a list of QoS constraint requests associated with this node</dd>
<dt><code class="docutils literal notranslate"><span class="pre">avg_bw</span></code></dt>
<dd>aggregated value of average bandwidth requests from all consumers</dd>
<dt><code class="docutils literal notranslate"><span class="pre">peak_bw</span></code></dt>
<dd>aggregated value of peak bandwidth requests from all consumers</dd>
<dt><code class="docutils literal notranslate"><span class="pre">data</span></code></dt>
<dd>pointer to private data</dd>
</dl>
</div>
<div class="section" id="interconnect-consumers">
<h2>Interconnect consumers<a class="headerlink" href="#interconnect-consumers" title="Permalink to this headline">¶</a></h2>
<p>Interconnect consumers are the clients which use the interconnect APIs to
get paths between endpoints and set their bandwidth/latency/QoS requirements
for these interconnect paths.  These interfaces are not currently
documented.</p>
</div>
<div class="section" id="interconnect-debugfs-interfaces">
<h2>Interconnect debugfs interfaces<a class="headerlink" href="#interconnect-debugfs-interfaces" title="Permalink to this headline">¶</a></h2>
<p>Like several other subsystems interconnect will create some files for debugging
and introspection. Files in debugfs are not considered ABI so application
software shouldn’t rely on format details change between kernel versions.</p>
<p><code class="docutils literal notranslate"><span class="pre">/sys/kernel/debug/interconnect/interconnect_summary</span></code>:</p>
<p>Show all interconnect nodes in the system with their aggregated bandwidth
request. Indented under each node show bandwidth requests from each device.</p>
<p><code class="docutils literal notranslate"><span class="pre">/sys/kernel/debug/interconnect/interconnect_graph</span></code>:</p>
<p>Show the interconnect graph in the graphviz dot format. It shows all
interconnect nodes and links in the system and groups together nodes from the
same provider as subgraphs. The format is human-readable and can also be piped
through dot to generate diagrams in many graphical formats:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ cat /sys/kernel/debug/interconnect/interconnect_graph | \
        dot -Tsvg &gt; interconnect_graph.svg
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>