

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>BusLogic MultiMaster and FlashPoint SCSI Driver for Linux &mdash; The Linux Kernel  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                5.7.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/mm/damon/index.html">Monitoring Data Accesses</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../vm/damon/index.html">DAMON: Data Access MONitor</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>BusLogic MultiMaster and FlashPoint SCSI Driver for Linux</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/scsi/BusLogic.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="buslogic-multimaster-and-flashpoint-scsi-driver-for-linux">
<h1>BusLogic MultiMaster and FlashPoint SCSI Driver for Linux<a class="headerlink" href="#buslogic-multimaster-and-flashpoint-scsi-driver-for-linux" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><blockquote>
<div><p>Version 2.0.15 for Linux 2.0</p>
<p>Version 2.1.15 for Linux 2.1</p>
<blockquote>
<div><p>PRODUCTION RELEASE</p>
<blockquote>
<div><blockquote>
<div>17 August 1998</div></blockquote>
<p>Leonard N. Zubkoff</p>
<p>Dandelion Digital</p>
<p><a class="reference external" href="mailto:lnz&#37;&#52;&#48;dandelion&#46;com">lnz<span>&#64;</span>dandelion<span>&#46;</span>com</a></p>
</div></blockquote>
</div></blockquote>
</div></blockquote>
<p>Copyright 1995-1998 by Leonard N. Zubkoff &lt;<a class="reference external" href="mailto:lnz&#37;&#52;&#48;dandelion&#46;com">lnz<span>&#64;</span>dandelion<span>&#46;</span>com</a>&gt;</p>
</div></blockquote>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>BusLogic, Inc. designed and manufactured a variety of high performance SCSI
host adapters which share a common programming interface across a diverse
collection of bus architectures by virtue of their MultiMaster ASIC technology.
BusLogic was acquired by Mylex Corporation in February 1996, but the products
supported by this driver originated under the BusLogic name and so that name is
retained in the source code and documentation.</p>
<p>This driver supports all present BusLogic MultiMaster Host Adapters, and should
support any future MultiMaster designs with little or no modification.  More
recently, BusLogic introduced the FlashPoint Host Adapters, which are less
costly and rely on the host CPU, rather than including an onboard processor.
Despite not having an onboard CPU, the FlashPoint Host Adapters perform very
well and have very low command latency.  BusLogic has recently provided me with
the FlashPoint Driver Developer’s Kit, which comprises documentation and freely
redistributable source code for the FlashPoint SCCB Manager.  The SCCB Manager
is the library of code that runs on the host CPU and performs functions
analogous to the firmware on the MultiMaster Host Adapters.  Thanks to their
having provided the SCCB Manager, this driver now supports the FlashPoint Host
Adapters as well.</p>
<p>My primary goals in writing this completely new BusLogic driver for Linux are
to achieve the full performance that BusLogic SCSI Host Adapters and modern
SCSI peripherals are capable of, and to provide a highly robust driver that can
be depended upon for high performance mission critical applications.  All of
the major performance features can be configured from the Linux kernel command
line or at module initialization time, allowing individual installations to
tune driver performance and error recovery to their particular needs.</p>
<p>The latest information on Linux support for BusLogic SCSI Host Adapters, as
well as the most recent release of this driver and the latest firmware for the
BT-948/958/958D, will always be available from my Linux Home Page at URL
“<a class="reference external" href="http://sourceforge.net/projects/dandelion/">http://sourceforge.net/projects/dandelion/</a>”.</p>
<p>Bug reports should be sent via electronic mail to “<a class="reference external" href="mailto:lnz&#37;&#52;&#48;dandelion&#46;com">lnz<span>&#64;</span>dandelion<span>&#46;</span>com</a>”.  Please
include with the bug report the complete configuration messages reported by the
driver and SCSI subsystem at startup, along with any subsequent system messages
relevant to SCSI operations, and a detailed description of your system’s
hardware configuration.</p>
<p>Mylex has been an excellent company to work with and I highly recommend their
products to the Linux community.  In November 1995, I was offered the
opportunity to become a beta test site for their latest MultiMaster product,
the BT-948 PCI Ultra SCSI Host Adapter, and then again for the BT-958 PCI Wide
Ultra SCSI Host Adapter in January 1996.  This was mutually beneficial since
Mylex received a degree and kind of testing that their own testing group cannot
readily achieve, and the Linux community has available high performance host
adapters that have been well tested with Linux even before being brought to
market.  This relationship has also given me the opportunity to interact
directly with their technical staff, to understand more about the internal
workings of their products, and in turn to educate them about the needs and
potential of the Linux community.</p>
<p>More recently, Mylex has reaffirmed the company’s interest in supporting the
Linux community, and I am now working on a Linux driver for the DAC960 PCI RAID
Controllers.  Mylex’s interest and support is greatly appreciated.</p>
<p>Unlike some other vendors, if you contact Mylex Technical Support with a
problem and are running Linux, they will not tell you that your use of their
products is unsupported.  Their latest product marketing literature even states
“Mylex SCSI host adapters are compatible with all major operating systems
including: … Linux …”.</p>
<p>Mylex Corporation is located at 34551 Ardenwood Blvd., Fremont, California
94555, USA and can be reached at 510/796-6100 or on the World Wide Web at
<a class="reference external" href="http://www.mylex.com">http://www.mylex.com</a>.  Mylex HBA Technical Support can be reached by electronic
mail at <a class="reference external" href="mailto:techsup&#37;&#52;&#48;mylex&#46;com">techsup<span>&#64;</span>mylex<span>&#46;</span>com</a>, by Voice at 510/608-2400, or by FAX at 510/745-7715.
Contact information for offices in Europe and Japan is available on the Web
site.</p>
</div>
<div class="section" id="driver-features">
<h2>Driver Features<a class="headerlink" href="#driver-features" title="Permalink to this headline">¶</a></h2>
<div class="section" id="configuration-reporting-and-testing">
<h3>Configuration Reporting and Testing<a class="headerlink" href="#configuration-reporting-and-testing" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>During system initialization, the driver reports extensively on the host
adapter hardware configuration, including the synchronous transfer parameters
requested and negotiated with each target device.  AutoSCSI settings for
Synchronous Negotiation, Wide Negotiation, and Disconnect/Reconnect are
reported for each target device, as well as the status of Tagged Queuing.
If the same setting is in effect for all target devices, then a single word
or phrase is used; otherwise, a letter is provided for each target device to
indicate the individual status.  The following examples
should clarify this reporting format:</p>
<blockquote>
<div><p>Synchronous Negotiation: Ultra</p>
<blockquote>
<div>Synchronous negotiation is enabled for all target devices and the host
adapter will attempt to negotiate for 20.0 mega-transfers/second.</div></blockquote>
<p>Synchronous Negotiation: Fast</p>
<blockquote>
<div>Synchronous negotiation is enabled for all target devices and the host
adapter will attempt to negotiate for 10.0 mega-transfers/second.</div></blockquote>
<p>Synchronous Negotiation: Slow</p>
<blockquote>
<div>Synchronous negotiation is enabled for all target devices and the host
adapter will attempt to negotiate for 5.0 mega-transfers/second.</div></blockquote>
<p>Synchronous Negotiation: Disabled</p>
<blockquote>
<div>Synchronous negotiation is disabled and all target devices are limited to
asynchronous operation.</div></blockquote>
<p>Synchronous Negotiation: UFSNUUU#UUUUUUUU</p>
<blockquote>
<div>Synchronous negotiation to Ultra speed is enabled for target devices 0
and 4 through 15, to Fast speed for target device 1, to Slow speed for
target device 2, and is not permitted to target device 3.  The host
adapter’s SCSI ID is represented by the “#”.</div></blockquote>
<p>The status of Wide Negotiation, Disconnect/Reconnect, and Tagged Queuing
are reported as “Enabled”, Disabled”, or a sequence of “Y” and “N” letters.</p>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="performance-features">
<h3>Performance Features<a class="headerlink" href="#performance-features" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>BusLogic SCSI Host Adapters directly implement SCSI-2 Tagged Queuing, and so
support has been included in the driver to utilize tagged queuing with any
target devices that report having the tagged queuing capability.  Tagged
queuing allows for multiple outstanding commands to be issued to each target
device or logical unit, and can improve I/O performance substantially.  In
addition, BusLogic’s Strict Round Robin Mode is used to optimize host adapter
performance, and scatter/gather I/O can support as many segments as can be
effectively utilized by the Linux I/O subsystem.  Control over the use of
tagged queuing for each target device as well as individual selection of the
tagged queue depth is available through driver options provided on the kernel
command line or at module initialization time.  By default, the queue depth
is determined automatically based on the host adapter’s total queue depth and
the number, type, speed, and capabilities of the target devices found.  In
addition, tagged queuing is automatically disabled whenever the host adapter
firmware version is known not to implement it correctly, or whenever a tagged
queue depth of 1 is selected.  Tagged queuing is also disabled for individual
target devices if disconnect/reconnect is disabled for that device.</div></blockquote>
</div>
<div class="section" id="robustness-features">
<h3>Robustness Features<a class="headerlink" href="#robustness-features" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>The driver implements extensive error recovery procedures.  When the higher
level parts of the SCSI subsystem request that a timed out command be reset,
a selection is made between a full host adapter hard reset and SCSI bus reset
versus sending a bus device reset message to the individual target device
based on the recommendation of the SCSI subsystem.  Error recovery strategies
are selectable through driver options individually for each target device,
and also include sending a bus device reset to the specific target device
associated with the command being reset, as well as suppressing error
recovery entirely to avoid perturbing an improperly functioning device.  If
the bus device reset error recovery strategy is selected and sending a bus
device reset does not restore correct operation, the next command that is
reset will force a full host adapter hard reset and SCSI bus reset.  SCSI bus
resets caused by other devices and detected by the host adapter are also
handled by issuing a soft reset to the host adapter and re-initialization.
Finally, if tagged queuing is active and more than one command reset occurs
in a 10 minute interval, or if a command reset occurs within the first 10
minutes of operation, then tagged queuing will be disabled for that target
device.  These error recovery options improve overall system robustness by
preventing individual errant devices from causing the system as a whole to
lock up or crash, and thereby allowing a clean shutdown and restart after the
offending component is removed.</div></blockquote>
</div>
<div class="section" id="pci-configuration-support">
<h3>PCI Configuration Support<a class="headerlink" href="#pci-configuration-support" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>On PCI systems running kernels compiled with PCI BIOS support enabled, this
driver will interrogate the PCI configuration space and use the I/O port
addresses assigned by the system BIOS, rather than the ISA compatible I/O
port addresses.  The ISA compatible I/O port address is then disabled by the
driver.  On PCI systems it is also recommended that the AutoSCSI utility be
used to disable the ISA compatible I/O port entirely as it is not necessary.
The ISA compatible I/O port is disabled by default on the BT-948/958/958D.</div></blockquote>
</div>
<div class="section" id="proc-file-system-support">
<h3>/proc File System Support<a class="headerlink" href="#proc-file-system-support" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>Copies of the host adapter configuration information together with updated
data transfer and error recovery statistics are available through the
/proc/scsi/BusLogic/&lt;N&gt; interface.</div></blockquote>
</div>
<div class="section" id="shared-interrupts-support">
<h3>Shared Interrupts Support<a class="headerlink" href="#shared-interrupts-support" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>On systems that support shared interrupts, any number of BusLogic Host
Adapters may share the same interrupt request channel.</div></blockquote>
</div>
</div>
<div class="section" id="supported-host-adapters">
<h2>Supported Host Adapters<a class="headerlink" href="#supported-host-adapters" title="Permalink to this headline">¶</a></h2>
<p>The following list comprises the supported BusLogic SCSI Host Adapters as of
the date of this document.  It is recommended that anyone purchasing a BusLogic
Host Adapter not in the following table contact the author beforehand to verify
that it is or will be supported.</p>
<p>FlashPoint Series PCI Host Adapters:</p>
<table border="1" class="docutils">
<colgroup>
<col width="34%" />
<col width="66%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>FlashPoint LT (BT-930)</td>
<td>Ultra SCSI-3</td>
</tr>
<tr class="row-even"><td>FlashPoint LT (BT-930R)</td>
<td>Ultra SCSI-3 with RAIDPlus</td>
</tr>
<tr class="row-odd"><td>FlashPoint LT (BT-920)</td>
<td>Ultra SCSI-3 (BT-930 without BIOS)</td>
</tr>
<tr class="row-even"><td>FlashPoint DL (BT-932)</td>
<td>Dual Channel Ultra SCSI-3</td>
</tr>
<tr class="row-odd"><td>FlashPoint DL (BT-932R)</td>
<td>Dual Channel Ultra SCSI-3 with RAIDPlus</td>
</tr>
<tr class="row-even"><td>FlashPoint LW (BT-950)</td>
<td>Wide Ultra SCSI-3</td>
</tr>
<tr class="row-odd"><td>FlashPoint LW (BT-950R)</td>
<td>Wide Ultra SCSI-3 with RAIDPlus</td>
</tr>
<tr class="row-even"><td>FlashPoint DW (BT-952)</td>
<td>Dual Channel Wide Ultra SCSI-3</td>
</tr>
<tr class="row-odd"><td>FlashPoint DW (BT-952R)</td>
<td>Dual Channel Wide Ultra SCSI-3 with RAIDPlus</td>
</tr>
</tbody>
</table>
<p>MultiMaster “W” Series Host Adapters:</p>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="8%" />
<col width="75%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>BT-948</td>
<td>PCI</td>
<td>Ultra SCSI-3</td>
</tr>
<tr class="row-even"><td>BT-958</td>
<td>PCI</td>
<td>Wide Ultra SCSI-3</td>
</tr>
<tr class="row-odd"><td>BT-958D</td>
<td>PCI</td>
<td>Wide Differential Ultra SCSI-3</td>
</tr>
</tbody>
</table>
<p>MultiMaster “C” Series Host Adapters:</p>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="10%" />
<col width="71%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>BT-946C</td>
<td>PCI</td>
<td>Fast SCSI-2</td>
</tr>
<tr class="row-even"><td>BT-956C</td>
<td>PCI</td>
<td>Wide Fast SCSI-2</td>
</tr>
<tr class="row-odd"><td>BT-956CD</td>
<td>PCI</td>
<td>Wide Differential Fast SCSI-2</td>
</tr>
<tr class="row-even"><td>BT-445C</td>
<td>VLB</td>
<td>Fast SCSI-2</td>
</tr>
<tr class="row-odd"><td>BT-747C</td>
<td>EISA</td>
<td>Fast SCSI-2</td>
</tr>
<tr class="row-even"><td>BT-757C</td>
<td>EISA</td>
<td>Wide Fast SCSI-2</td>
</tr>
<tr class="row-odd"><td>BT-757CD</td>
<td>EISA</td>
<td>Wide Differential Fast SCSI-2</td>
</tr>
<tr class="row-even"><td>BT-545C</td>
<td>ISA</td>
<td>Fast SCSI-2</td>
</tr>
<tr class="row-odd"><td>BT-540CF</td>
<td>ISA</td>
<td>Fast SCSI-2</td>
</tr>
</tbody>
</table>
<p>MultiMaster “S” Series Host Adapters:</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="10%" />
<col width="73%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>BT-445S</td>
<td>VLB</td>
<td>Fast SCSI-2</td>
</tr>
<tr class="row-even"><td>BT-747S</td>
<td>EISA</td>
<td>Fast SCSI-2</td>
</tr>
<tr class="row-odd"><td>BT-747D</td>
<td>EISA</td>
<td>Differential Fast SCSI-2</td>
</tr>
<tr class="row-even"><td>BT-757S</td>
<td>EISA</td>
<td>Wide Fast SCSI-2</td>
</tr>
<tr class="row-odd"><td>BT-757D</td>
<td>EISA</td>
<td>Wide Differential Fast SCSI-2</td>
</tr>
<tr class="row-even"><td>BT-545S</td>
<td>ISA</td>
<td>Fast SCSI-2</td>
</tr>
<tr class="row-odd"><td>BT-542D</td>
<td>ISA</td>
<td>Differential Fast SCSI-2</td>
</tr>
<tr class="row-even"><td>BT-742A</td>
<td>EISA</td>
<td>SCSI-2 (742A revision H)</td>
</tr>
<tr class="row-odd"><td>BT-542B</td>
<td>ISA</td>
<td>SCSI-2 (542B revision H)</td>
</tr>
</tbody>
</table>
<p>MultiMaster “A” Series Host Adapters:</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="10%" />
<col width="73%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>BT-742A</td>
<td>EISA</td>
<td>SCSI-2 (742A revisions A - G)</td>
</tr>
<tr class="row-even"><td>BT-542B</td>
<td>ISA</td>
<td>SCSI-2 (542B revisions A - G)</td>
</tr>
</tbody>
</table>
<p>AMI FastDisk Host Adapters that are true BusLogic MultiMaster clones are also
supported by this driver.</p>
<p>BusLogic SCSI Host Adapters are available packaged both as bare boards and as
retail kits.  The BT- model numbers above refer to the bare board packaging.
The retail kit model numbers are found by replacing BT- with KT- in the above
list.  The retail kit includes the bare board and manual as well as cabling and
driver media and documentation that are not provided with bare boards.</p>
</div>
<div class="section" id="flashpoint-installation-notes">
<h2>FlashPoint Installation Notes<a class="headerlink" href="#flashpoint-installation-notes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="raidplus-support">
<h3>RAIDPlus Support<a class="headerlink" href="#raidplus-support" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>FlashPoint Host Adapters now include RAIDPlus, Mylex’s bootable software
RAID.  RAIDPlus is not supported on Linux, and there are no plans to support
it.  The MD driver in Linux 2.0 provides for concatenation (LINEAR) and
striping (RAID-0), and support for mirroring (RAID-1), fixed parity (RAID-4),
and distributed parity (RAID-5) is available separately.  The built-in Linux
RAID support is generally more flexible and is expected to perform better
than RAIDPlus, so there is little impetus to include RAIDPlus support in the
BusLogic driver.</div></blockquote>
</div>
<div class="section" id="enabling-ultrascsi-transfers">
<h3>Enabling UltraSCSI Transfers<a class="headerlink" href="#enabling-ultrascsi-transfers" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>FlashPoint Host Adapters ship with their configuration set to “Factory
Default” settings that are conservative and do not allow for UltraSCSI speed
to be negotiated.  This results in fewer problems when these host adapters
are installed in systems with cabling or termination that is not sufficient
for UltraSCSI operation, or where existing SCSI devices do not properly
respond to synchronous transfer negotiation for UltraSCSI speed.  AutoSCSI
may be used to load “Optimum Performance” settings which allow UltraSCSI
speed to be negotiated with all devices, or UltraSCSI speed can be enabled on
an individual basis.  It is recommended that SCAM be manually disabled after
the “Optimum Performance” settings are loaded.</div></blockquote>
</div>
</div>
<div class="section" id="bt-948-958-958d-installation-notes">
<h2>BT-948/958/958D Installation Notes<a class="headerlink" href="#bt-948-958-958d-installation-notes" title="Permalink to this headline">¶</a></h2>
<p>The BT-948/958/958D PCI Ultra SCSI Host Adapters have some features which may
require attention in some circumstances when installing Linux.</p>
<div class="section" id="pci-i-o-port-assignments">
<h3>PCI I/O Port Assignments<a class="headerlink" href="#pci-i-o-port-assignments" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>When configured to factory default settings, the BT-948/958/958D will only
recognize the PCI I/O port assignments made by the motherboard’s PCI BIOS.
The BT-948/958/958D will not respond to any of the ISA compatible I/O ports
that previous BusLogic SCSI Host Adapters respond to.  This driver supports
the PCI I/O port assignments, so this is the preferred configuration.
However, if the obsolete BusLogic driver must be used for any reason, such as
a Linux distribution that does not yet use this driver in its boot kernel,
BusLogic has provided an AutoSCSI configuration option to enable a legacy ISA
compatible I/O port.</p>
<p>To enable this backward compatibility option, invoke the AutoSCSI utility via
Ctrl-B at system startup and select “Adapter Configuration”, “View/Modify
Configuration”, and then change the “ISA Compatible Port” setting from
“Disable” to “Primary” or “Alternate”.  Once this driver has been installed,
the “ISA Compatible Port” option should be set back to “Disable” to avoid
possible future I/O port conflicts.  The older BT-946C/956C/956CD also have
this configuration option, but the factory default setting is “Primary”.</p>
</div></blockquote>
</div>
<div class="section" id="pci-slot-scanning-order">
<h3>PCI Slot Scanning Order<a class="headerlink" href="#pci-slot-scanning-order" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>In systems with multiple BusLogic PCI Host Adapters, the order in which the
PCI slots are scanned may appear reversed with the BT-948/958/958D as
compared to the BT-946C/956C/956CD.  For booting from a SCSI disk to work
correctly, it is necessary that the host adapter’s BIOS and the kernel agree
on which disk is the boot device, which requires that they recognize the PCI
host adapters in the same order.  The motherboard’s PCI BIOS provides a
standard way of enumerating the PCI host adapters, which is used by the Linux
kernel.  Some PCI BIOS implementations enumerate the PCI slots in order of
increasing bus number and device number, while others do so in the opposite
direction.</p>
<p>Unfortunately, Microsoft decided that Windows 95 would always enumerate the
PCI slots in order of increasing bus number and device number regardless of
the PCI BIOS enumeration, and requires that their scheme be supported by the
host adapter’s BIOS to receive Windows 95 certification.  Therefore, the
factory default settings of the BT-948/958/958D enumerate the host adapters
by increasing bus number and device number.  To disable this feature, invoke
the AutoSCSI utility via Ctrl-B at system startup and select “Adapter
Configuration”, “View/Modify Configuration”, press Ctrl-F10, and then change
the “Use Bus And Device # For PCI Scanning Seq.” option to OFF.</p>
<p>This driver will interrogate the setting of the PCI Scanning Sequence option
so as to recognize the host adapters in the same order as they are enumerated
by the host adapter’s BIOS.</p>
</div></blockquote>
</div>
<div class="section" id="id1">
<h3>Enabling UltraSCSI Transfers<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>The BT-948/958/958D ship with their configuration set to “Factory Default”
settings that are conservative and do not allow for UltraSCSI speed to be
negotiated.  This results in fewer problems when these host adapters are
installed in systems with cabling or termination that is not sufficient for
UltraSCSI operation, or where existing SCSI devices do not properly respond
to synchronous transfer negotiation for UltraSCSI speed.  AutoSCSI may be
used to load “Optimum Performance” settings which allow UltraSCSI speed to be
negotiated with all devices, or UltraSCSI speed can be enabled on an
individual basis.  It is recommended that SCAM be manually disabled after the
“Optimum Performance” settings are loaded.</div></blockquote>
</div>
</div>
<div class="section" id="driver-options">
<h2>Driver Options<a class="headerlink" href="#driver-options" title="Permalink to this headline">¶</a></h2>
<p>BusLogic Driver Options may be specified either via the Linux Kernel Command
Line or via the Loadable Kernel Module Installation Facility.  Driver Options
for multiple host adapters may be specified either by separating the option
strings by a semicolon, or by specifying multiple “BusLogic=” strings on the
command line.  Individual option specifications for a single host adapter are
separated by commas.  The Probing and Debugging Options apply to all host
adapters whereas the remaining options apply individually only to the
selected host adapter.</p>
<p>The BusLogic Driver Probing Options comprise the following:</p>
<p>IO:&lt;integer&gt;</p>
<blockquote>
<div>The “IO:” option specifies an ISA I/O Address to be probed for a non-PCI
MultiMaster Host Adapter.  If neither “IO:” nor “NoProbeISA” options are
specified, then the standard list of BusLogic MultiMaster ISA I/O Addresses
will be probed (0x330, 0x334, 0x230, 0x234, 0x130, and 0x134).  Multiple
“IO:” options may be specified to precisely determine the I/O Addresses to
be probed, but the probe order will always follow the standard list.</div></blockquote>
<p>NoProbe</p>
<blockquote>
<div>The “NoProbe” option disables all probing and therefore no BusLogic Host
Adapters will be detected.</div></blockquote>
<p>NoProbeISA</p>
<blockquote>
<div>The “NoProbeISA” option disables probing of the standard BusLogic ISA I/O
Addresses and therefore only PCI MultiMaster and FlashPoint Host Adapters
will be detected.</div></blockquote>
<p>NoProbePCI</p>
<blockquote>
<div>The “NoProbePCI” options disables the interrogation of PCI Configuration
Space and therefore only ISA Multimaster Host Adapters will be detected, as
well as PCI Multimaster Host Adapters that have their ISA Compatible I/O
Port set to “Primary” or “Alternate”.</div></blockquote>
<p>NoSortPCI</p>
<blockquote>
<div>The “NoSortPCI” option forces PCI MultiMaster Host Adapters to be
enumerated in the order provided by the PCI BIOS, ignoring any setting of
the AutoSCSI “Use Bus And Device # For PCI Scanning Seq.” option.</div></blockquote>
<p>MultiMasterFirst</p>
<blockquote>
<div>The “MultiMasterFirst” option forces MultiMaster Host Adapters to be probed
before FlashPoint Host Adapters.  By default, if both FlashPoint and PCI
MultiMaster Host Adapters are present, this driver will probe for
FlashPoint Host Adapters first unless the BIOS primary disk is controlled
by the first PCI MultiMaster Host Adapter, in which case MultiMaster Host
Adapters will be probed first.</div></blockquote>
<p>FlashPointFirst</p>
<blockquote>
<div>The “FlashPointFirst” option forces FlashPoint Host Adapters to be probed
before MultiMaster Host Adapters.</div></blockquote>
<p>The BusLogic Driver Tagged Queuing Options allow for explicitly specifying
the Queue Depth and whether Tagged Queuing is permitted for each Target
Device (assuming that the Target Device supports Tagged Queuing).  The Queue
Depth is the number of SCSI Commands that are allowed to be concurrently
presented for execution (either to the Host Adapter or Target Device).  Note
that explicitly enabling Tagged Queuing may lead to problems; the option to
enable or disable Tagged Queuing is provided primarily to allow disabling
Tagged Queuing on Target Devices that do not implement it correctly.  The
following options are available:</p>
<p>QueueDepth:&lt;integer&gt;</p>
<blockquote>
<div>The “QueueDepth:” or QD:” option specifies the Queue Depth to use for all
Target Devices that support Tagged Queuing, as well as the maximum Queue
Depth for devices that do not support Tagged Queuing.  If no Queue Depth
option is provided, the Queue Depth will be determined automatically based
on the Host Adapter’s Total Queue Depth and the number, type, speed, and
capabilities of the detected Target Devices.  For Host Adapters that
require ISA Bounce Buffers, the Queue Depth is automatically set by default
to BusLogic_TaggedQueueDepthBB or BusLogic_UntaggedQueueDepthBB to avoid
excessive preallocation of DMA Bounce Buffer memory.  Target Devices that
do not support Tagged Queuing always have their Queue Depth set to
BusLogic_UntaggedQueueDepth or BusLogic_UntaggedQueueDepthBB, unless a
lower Queue Depth option is provided.  A Queue Depth of 1 automatically
disables Tagged Queuing.</div></blockquote>
<p>QueueDepth:[&lt;integer&gt;,&lt;integer&gt;…]</p>
<blockquote>
<div>The “QueueDepth:[…]” or “QD:[…]” option specifies the Queue Depth
individually for each Target Device.  If an &lt;integer&gt; is omitted, the
associated Target Device will have its Queue Depth selected automatically.</div></blockquote>
<p>TaggedQueuing:Default</p>
<blockquote>
<div>The “TaggedQueuing:Default” or “TQ:Default” option permits Tagged Queuing
based on the firmware version of the BusLogic Host Adapter and based on
whether the Queue Depth allows queuing multiple commands.</div></blockquote>
<p>TaggedQueuing:Enable</p>
<blockquote>
<div>The “TaggedQueuing:Enable” or “TQ:Enable” option enables Tagged Queuing for
all Target Devices on this Host Adapter, overriding any limitation that
would otherwise be imposed based on the Host Adapter firmware version.</div></blockquote>
<p>TaggedQueuing:Disable</p>
<blockquote>
<div>The “TaggedQueuing:Disable” or “TQ:Disable” option disables Tagged Queuing
for all Target Devices on this Host Adapter.</div></blockquote>
<p>TaggedQueuing:&lt;Target-Spec&gt;</p>
<blockquote>
<div>The “TaggedQueuing:&lt;Target-Spec&gt;” or “TQ:&lt;Target-Spec&gt;” option controls
Tagged Queuing individually for each Target Device.  &lt;Target-Spec&gt; is a
sequence of “Y”, “N”, and “X” characters.  “Y” enables Tagged Queuing, “N”
disables Tagged Queuing, and “X” accepts the default based on the firmware
version.  The first character refers to Target Device 0, the second to
Target Device 1, and so on; if the sequence of “Y”, “N”, and “X” characters
does not cover all the Target Devices, unspecified characters are assumed
to be “X”.</div></blockquote>
<p>The BusLogic Driver Miscellaneous Options comprise the following:</p>
<p>BusSettleTime:&lt;seconds&gt;</p>
<blockquote>
<div>The “BusSettleTime:” or “BST:” option specifies the Bus Settle Time in
seconds.  The Bus Settle Time is the amount of time to wait between a Host
Adapter Hard Reset which initiates a SCSI Bus Reset and issuing any SCSI
Commands.  If unspecified, it defaults to BusLogic_DefaultBusSettleTime.</div></blockquote>
<p>InhibitTargetInquiry</p>
<blockquote>
<div>The “InhibitTargetInquiry” option inhibits the execution of an Inquire
Target Devices or Inquire Installed Devices command on MultiMaster Host
Adapters.  This may be necessary with some older Target Devices that do not
respond correctly when Logical Units above 0 are addressed.</div></blockquote>
<p>The BusLogic Driver Debugging Options comprise the following:</p>
<p>TraceProbe</p>
<blockquote>
<div>The “TraceProbe” option enables tracing of Host Adapter Probing.</div></blockquote>
<p>TraceHardwareReset</p>
<blockquote>
<div>The “TraceHardwareReset” option enables tracing of Host Adapter Hardware
Reset.</div></blockquote>
<p>TraceConfiguration</p>
<blockquote>
<div>The “TraceConfiguration” option enables tracing of Host Adapter
Configuration.</div></blockquote>
<p>TraceErrors</p>
<blockquote>
<div>The “TraceErrors” option enables tracing of SCSI Commands that return an
error from the Target Device.  The CDB and Sense Data will be printed for
each SCSI Command that fails.</div></blockquote>
<p>Debug</p>
<blockquote>
<div>The “Debug” option enables all debugging options.</div></blockquote>
<p>The following examples demonstrate setting the Queue Depth for Target Devices
1 and 2 on the first host adapter to 7 and 15, the Queue Depth for all Target
Devices on the second host adapter to 31, and the Bus Settle Time on the
second host adapter to 30 seconds.</p>
<p>Linux Kernel Command Line:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>linux BusLogic=QueueDepth:[,7,15];QueueDepth:31,BusSettleTime:30
</pre></div>
</div>
<p>LILO Linux Boot Loader (in /etc/lilo.conf):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>append = &quot;BusLogic=QueueDepth:[,7,15];QueueDepth:31,BusSettleTime:30&quot;
</pre></div>
</div>
<p>INSMOD Loadable Kernel Module Installation Facility:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>insmod BusLogic.o \
    &#39;BusLogic=&quot;QueueDepth:[,7,15];QueueDepth:31,BusSettleTime:30&quot;&#39;
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Module Utilities 2.1.71 or later is required for correct parsing
of driver options containing commas.</p>
</div>
</div>
<div class="section" id="driver-installation">
<h2>Driver Installation<a class="headerlink" href="#driver-installation" title="Permalink to this headline">¶</a></h2>
<p>This distribution was prepared for Linux kernel version 2.0.35, but should be
compatible with 2.0.4 or any later 2.0 series kernel.</p>
<p>To install the new BusLogic SCSI driver, you may use the following commands,
replacing “/usr/src” with wherever you keep your Linux kernel source tree:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>cd /usr/src
tar -xvzf BusLogic-2.0.15.tar.gz
mv README.* LICENSE.* BusLogic.[ch] FlashPoint.c linux/drivers/scsi
patch -p0 &lt; BusLogic.patch (only for 2.0.33 and below)
cd linux
make config
make zImage
</pre></div>
</div>
<p>Then install “arch/x86/boot/zImage” as your standard kernel, run lilo if
appropriate, and reboot.</p>
</div>
<div class="section" id="buslogic-announcements-mailing-list">
<h2>BusLogic Announcements Mailing List<a class="headerlink" href="#buslogic-announcements-mailing-list" title="Permalink to this headline">¶</a></h2>
<p>The BusLogic Announcements Mailing List provides a forum for informing Linux
users of new driver releases and other announcements regarding Linux support
for BusLogic SCSI Host Adapters.  To join the mailing list, send a message to
“<a class="reference external" href="mailto:buslogic-announce-request&#37;&#52;&#48;dandelion&#46;com">buslogic-announce-request<span>&#64;</span>dandelion<span>&#46;</span>com</a>” with the line “subscribe” in the
message body.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>